<!DOCTYPE html>
<html lang="en"><head><title>Cross Site Scripting (XSS)</title><meta charset="utf-8"/><link rel="preconnect" href="https://fonts.googleapis.com"/><link rel="preconnect" href="https://fonts.gstatic.com"/><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Schibsted Grotesk:wght@400;700&amp;family=Source Sans Pro:ital,wght@0,400;0,600;1,400;1,600&amp;family=IBM Plex Mono:wght@400;600&amp;display=swap"/><link rel="preconnect" href="https://cdnjs.cloudflare.com" crossorigin="anonymous"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta name="og:site_name" content="Quartz 4"/><meta property="og:title" content="Cross Site Scripting (XSS)"/><meta property="og:type" content="website"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:title" content="Cross Site Scripting (XSS)"/><meta name="twitter:description" content="Attacco Cross-Site Scripting (XSS): Panoramica e Impatto Il Cross-Site Scripting, comunemente abbreviato in XSS, è un tipo di vulnerabilità di sicurezza tipicamente riscontrata nelle applicazioni web."/><meta property="og:description" content="Attacco Cross-Site Scripting (XSS): Panoramica e Impatto Il Cross-Site Scripting, comunemente abbreviato in XSS, è un tipo di vulnerabilità di sicurezza tipicamente riscontrata nelle applicazioni web."/><meta property="og:image:alt" content="Attacco Cross-Site Scripting (XSS): Panoramica e Impatto Il Cross-Site Scripting, comunemente abbreviato in XSS, è un tipo di vulnerabilità di sicurezza tipicamente riscontrata nelle applicazioni web."/><meta property="twitter:domain" content="/didattica/"/><meta property="og:url" content="https://didattica/Argomenti/Cybersecurity-e-Ethical-hacking/Cross-Site-Scripting-(XSS)"/><meta property="twitter:url" content="https://didattica/Argomenti/Cybersecurity-e-Ethical-hacking/Cross-Site-Scripting-(XSS)"/><link rel="icon" href="../../static/icon.png"/><meta name="description" content="Attacco Cross-Site Scripting (XSS): Panoramica e Impatto Il Cross-Site Scripting, comunemente abbreviato in XSS, è un tipo di vulnerabilità di sicurezza tipicamente riscontrata nelle applicazioni web."/><meta name="generator" content="Quartz"/><link href="../../index.css" rel="stylesheet" type="text/css" spa-preserve/><style>.expand-button {
  position: absolute;
  display: flex;
  float: right;
  padding: 0.4rem;
  margin: 0.3rem;
  right: 0;
  color: var(--gray);
  border-color: var(--dark);
  background-color: var(--light);
  border: 1px solid;
  border-radius: 5px;
  opacity: 0;
  transition: 0.2s;
}
.expand-button > svg {
  fill: var(--light);
  filter: contrast(0.3);
}
.expand-button:hover {
  cursor: pointer;
  border-color: var(--secondary);
}
.expand-button:focus {
  outline: 0;
}

pre:hover > .expand-button {
  opacity: 1;
  transition: 0.2s;
}

#mermaid-container {
  position: fixed;
  contain: layout;
  z-index: 999;
  left: 0;
  top: 0;
  width: 100vw;
  height: 100vh;
  overflow: hidden;
  display: none;
  backdrop-filter: blur(4px);
  background: rgba(0, 0, 0, 0.5);
}
#mermaid-container.active {
  display: inline-block;
}
#mermaid-container > #mermaid-space {
  border: 1px solid var(--lightgray);
  background-color: var(--light);
  border-radius: 5px;
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  height: 80vh;
  width: 80vw;
  overflow: hidden;
}
#mermaid-container > #mermaid-space > .mermaid-content {
  padding: 2rem;
  position: relative;
  transform-origin: 0 0;
  transition: transform 0.1s ease;
  overflow: visible;
  min-height: 200px;
  min-width: 200px;
}
#mermaid-container > #mermaid-space > .mermaid-content pre {
  margin: 0;
  border: none;
}
#mermaid-container > #mermaid-space > .mermaid-content svg {
  max-width: none;
  height: auto;
}
#mermaid-container > #mermaid-space > .mermaid-controls {
  position: absolute;
  bottom: 20px;
  right: 20px;
  display: flex;
  gap: 8px;
  padding: 8px;
  background: var(--light);
  border: 1px solid var(--lightgray);
  border-radius: 6px;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
  z-index: 2;
}
#mermaid-container > #mermaid-space > .mermaid-controls .mermaid-control-button {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 32px;
  height: 32px;
  padding: 0;
  border: 1px solid var(--lightgray);
  background: var(--light);
  color: var(--dark);
  border-radius: 4px;
  cursor: pointer;
  font-size: 16px;
  font-family: var(--bodyFont);
  transition: all 0.2s ease;
}
#mermaid-container > #mermaid-space > .mermaid-controls .mermaid-control-button:hover {
  background: var(--lightgray);
}
#mermaid-container > #mermaid-space > .mermaid-controls .mermaid-control-button:active {
  transform: translateY(1px);
}
#mermaid-container > #mermaid-space > .mermaid-controls .mermaid-control-button:nth-child(2) {
  width: auto;
  padding: 0 12px;
  font-size: 14px;
}
/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VSb290IjoiL2hvbWUvZGF2aWRhZmZvL3BsYXlncm91bmQvcXVhcnR6L3F1YXJ0ei9jb21wb25lbnRzL3N0eWxlcyIsInNvdXJjZXMiOlsibWVybWFpZC5pbmxpbmUuc2NzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUNFO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBOztBQUVBO0VBQ0U7RUFDQTs7QUFHRjtFQUNFO0VBQ0E7O0FBR0Y7RUFDRTs7O0FBS0Y7RUFDRTtFQUNBOzs7QUFJSjtFQUNFO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7O0FBRUE7RUFDRTs7QUFHRjtFQUNFO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBOztBQUVBO0VBQ0U7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7O0FBRUE7RUFDRTtFQUNBOztBQUdGO0VBQ0U7RUFDQTs7QUFJSjtFQUNFO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7O0FBRUE7RUFDRTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBOztBQUVBO0VBQ0U7O0FBR0Y7RUFDRTs7QUFJRjtFQUNFO0VBQ0E7RUFDQSIsInNvdXJjZXNDb250ZW50IjpbIi5leHBhbmQtYnV0dG9uIHtcbiAgcG9zaXRpb246IGFic29sdXRlO1xuICBkaXNwbGF5OiBmbGV4O1xuICBmbG9hdDogcmlnaHQ7XG4gIHBhZGRpbmc6IDAuNHJlbTtcbiAgbWFyZ2luOiAwLjNyZW07XG4gIHJpZ2h0OiAwOyAvLyBOT1RFOiByaWdodCB3aWxsIGJlIHNldCBpbiBtZXJtYWlkLmlubGluZS50c1xuICBjb2xvcjogdmFyKC0tZ3JheSk7XG4gIGJvcmRlci1jb2xvcjogdmFyKC0tZGFyayk7XG4gIGJhY2tncm91bmQtY29sb3I6IHZhcigtLWxpZ2h0KTtcbiAgYm9yZGVyOiAxcHggc29saWQ7XG4gIGJvcmRlci1yYWRpdXM6IDVweDtcbiAgb3BhY2l0eTogMDtcbiAgdHJhbnNpdGlvbjogMC4ycztcblxuICAmID4gc3ZnIHtcbiAgICBmaWxsOiB2YXIoLS1saWdodCk7XG4gICAgZmlsdGVyOiBjb250cmFzdCgwLjMpO1xuICB9XG5cbiAgJjpob3ZlciB7XG4gICAgY3Vyc29yOiBwb2ludGVyO1xuICAgIGJvcmRlci1jb2xvcjogdmFyKC0tc2Vjb25kYXJ5KTtcbiAgfVxuXG4gICY6Zm9jdXMge1xuICAgIG91dGxpbmU6IDA7XG4gIH1cbn1cblxucHJlIHtcbiAgJjpob3ZlciA+IC5leHBhbmQtYnV0dG9uIHtcbiAgICBvcGFjaXR5OiAxO1xuICAgIHRyYW5zaXRpb246IDAuMnM7XG4gIH1cbn1cblxuI21lcm1haWQtY29udGFpbmVyIHtcbiAgcG9zaXRpb246IGZpeGVkO1xuICBjb250YWluOiBsYXlvdXQ7XG4gIHotaW5kZXg6IDk5OTtcbiAgbGVmdDogMDtcbiAgdG9wOiAwO1xuICB3aWR0aDogMTAwdnc7XG4gIGhlaWdodDogMTAwdmg7XG4gIG92ZXJmbG93OiBoaWRkZW47XG4gIGRpc3BsYXk6IG5vbmU7XG4gIGJhY2tkcm9wLWZpbHRlcjogYmx1cig0cHgpO1xuICBiYWNrZ3JvdW5kOiByZ2JhKDAsIDAsIDAsIDAuNSk7XG5cbiAgJi5hY3RpdmUge1xuICAgIGRpc3BsYXk6IGlubGluZS1ibG9jaztcbiAgfVxuXG4gICYgPiAjbWVybWFpZC1zcGFjZSB7XG4gICAgYm9yZGVyOiAxcHggc29saWQgdmFyKC0tbGlnaHRncmF5KTtcbiAgICBiYWNrZ3JvdW5kLWNvbG9yOiB2YXIoLS1saWdodCk7XG4gICAgYm9yZGVyLXJhZGl1czogNXB4O1xuICAgIHBvc2l0aW9uOiBmaXhlZDtcbiAgICB0b3A6IDUwJTtcbiAgICBsZWZ0OiA1MCU7XG4gICAgdHJhbnNmb3JtOiB0cmFuc2xhdGUoLTUwJSwgLTUwJSk7XG4gICAgaGVpZ2h0OiA4MHZoO1xuICAgIHdpZHRoOiA4MHZ3O1xuICAgIG92ZXJmbG93OiBoaWRkZW47XG5cbiAgICAmID4gLm1lcm1haWQtY29udGVudCB7XG4gICAgICBwYWRkaW5nOiAycmVtO1xuICAgICAgcG9zaXRpb246IHJlbGF0aXZlO1xuICAgICAgdHJhbnNmb3JtLW9yaWdpbjogMCAwO1xuICAgICAgdHJhbnNpdGlvbjogdHJhbnNmb3JtIDAuMXMgZWFzZTtcbiAgICAgIG92ZXJmbG93OiB2aXNpYmxlO1xuICAgICAgbWluLWhlaWdodDogMjAwcHg7XG4gICAgICBtaW4td2lkdGg6IDIwMHB4O1xuXG4gICAgICBwcmUge1xuICAgICAgICBtYXJnaW46IDA7XG4gICAgICAgIGJvcmRlcjogbm9uZTtcbiAgICAgIH1cblxuICAgICAgc3ZnIHtcbiAgICAgICAgbWF4LXdpZHRoOiBub25lO1xuICAgICAgICBoZWlnaHQ6IGF1dG87XG4gICAgICB9XG4gICAgfVxuXG4gICAgJiA+IC5tZXJtYWlkLWNvbnRyb2xzIHtcbiAgICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTtcbiAgICAgIGJvdHRvbTogMjBweDtcbiAgICAgIHJpZ2h0OiAyMHB4O1xuICAgICAgZGlzcGxheTogZmxleDtcbiAgICAgIGdhcDogOHB4O1xuICAgICAgcGFkZGluZzogOHB4O1xuICAgICAgYmFja2dyb3VuZDogdmFyKC0tbGlnaHQpO1xuICAgICAgYm9yZGVyOiAxcHggc29saWQgdmFyKC0tbGlnaHRncmF5KTtcbiAgICAgIGJvcmRlci1yYWRpdXM6IDZweDtcbiAgICAgIGJveC1zaGFkb3c6IDAgMnB4IDRweCByZ2JhKDAsIDAsIDAsIDAuMSk7XG4gICAgICB6LWluZGV4OiAyO1xuXG4gICAgICAubWVybWFpZC1jb250cm9sLWJ1dHRvbiB7XG4gICAgICAgIGRpc3BsYXk6IGZsZXg7XG4gICAgICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7XG4gICAgICAgIGp1c3RpZnktY29udGVudDogY2VudGVyO1xuICAgICAgICB3aWR0aDogMzJweDtcbiAgICAgICAgaGVpZ2h0OiAzMnB4O1xuICAgICAgICBwYWRkaW5nOiAwO1xuICAgICAgICBib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1saWdodGdyYXkpO1xuICAgICAgICBiYWNrZ3JvdW5kOiB2YXIoLS1saWdodCk7XG4gICAgICAgIGNvbG9yOiB2YXIoLS1kYXJrKTtcbiAgICAgICAgYm9yZGVyLXJhZGl1czogNHB4O1xuICAgICAgICBjdXJzb3I6IHBvaW50ZXI7XG4gICAgICAgIGZvbnQtc2l6ZTogMTZweDtcbiAgICAgICAgZm9udC1mYW1pbHk6IHZhcigtLWJvZHlGb250KTtcbiAgICAgICAgdHJhbnNpdGlvbjogYWxsIDAuMnMgZWFzZTtcblxuICAgICAgICAmOmhvdmVyIHtcbiAgICAgICAgICBiYWNrZ3JvdW5kOiB2YXIoLS1saWdodGdyYXkpO1xuICAgICAgICB9XG5cbiAgICAgICAgJjphY3RpdmUge1xuICAgICAgICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlWSgxcHgpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gU3R5bGUgdGhlIHJlc2V0IGJ1dHRvbiBkaWZmZXJlbnRseVxuICAgICAgICAmOm50aC1jaGlsZCgyKSB7XG4gICAgICAgICAgd2lkdGg6IGF1dG87XG4gICAgICAgICAgcGFkZGluZzogMCAxMnB4O1xuICAgICAgICAgIGZvbnQtc2l6ZTogMTRweDtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfVxufVxuIl19 */</style><link href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" rel="stylesheet" type="text/css" spa-preserve/><script src="../../prescript.js" type="application/javascript" spa-preserve></script><script type="application/javascript" spa-preserve>const fetchData = fetch("../../static/contentIndex.json").then(data => data.json())</script><link rel="alternate" type="application/rss+xml" title="RSS Feed" href="https:///didattica//index.xml"/><meta property="og:image:width" content="1200"/><meta property="og:image:height" content="630"/><meta property="og:image" content="https:///didattica//Argomenti/Cybersecurity-e-Ethical-hacking/Cross-Site-Scripting-(XSS)-og-image.webp"/><meta property="og:image:url" content="https:///didattica//Argomenti/Cybersecurity-e-Ethical-hacking/Cross-Site-Scripting-(XSS)-og-image.webp"/><meta name="twitter:image" content="https:///didattica//Argomenti/Cybersecurity-e-Ethical-hacking/Cross-Site-Scripting-(XSS)-og-image.webp"/><meta property="og:image:type" content="image/.webp"/></head><body data-slug="Argomenti/Cybersecurity-e-Ethical-hacking/Cross-Site-Scripting-(XSS)"><div id="quartz-root" class="page"><div id="quartz-body"><div class="left sidebar"><h2 class="page-title"><a href="../..">Quartz 4</a></h2><div class="spacer mobile-only"></div><div class="flex-component" style="flex-direction: row; flex-wrap: nowrap; gap: 1rem;"><div style="flex-grow: 1; flex-shrink: 1; flex-basis: auto; order: 0; align-self: center; justify-self: center;"><div class="search"><button class="search-button"><p>Search</p><svg role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 19.9 19.7"><title>Search</title><g class="search-path" fill="none"><path stroke-linecap="square" d="M18.5 18.3l-5.4-5.4"></path><circle cx="8" cy="8" r="7"></circle></g></svg></button><div class="search-container"><div class="search-space"><input autocomplete="off" class="search-bar" name="search" type="text" aria-label="Search for something" placeholder="Search for something"/><div class="search-layout" data-preview="true"></div></div></div></div></div><div style="flex-grow: 0; flex-shrink: 1; flex-basis: auto; order: 0; align-self: center; justify-self: center;"><button class="darkmode"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" class="dayIcon" x="0px" y="0px" viewBox="0 0 35 35" style="enable-background:new 0 0 35 35" xml:space="preserve" aria-label="Dark mode"><title>Dark mode</title><path d="M6,17.5C6,16.672,5.328,16,4.5,16h-3C0.672,16,0,16.672,0,17.5    S0.672,19,1.5,19h3C5.328,19,6,18.328,6,17.5z M7.5,26c-0.414,0-0.789,0.168-1.061,0.439l-2,2C4.168,28.711,4,29.086,4,29.5    C4,30.328,4.671,31,5.5,31c0.414,0,0.789-0.168,1.06-0.44l2-2C8.832,28.289,9,27.914,9,27.5C9,26.672,8.329,26,7.5,26z M17.5,6    C18.329,6,19,5.328,19,4.5v-3C19,0.672,18.329,0,17.5,0S16,0.672,16,1.5v3C16,5.328,16.671,6,17.5,6z M27.5,9    c0.414,0,0.789-0.168,1.06-0.439l2-2C30.832,6.289,31,5.914,31,5.5C31,4.672,30.329,4,29.5,4c-0.414,0-0.789,0.168-1.061,0.44    l-2,2C26.168,6.711,26,7.086,26,7.5C26,8.328,26.671,9,27.5,9z M6.439,8.561C6.711,8.832,7.086,9,7.5,9C8.328,9,9,8.328,9,7.5    c0-0.414-0.168-0.789-0.439-1.061l-2-2C6.289,4.168,5.914,4,5.5,4C4.672,4,4,4.672,4,5.5c0,0.414,0.168,0.789,0.439,1.06    L6.439,8.561z M33.5,16h-3c-0.828,0-1.5,0.672-1.5,1.5s0.672,1.5,1.5,1.5h3c0.828,0,1.5-0.672,1.5-1.5S34.328,16,33.5,16z     M28.561,26.439C28.289,26.168,27.914,26,27.5,26c-0.828,0-1.5,0.672-1.5,1.5c0,0.414,0.168,0.789,0.439,1.06l2,2    C28.711,30.832,29.086,31,29.5,31c0.828,0,1.5-0.672,1.5-1.5c0-0.414-0.168-0.789-0.439-1.061L28.561,26.439z M17.5,29    c-0.829,0-1.5,0.672-1.5,1.5v3c0,0.828,0.671,1.5,1.5,1.5s1.5-0.672,1.5-1.5v-3C19,29.672,18.329,29,17.5,29z M17.5,7    C11.71,7,7,11.71,7,17.5S11.71,28,17.5,28S28,23.29,28,17.5S23.29,7,17.5,7z M17.5,25c-4.136,0-7.5-3.364-7.5-7.5    c0-4.136,3.364-7.5,7.5-7.5c4.136,0,7.5,3.364,7.5,7.5C25,21.636,21.636,25,17.5,25z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" class="nightIcon" x="0px" y="0px" viewBox="0 0 100 100" style="enable-background:new 0 0 100 100" xml:space="preserve" aria-label="Light mode"><title>Light mode</title><path d="M96.76,66.458c-0.853-0.852-2.15-1.064-3.23-0.534c-6.063,2.991-12.858,4.571-19.655,4.571  C62.022,70.495,50.88,65.88,42.5,57.5C29.043,44.043,25.658,23.536,34.076,6.47c0.532-1.08,0.318-2.379-0.534-3.23  c-0.851-0.852-2.15-1.064-3.23-0.534c-4.918,2.427-9.375,5.619-13.246,9.491c-9.447,9.447-14.65,22.008-14.65,35.369  c0,13.36,5.203,25.921,14.65,35.368s22.008,14.65,35.368,14.65c13.361,0,25.921-5.203,35.369-14.65  c3.872-3.871,7.064-8.328,9.491-13.246C97.826,68.608,97.611,67.309,96.76,66.458z"></path></svg></button></div><div style="flex-grow: 0; flex-shrink: 1; flex-basis: auto; order: 0; align-self: center; justify-self: center;"><button class="readermode"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" class="readerIcon" fill="currentColor" stroke="currentColor" stroke-width="0.2" stroke-linecap="round" stroke-linejoin="round" width="64px" height="64px" viewBox="0 0 24 24" aria-label="Reader mode"><title>Reader mode</title><g transform="translate(-1.8, -1.8) scale(1.15, 1.2)"><path d="M8.9891247,2.5 C10.1384702,2.5 11.2209868,2.96705384 12.0049645,3.76669482 C12.7883914,2.96705384 13.8709081,2.5 15.0202536,2.5 L18.7549359,2.5 C19.1691495,2.5 19.5049359,2.83578644 19.5049359,3.25 L19.5046891,4.004 L21.2546891,4.00457396 C21.6343849,4.00457396 21.9481801,4.28672784 21.9978425,4.6528034 L22.0046891,4.75457396 L22.0046891,20.25 C22.0046891,20.6296958 21.7225353,20.943491 21.3564597,20.9931534 L21.2546891,21 L2.75468914,21 C2.37499337,21 2.06119817,20.7178461 2.01153575,20.3517706 L2.00468914,20.25 L2.00468914,4.75457396 C2.00468914,4.37487819 2.28684302,4.061083 2.65291858,4.01142057 L2.75468914,4.00457396 L4.50368914,4.004 L4.50444233,3.25 C4.50444233,2.87030423 4.78659621,2.55650904 5.15267177,2.50684662 L5.25444233,2.5 L8.9891247,2.5 Z M4.50368914,5.504 L3.50468914,5.504 L3.50468914,19.5 L10.9478955,19.4998273 C10.4513189,18.9207296 9.73864328,18.5588115 8.96709342,18.5065584 L8.77307039,18.5 L5.25444233,18.5 C4.87474657,18.5 4.56095137,18.2178461 4.51128895,17.8517706 L4.50444233,17.75 L4.50368914,5.504 Z M19.5049359,17.75 C19.5049359,18.1642136 19.1691495,18.5 18.7549359,18.5 L15.2363079,18.5 C14.3910149,18.5 13.5994408,18.8724714 13.0614828,19.4998273 L20.5046891,19.5 L20.5046891,5.504 L19.5046891,5.504 L19.5049359,17.75 Z M18.0059359,3.999 L15.0202536,4 L14.8259077,4.00692283 C13.9889509,4.06666544 13.2254227,4.50975805 12.7549359,5.212 L12.7549359,17.777 L12.7782651,17.7601316 C13.4923805,17.2719483 14.3447024,17 15.2363079,17 L18.0059359,16.999 L18.0056891,4.798 L18.0033792,4.75457396 L18.0056891,4.71 L18.0059359,3.999 Z M8.9891247,4 L6.00368914,3.999 L6.00599909,4.75457396 L6.00599909,4.75457396 L6.00368914,4.783 L6.00368914,16.999 L8.77307039,17 C9.57551536,17 10.3461406,17.2202781 11.0128313,17.6202194 L11.2536891,17.776 L11.2536891,5.211 C10.8200889,4.56369974 10.1361548,4.13636104 9.37521067,4.02745763 L9.18347055,4.00692283 L8.9891247,4 Z"></path></g></svg></button></div></div><div class="explorer" data-behavior="link" data-collapsed="collapsed" data-savestate="true" data-data-fns="{&quot;order&quot;:[&quot;filter&quot;,&quot;map&quot;,&quot;sort&quot;],&quot;sortFn&quot;:&quot;(a,b)=>!a.isFolder&amp;&amp;!b.isFolder||a.isFolder&amp;&amp;b.isFolder?a.displayName.localeCompare(b.displayName,void 0,{numeric:!0,sensitivity:\&quot;base\&quot;}):!a.isFolder&amp;&amp;b.isFolder?1:-1&quot;,&quot;filterFn&quot;:&quot;node=>node.slugSegment!==\&quot;tags\&quot;&quot;,&quot;mapFn&quot;:&quot;node=>node&quot;}"><button type="button" class="explorer-toggle mobile-explorer hide-until-loaded" data-mobile="true" aria-controls="explorer-37"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide-menu"><line x1="4" x2="20" y1="12" y2="12"></line><line x1="4" x2="20" y1="6" y2="6"></line><line x1="4" x2="20" y1="18" y2="18"></line></svg></button><button type="button" class="title-button explorer-toggle desktop-explorer" data-mobile="false" aria-expanded="true"><h2>Explorer</h2><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="5 8 14 8" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="fold"><polyline points="6 9 12 15 18 9"></polyline></svg></button><div id="explorer-37" class="explorer-content" aria-expanded="false" role="group"><ul class="explorer-ul overflow" id="list-0"><li class="overflow-end"></li></ul></div><template id="template-file"><li><a href="#"></a></li></template><template id="template-folder"><li><div class="folder-container"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="5 8 14 8" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="folder-icon"><polyline points="6 9 12 15 18 9"></polyline></svg><div><button class="folder-button"><span class="folder-title"></span></button></div></div><div class="folder-outer"><ul class="content"></ul></div></li></template></div></div><div class="center"><div class="page-header"><div class="popover-hint"><nav class="breadcrumb-container" aria-label="breadcrumbs"><div class="breadcrumb-element"><a href="../../">Home</a><p> ❯ </p></div><div class="breadcrumb-element"><a href="../../Argomenti/">Argomenti</a><p> ❯ </p></div><div class="breadcrumb-element"><a href="../../Argomenti/Cybersecurity-e-Ethical-hacking/">Cybersecurity e Ethical hacking</a><p> ❯ </p></div><div class="breadcrumb-element"><a href>Cross Site Scripting (XSS)</a></div></nav><h1 class="article-title">Cross Site Scripting (XSS)</h1><p show-comma="true" class="content-meta"><time datetime="2024-05-20T13:21:21.624Z">May 20, 2024</time><span>28 min read</span></p></div></div><article class="popover-hint"><h1 id="attacco">Attacco<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#attacco" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h1>
<h2 id="cross-site-scripting-xss-panoramica-e-impatto">Cross-Site Scripting (XSS): Panoramica e Impatto<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#cross-site-scripting-xss-panoramica-e-impatto" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<p>Il Cross-Site Scripting, comunemente abbreviato in XSS, è un tipo di vulnerabilità di sicurezza tipicamente riscontrata nelle applicazioni web. Questo difetto permette agli aggressori di iniettare script dannosi all’interno di contenuti visualizzati da altri utenti. A differenza di altri attacchi web che mirano all’infrastruttura di un sito, l’XSS sfrutta la fiducia che un utente ripone in un determinato sito, rendendolo particolarmente pericoloso e diffuso.</p>
<h3 id="natura-delle-vulnerabilità-xss">Natura delle Vulnerabilità XSS<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#natura-delle-vulnerabilità-xss" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>La vulnerabilità XSS sorge quando un’applicazione include dati non affidabili in una nuova pagina web senza una valida convalida o escaping, o aggiorna una pagina web esistente con dati forniti dall’utente utilizzando un’API del browser che può creare HTML o JavaScript. L’XSS consente agli aggressori di eseguire script nel browser della vittima, che possono dirottare sessioni utente, deturpare siti web o reindirizzare l’utente verso siti malevoli.</p>
<h3 id="la-prevalenza-e-il-significato-dellxss">La Prevalenza e il Significato dell’XSS<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#la-prevalenza-e-il-significato-dellxss" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>Nonostante sia ben compreso e prevenibile, l’XSS rimane il problema di sicurezza delle applicazioni web più diffuso. La sua persistenza può essere attribuita alla natura dinamica e complessa delle applicazioni web, che spesso non impiegano una valida convalida o sanitizzazione degli input. Le conseguenze degli attacchi XSS sono diventate più gravi con l’ascesa delle Rich Internet Applications (RIAs), dove funzioni privilegiate e dati sensibili diventano accessibili tramite JavaScript, rendendoli obiettivi primari per gli aggressori.</p>
<h3 id="esempi-di-attacchi-xss">Esempi di Attacchi XSS<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#esempi-di-attacchi-xss" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<ul>
<li>
<p><strong>Vettori di Attacco Base</strong>: Utilizzare la console JavaScript di un browser per eseguire script semplici come <code>alert(&quot;Test XSS&quot;);</code> o <code>alert(document.cookie);</code> mostra il meccanismo base dell’XSS. Questo può rivelare informazioni sensibili come i cookie di sessione.</p>
</li>
<li>
<p><strong>Iniezione in Campi Dati</strong>: Iniettare un tag script, come <code>&lt;script>alert(&quot;Test XSS&quot;)&lt;/script></code>, in un campo dati che viene poi renderizzato dal browser, dimostra un comune vettore di attacco in cui lo script dell’aggressore viene eseguito come se fosse parte dell’applicazione.</p>
</li>
</ul>
<h3 id="sperimentare-con-lxss">Sperimentare con l’XSS<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#sperimentare-con-lxss" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>Per comprendere le implicazioni pratiche dell’XSS, si può condurre un semplice esperimento utilizzando browser web come Chrome o Firefox:</p>
<ol>
<li>Aprire una seconda scheda nel browser e navigare verso la stessa URL della prima scheda o qualsiasi URL all’interno dello stesso dominio.</li>
<li>Accedere alla console JavaScript all’interno degli strumenti per sviluppatori del browser.</li>
<li>Digitare <code>alert(document.cookie);</code> per visualizzare i cookie per quel dominio.</li>
<li>Osservare che i cookie visualizzati in entrambe le schede sono gli stessi, illustrando come un attacco XSS possa accedere e potenzialmente sfruttare le informazioni dei cookie attraverso le sessioni.</li>
</ol>
<h2 id="le-località-più-comuni-per-le-vulnerabilità-xss">Le Località Più Comuni per le Vulnerabilità XSS<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#le-località-più-comuni-per-le-vulnerabilità-xss" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<p>Le vulnerabilità Cross-Site Scripting (XSS) possono manifestarsi in diversi punti di un’applicazione web. Questi punti sono spesso associati all’input dell’utente e alla successiva visualizzazione di tale input nella pagina web. Di seguito sono riportate le località più comuni dove possono verificarsi vulnerabilità XSS:</p>
<h3 id="campi-di-ricerca">Campi di Ricerca<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#campi-di-ricerca" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<ul>
<li><strong>Campi di ricerca che rimandano una stringa di ricerca all’utente</strong>: Quando un utente inserisce una query in un campo di ricerca e l’applicazione web visualizza quella query nella pagina dei risultati, senza una corretta sanitizzazione, un aggressore può inserire uno script maligno come parte della query di ricerca.</li>
</ul>
<h3 id="campi-di-input">Campi di Input<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#campi-di-input" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<ul>
<li><strong>Campi di input che fanno eco ai dati dell’utente</strong>: Qualsiasi campo di input che accetta dati dall’utente e li visualizza nuovamente nella pagina web può essere sfruttato per iniettare script dannosi.</li>
</ul>
<h3 id="messaggi-di-errore">Messaggi di Errore<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#messaggi-di-errore" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<ul>
<li><strong>Messaggi di errore che restituiscono testo fornito dall’utente</strong>: Se un’applicazione genera messaggi di errore che includono input forniti dall’utente, questi messaggi possono essere manipolati per eseguire script XSS.</li>
</ul>
<h3 id="campi-nascosti">Campi Nascosti<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#campi-nascosti" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<ul>
<li><strong>Campi nascosti che contengono dati forniti dall’utente</strong>: Anche se non visibili direttamente nell’interfaccia utente, i campi nascosti possono contenere dati vulnerabili all’iniezione di XSS se tali dati sono manipolati e poi eseguiti dal browser.</li>
</ul>
<h3 id="pagine-che-visualizzano-dati-forniti-dallutente">Pagine che Visualizzano Dati Forniti dall’Utente<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#pagine-che-visualizzano-dati-forniti-dallutente" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<ul>
<li><strong>Bacheche di messaggi</strong>: Le bacheche che consentono agli utenti di postare messaggi possono diventare veicoli per script XSS se i messaggi degli utenti non sono adeguatamente sanificati.</li>
<li><strong>Commenti in forma libera</strong>: Similmente, i sistemi di commenti che consentono input in forma libera senza restrizioni o sanificazioni adeguate possono facilmente essere sfruttati per attacchi XSS.</li>
</ul>
<h3 id="intestazioni-http">Intestazioni HTTP<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#intestazioni-http" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<ul>
<li><strong>Intestazioni HTTP</strong>: Anche se meno comune, le vulnerabilità XSS possono essere introdotte tramite dati utente manipolati che vengono inviati nelle intestazioni HTTP, come il campo “Referrer” o “User-Agent”, e poi riflessi nel contenuto della pagina web.</li>
</ul>
<h2 id="perché-dovremmo-preoccuparci-degli-attacchi-xss">Perché Dovremmo Preoccuparci degli Attacchi XSS?<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#perché-dovremmo-preoccuparci-degli-attacchi-xss" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<p>Gli attacchi Cross-Site Scripting (XSS) rappresentano una minaccia significativa per la sicurezza delle applicazioni web e degli utenti che vi accedono. La gravità degli attacchi XSS deriva dalla loro capacità di compromettere l’integrità e la privacy sia degli utenti che delle organizzazioni. Di seguito, alcuni dei motivi principali per cui è essenziale prendere sul serio le vulnerabilità XSS:</p>
<h3 id="furto-di-cookie-di-sessione">Furto di Cookie di Sessione<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#furto-di-cookie-di-sessione" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>Gli attacchi XSS possono consentire agli aggressori di rubare i cookie di sessione degli utenti. Questo permette agli aggressori di impersonare le vittime, accedendo ai loro account senza richiedere username e password.</p>
<h3 id="creazione-di-richieste-false">Creazione di Richieste False<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#creazione-di-richieste-false" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>Gli aggressori possono utilizzare script XSS per creare richieste false da parte dell’utente, come se fossero richieste legittime. Ciò può portare a cambiamenti non autorizzati dei dati dell’utente o ad azioni indesiderate sul sito web.</p>
<h3 id="raccolta-di-credenziali-tramite-campi-falsi">Raccolta di Credenziali tramite Campi Falsi<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#raccolta-di-credenziali-tramite-campi-falsi" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>Mediante lo scripting XSS, gli aggressori possono inserire campi di input falsi nelle pagine web, ingannando gli utenti affinché inseriscano le proprie credenziali, che vengono poi catturate dagli aggressori.</p>
<h3 id="reindirizzamento-a-siti-malevoli">Reindirizzamento a Siti Malevoli<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#reindirizzamento-a-siti-malevoli" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>Un attacco XSS può reindirizzare gli utenti da una pagina legittima a un sito web malevolo o non amichevole, potenzialmente esponendo gli utenti a malware o tentativi di phishing.</p>
<h3 id="mascheramento-di-richieste-come-utente-valido">Mascheramento di Richieste Come Utente Valido<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#mascheramento-di-richieste-come-utente-valido" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>Gli script XSS possono essere usati per creare richieste che appaiono come se fossero state effettuate da un utente valido, compromettendo l’integrità delle interazioni con l’applicazione.</p>
<h3 id="furto-di-informazioni-riservate">Furto di Informazioni Riservate<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#furto-di-informazioni-riservate" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>Gli attacchi XSS possono portare al furto di informazioni riservate o sensibili, esponendo sia gli utenti individuali che le organizzazioni a rischi di privacy e sicurezza.</p>
<h3 id="esecuzione-di-codice-dannoso">Esecuzione di Codice Dannoso<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#esecuzione-di-codice-dannoso" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>Lo scripting XSS consente l’esecuzione di codice malevolo sui sistemi degli utenti finali. Questo può includere lo scripting attivo che sfrutta le vulnerabilità dei browser o altri software.</p>
<h3 id="inserimento-di-contenuti-ostili-o-inappropriati">Inserimento di Contenuti Ostili o Inappropriati<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#inserimento-di-contenuti-ostili-o-inappropriati" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>Gli attacchi XSS possono essere utilizzati per inserire contenuti ostili, inappropriati o persino diffamatori in una pagina web, danneggiando la reputazione di un’organizzazione e compromettendo l’esperienza dell’utente.</p>
<h3 id="legittimazione-degli-attacchi-di-phishing">Legittimazione degli Attacchi di Phishing<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#legittimazione-degli-attacchi-di-phishing" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>Gli attacchi XSS aggiungono un livello di legittimità agli attacchi di phishing, utilizzando domini validi nell’URL per mascherare intenti malevoli, rendendo più difficile per gli utenti riconoscere tentativi fraudolenti.</p>
<h2 id="tipi-di-attacchi-xss">Tipi di Attacchi XSS<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#tipi-di-attacchi-xss" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<p>Gli attacchi Cross-Site Scripting (XSS) si classificano in tre categorie principali in base al modo in cui il codice maligno viene inserito e eseguito nella pagina web. Queste categorie sono: XSS Riflesso, XSS basato su DOM e XSS Memorizzato (o Persistente). La comprensione delle differenze tra questi tipi è fondamentale per implementare misure di sicurezza efficaci.</p>
<h3 id="xss-riflesso">XSS Riflesso<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#xss-riflesso" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<ul>
<li>
<p><strong>Definizione</strong>: L’XSS riflesso si verifica quando il contenuto malevolo, proveniente da una richiesta dell’utente, viene immediatamente riflesso dal server e visualizzato nell’interfaccia utente del browser web. Questo tipo di attacco richiede tipicamente che la vittima clicchi su un link malevolo.</p>
</li>
<li>
<p><strong>Caratteristiche</strong>:</p>
<ul>
<li>Il contenuto dannoso è incluso nella risposta del server a seguito di una richiesta dell’utente.</li>
<li>Richiede l’ingegneria sociale per indurre la vittima a cliccare su un link o a inviare una richiesta contenente lo script malevolo.</li>
<li>Viene eseguito con i privilegi del browser ereditati dall’utente.</li>
</ul>
</li>
</ul>
<h3 id="xss-basato-su-dom-tecnicamente-riflesso">XSS basato su DOM (Tecnicamente Riflesso)<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#xss-basato-su-dom-tecnicamente-riflesso" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<ul>
<li>
<p><strong>Definizione</strong>: Il DOM-based XSS, o XSS basato sul Document Object Model, si verifica lato client quando gli script della pagina web manipolano i dati in ingresso dall’utente e scrivono o modificano il DOM della pagina con contenuti dannosi, senza un adeguato controllo o sanificazione da parte del server.</p>
</li>
<li>
<p><strong>Caratteristiche</strong>:</p>
<ul>
<li>Gli script lato client utilizzano contenuti malevoli provenienti da una richiesta dell’utente per scrivere o modificare il HTML della pagina.</li>
<li>Funziona in modo simile all’XSS riflesso, ma l’interazione avviene interamente sul lato client senza la necessità di una risposta malevola dal server.</li>
<li>Viene eseguito con i privilegi del browser ereditati dall’utente.</li>
</ul>
</li>
</ul>
<h3 id="xss-memorizzato-o-persistente">XSS Memorizzato o Persistente<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#xss-memorizzato-o-persistente" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<ul>
<li>
<p><strong>Definizione</strong>: L’XSS memorizzato si verifica quando il contenuto malevolo viene salvato su un server (ad esempio, in un database, sistema di file o altri oggetti) e successivamente visualizzato agli utenti in un browser web. A differenza dell’XSS riflesso, non richiede ingegneria sociale per essere sfruttato.</p>
</li>
<li>
<p><strong>Caratteristiche</strong>:</p>
<ul>
<li>Il contenuto dannoso è conservato sul server e mostrato automaticamente nelle pagine web agli utenti finali, senza richiedere azioni specifiche dalla vittima per attivare lo script malevolo.</li>
<li>Non richiede l’ingegneria sociale per influenzare la vittima, rendendolo particolarmente insidioso.</li>
<li>Può avere un impatto significativo poiché il contenuto malevolo può essere visualizzato a molti utenti o in molteplici sessioni fino alla sua rimozione dal server.</li>
</ul>
</li>
</ul>
<h2 id="scenario-di-attacco-xss-riflesso">Scenario di Attacco XSS Riflesso<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#scenario-di-attacco-xss-riflesso" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<p>Lo scenario di un attacco XSS riflesso illustra un percorso comune utilizzato dagli aggressori per compromettere i dati degli utenti e ottenere accesso non autorizzato alle informazioni sensibili. Questo tipo di attacco sfrutta la fiducia dell’utente in un sito web legittimo per eseguire codice malevolo attraverso un URL manipolato. Di seguito è descritto in dettaglio uno scenario tipico di attacco XSS riflesso:</p>
<h3 id="1-creazione-dellurl-malevolo">1. Creazione dell’URL Malevolo<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#1-creazione-dellurl-malevolo" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<ul>
<li><strong>Azione dell’Aggressore</strong>: L’aggressore crea un URL che incorpora uno script malevolo. Questo URL è progettato per essere inviato a un sito web legittimo, ma con l’intento di riflettere lo script inserito nell’URL stesso sulla pagina web visitata dall’utente.</li>
</ul>
<h3 id="2-invio-dellurl-alla-vittima">2. Invio dell’URL alla Vittima<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#2-invio-dellurl-alla-vittima" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<ul>
<li><strong>Diffusione</strong>: L’aggressore invia l’URL malevolo alla vittima. Questo può avvenire tramite email, messaggi, forum o attraverso qualsiasi mezzo che permetta alla vittima di cliccare sul link. L’ingegneria sociale gioca un ruolo chiave in questa fase, poiché l’aggressore deve convincere la vittima a cliccare sul link.</li>
</ul>
<h3 id="3-vittima-clicca-sul-link">3. Vittima Clicca sul Link<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#3-vittima-clicca-sul-link" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<ul>
<li><strong>Interazione della Vittima</strong>: La vittima, convinta della legittimità del link, clicca sull’URL. Il link conduce la vittima a visitare una pagina web legittima, ma l’URL contiene lo script malevolo progettato per essere eseguito.</li>
</ul>
<h3 id="4-esecuzione-dello-script-malevolo">4. Esecuzione dello Script Malevolo<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#4-esecuzione-dello-script-malevolo" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<ul>
<li><strong>Attacco</strong>: Una volta che la pagina web viene caricata nel browser della vittima, lo script malevolo incorporato nell’URL viene eseguito. Operando con i privilegi del browser della vittima, lo script ha la capacità di eseguire varie azioni dannose, come:
<ul>
<li>Rubare informazioni sensibili, ad esempio l’ID di sessione dell’utente.</li>
<li>Catturare input dell’utente o modificare il contenuto visualizzato nella pagina.</li>
<li>Inviare i dati rubati all’aggressore tramite richieste web a server controllati dall’aggressore.</li>
</ul>
</li>
</ul>
<h3 id="5-la-vittima-rimane-ignara-dellattacco">5. La Vittima Rimane Ignara dell’Attacco<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#5-la-vittima-rimane-ignara-dellattacco" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<ul>
<li><strong>Conseguenze</strong>: La particolarità e la pericolosità dell’XSS riflesso risiede nel fatto che l’utente potrebbe non rendersi conto che un attacco è avvenuto. Poiché lo script viene eseguito all’interno del contesto di una pagina web legittima, le sue azioni malevole possono passare inosservate.</li>
</ul>
<p>Per comprendere come testare una possibile vulnerabilità XSS riflesso, esamineremo un esperimento controllato che illustra come identificare un campo suscettibile a tale attacco. È importante sottolineare che questo tipo di test dovrebbe essere eseguito solo in ambienti sicuri e autorizzati, mai su siti web reali senza il permesso esplicito dei proprietari del sito. L’esempio seguente è puramente ipotetico e intende fornire una comprensione di base di come si possa procedere.</p>
<h3 id="scenario-carrello-della-spesa">Scenario: Carrello della Spesa<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#scenario-carrello-della-spesa" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>Immaginiamo di avere una pagina web che rappresenta un carrello della spesa con vari articoli elencati. Alla fine della pagina, viene chiesto di inserire il numero della carta di credito e un codice di accesso a tre cifre per procedere all’acquisto.</p>
<h3 id="obiettivo">Obiettivo<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#obiettivo" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>L’obiettivo è identificare se uno dei campi per l’input dell’utente (ad esempio, il numero della carta di credito o il codice di accesso a tre cifre) è vulnerabile ad attacchi XSS riflessi.</p>
<h3 id="procedimento">Procedimento<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#procedimento" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<ol>
<li>
<p><strong>Preparazione dell’URL con Script Malevolo</strong>: Creare un URL che simuli l’invio di input malevolo a uno dei campi del carrello. Questo potrebbe essere fatto aggiungendo un parametro all’URL che contenga uno script, ad esempio:</p>
<pre><code>https://example.com/cart?creditcard=&lt;script>alert('XSS')&lt;/script>
</code></pre>
<p>Oppure, se il sito utilizza metodi POST per inviare i dati, potresti aver bisogno di utilizzare strumenti di sviluppo del browser per modificare i dati inviati e includere lo script.</p>
</li>
<li>
<p><strong>Test con <code>alert()</code> o <code>console.log()</code></strong>: L’uso della funzione <code>alert()</code> o <code>console.log()</code> nello script inserito è un modo diretto per identificare se lo script viene eseguito. Se dopo l’invio dell’input malevolo, vedi apparire un pop-up di alert o un messaggio nella console del browser, il campo è vulnerabile.</p>
<ul>
<li><strong>Esempio di Alert</strong>: <code>&lt;script>alert('Test XSS')&lt;/script></code></li>
<li><strong>Esempio di Console.log</strong>: <code>&lt;script>console.log('Test XSS')&lt;/script></code></li>
</ul>
</li>
<li>
<p><strong>Analisi dei Risultati</strong>: Se l’alert appare o il messaggio viene stampato nella console, significa che il campo di input non sta adeguatamente sanificando l’input dell’utente, rendendolo vulnerabile ad attacchi XSS.</p>
</li>
</ol>
<p>Il concetto di “Self XSS” si riferisce a una forma di attacco Cross-Site Scripting (XSS) in cui lo script malevolo viene eseguito a causa dell’azione diretta dell’utente che utilizza il proprio browser, piuttosto che essere ingannato o indotto a eseguire lo script tramite un link o un contenuto fornito da un aggressore. Questo tipo di attacco sfrutta l’interazione diretta dell’utente con il browser, facendo leva su tecniche di ingegneria sociale o sulla mancanza di consapevolezza dell’utente riguardo alla sicurezza.</p>
<h3 id="perché-è-considerato-self-xss">Perché è Considerato “Self XSS”?<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#perché-è-considerato-self-xss" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>Nel contesto fornito, l’esecuzione dello script tramite l’URL diretto, come:</p>
<pre><code>/WebGoat/CrossSiteScripting/attack5a?QTY1=1&amp;QTY2=1&amp;QTY3=1&amp;QTY4=1&amp;field1=&lt;script>alert('my%20javascript%20here')&lt;/script>4128+3214+0002+1999&amp;field2=111
</code></pre>
<p>è considerata “Self XSS” perché l’azione non è scatenata da un link preparato da un aggressore o da una fonte esterna, ma piuttosto dall’inserimento diretto e volontario dell’URL con lo script da parte dell’utente nel proprio browser. In questo caso, l’utente sta essenzialmente “auto-infliggendosi” l’attacco XSS.</p>
<h3 id="caratteristiche-del-self-xss">Caratteristiche del Self XSS<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#caratteristiche-del-self-xss" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<ul>
<li><strong>Azioni dell’Utente</strong>: L’utente esegue azioni dirette che attivano lo script XSS, come inserire un URL manipolato o eseguire script nella console del browser.</li>
<li><strong>Mancanza di Inganno</strong>: A differenza degli attacchi XSS tradizionali, dove l’aggressore inganna l’utente per eseguire lo script malevolo, nel Self XSS, l’utente compie consapevolmente l’azione.</li>
<li><strong>Limitato a Auto-Compromissione</strong>: L’efficacia di questo tipo di attacco si limita all’auto-compromissione; non può essere utilizzato direttamente per compromettere altri utenti senza un elemento di ingegneria sociale che induca gli utenti a eseguire lo script da sé.</li>
</ul>
<h3 id="rischi-associati-al-self-xss">Rischi Associati al Self XSS<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#rischi-associati-al-self-xss" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>Sebbene il Self XSS possa sembrare meno pericoloso rispetto ad altre forme di XSS, può essere sfruttato in attacchi di ingegneria sociale dove gli aggressori ingannano le vittime affinché eseguano manualmente script malevoli, ad esempio, convincendole a inserire script dannosi nella console del browser con la promessa di sbloccare funzionalità nascoste o ottenere benefici.</p>
<p>Gli attacchi XSS basati su DOM e gli attacchi XSS Riflessi rappresentano due modalità attraverso cui gli aggressori possono eseguire script malevoli nel browser di una vittima. Sebbene condividano alcuni aspetti, differiscono significativamente nel flusso di esecuzione e nella modalità di sfruttamento della vulnerabilità.</p>
<h3 id="xss-riflesso-1">XSS Riflesso<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#xss-riflesso-1" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<ul>
<li>
<p><strong>Flusso di Esecuzione</strong>: Nell’XSS riflesso, lo script malevolo è incluso nell’URL che l’aggressore invia alla vittima. Quando la vittima clicca sul link, la richiesta viene inviata al server, che poi riflette l’input malevolo nella risposta HTML. Di conseguenza, lo script viene eseguito nel contesto del sito web visitato.</p>
</li>
<li>
<p><strong>Caratteristiche Principali</strong>:</p>
<ul>
<li>Richiede ingegneria sociale per indurre la vittima a cliccare sul link.</li>
<li>Il payload (il codice malevolo) viene elaborato dal server e poi eseguito dal browser della vittima.</li>
<li>Utilizzato spesso per rubare informazioni, come i cookie di sessione, o per eseguire azioni malevole rappresentando la vittima.</li>
</ul>
</li>
</ul>
<h3 id="xss-basato-su-dom">XSS basato su DOM<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#xss-basato-su-dom" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<ul>
<li>
<p><strong>Flusso di Esecuzione</strong>: Nell’XSS basato su DOM, il payload malevolo non viene inviato al server. Invece, è interamente elaborato e eseguito lato client (nel browser della vittima) attraverso la manipolazione del DOM della pagina web. Questo tipo di attacco sfrutta le vulnerabilità presenti nel codice JavaScript o nelle funzioni che manipolano il DOM senza adeguata sanificazione.</p>
</li>
<li>
<p><strong>Caratteristiche Principali</strong>:</p>
<ul>
<li>Non richiede che il payload passi attraverso il server; l’attacco avviene interamente sul lato client.</li>
<li>Può essere scatenato da una varietà di fonti, inclusi link, che manipolano il DOM della pagina.</li>
<li>Spesso più difficile da rilevare e prevenire perché il codice malevolo non passa attraverso il server.</li>
</ul>
</li>
</ul>
<h3 id="scenario-di-attacco">Scenario di Attacco<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#scenario-di-attacco" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<ol>
<li><strong>Invio dell’URL Malevolo</strong>: L’aggressore confeziona un URL che include il payload XSS e lo invia alla vittima.</li>
<li><strong>Clic sulla Vittima</strong>: La vittima clicca sul link, che carica una pagina web vulnerabile.</li>
<li><strong>Esecuzione dello Script</strong>:
<ul>
<li>Nel caso dell’XSS riflesso, il server restituisce una pagina che include ed esegue lo script malevolo.</li>
<li>Per l’XSS basato su DOM, il payload modifica il DOM della pagina direttamente nel browser, eseguendo lo script senza che il codice passi dal server.</li>
</ul>
</li>
</ol>
<h3 id="considerazioni-sulla-sicurezza">Considerazioni sulla Sicurezza<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#considerazioni-sulla-sicurezza" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<ul>
<li><strong>Rilevamento e Prevenzione</strong>: Mentre le tecniche tradizionali di sanificazione lato server possono essere efficaci contro l’XSS riflesso, l’XSS basato su DOM richiede un’attenzione particolare alla sanificazione e alla validazione dei dati lato client, oltre all’uso di Content Security Policy (CSP) per limitare le fonti di script eseguibili.</li>
<li><strong>Consapevolezza degli Utenti</strong>: Gli utenti devono essere educati sull’importanza di non cliccare su link sospetti e di mantenere aggiornati i loro browser per beneficiare delle ultime misure di sicurezza.
Identificare il potenziale per attacchi XSS basati su DOM richiede una comprensione di come le applicazioni web manipolano il Document Object Model (DOM) e gestiscono i dati forniti dall’utente. In questo contesto, l’esame del codice lato client, specialmente la configurazione delle route e i gestori degli eventi, è cruciale. Vediamo come approcciare questa indagine con un esempio generico, dato che non posso interagire direttamente con il codice sorgente o esaminare applicazioni specifiche.</li>
</ul>
<h3 id="passaggi-per-identificare-xss-basato-su-dom">Passaggi per Identificare XSS basato su DOM<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#passaggi-per-identificare-xss-basato-su-dom" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<ol>
<li>
<p><strong>Esaminare il Codice Client</strong>: Inizia esaminando il codice JavaScript lato client dell’applicazione. Se l’applicazione utilizza librerie o framework come Backbone, Angular, React, o Vue, presta particolare attenzione alla definizione delle route e ai gestori degli eventi associati.</p>
</li>
<li>
<p><strong>Identificare la Configurazione delle Route</strong>: Cerca le configurazioni delle route all’interno del codice. Le route determinano quali gestori vengono chiamati quando l’URL cambia. Ad esempio, con Backbone, potresti cercare istanze di <code>Backbone.Router</code>.</p>
</li>
<li>
<p><strong>Ricerca di Input Riflessi</strong>: Identifica le route che accettano input dall’URL e poi “riflettono” questi input direttamente sulla pagina, senza adeguata sanificazione. Questo può includere qualsiasi cosa, dall’inserimento diretto di testo nell’HTML a modifiche del DOM basate su valori di parametro.</p>
</li>
<li>
<p><strong>Esaminare i Gestori di Route per Codice di Test</strong>: Spesso, durante lo sviluppo, il codice di test viene inserito per verificare la funzionalità. Questo codice di test può essere dimenticato e lasciato nel codice in produzione. Se questo codice gestisce male gli input, può presentare una vulnerabilità.</p>
</li>
</ol>
<h3 id="esempio-pratico">Esempio Pratico<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#esempio-pratico" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>Dato il contesto ipotetico di un’applicazione che utilizza <code>start.mvc#lesson/</code> come base route, potresti trovare una configurazione simile per il codice di test:</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="javascript" data-theme="github-light github-dark"><code data-language="javascript" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">var</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> AppRouter </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Backbone.Router.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">extend</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    routes: {</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        &quot;test/:param&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;testRouteHandler&quot;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> // Esempio di configurazione di route vulnerabile</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    },</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    testRouteHandler</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">param</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // Un semplice esempio di gestore che riflette direttamente l'input nell'HTML</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        document.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getElementById</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">'someElement'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">).innerHTML </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> param;</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span></code></pre></figure>
<p>In questo esempio, <code>test/:param</code> è una route che potrebbe essere vulnerabile a XSS basato su DOM se l’input non viene sanificato prima di essere inserito nel DOM.</p>
<h3 id="come-sfruttare-la-vulnerabilità">Come Sfruttare la Vulnerabilità<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#come-sfruttare-la-vulnerabilità" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>Per sfruttare una vulnerabilità come questa, un aggressore potrebbe creare un URL che inserisce uno script nel parametro <code>param</code>, come segue:</p>
<pre><code>https://example.com/start.mvc#test/&lt;script>alert('XSS')&lt;/script>
</code></pre>
<p>Ovviamente lo script va inserito nell’URL con l’encoding corretto.</p>
<p>Quando un utente visita questo URL, il codicscript>alert(“ciao”)<script>e JavaScript iniettato viene eseguito, dimostrando la vulnerabilità a XSS basato su DOM.</script>
</p><h2 id="stored-cross-site-scripting-xss-memorizzato">Stored Cross-Site Scripting (XSS) Memorizzato<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#stored-cross-site-scripting-xss-memorizzato" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<p>Lo XSS memorizzato, noto anche come XSS persistente, rappresenta una forma particolarmente insidiosa di attacchi XSS. A differenza dello XSS riflesso o basato su DOM, in cui lo script malevolo viene passato tramite un link e si basa sull’interazione immediata dell’utente per essere eseguito, lo XSS memorizzato salva il payload malevolo direttamente sul server. Questo approccio consente allo script di persistere nel tempo e di essere eseguito ogni volta che un utente accede alla parte vulnerabile dell’applicazione web.</p>
<h3 id="scenario-di-attacco-xss-memorizzato">Scenario di Attacco XSS Memorizzato<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#scenario-di-attacco-xss-memorizzato" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>Lo scenario tipico di un attacco XSS memorizzato si svolge nei seguenti passaggi:</p>
<ol>
<li>
<p><strong>Pubblicazione dello Script Malevolo</strong>: L’aggressore inserisce uno script malevolo in un input dell’applicazione web che accetta e memorizza dati, come un forum di messaggi, un campo di commento o un profilo utente.</p>
</li>
<li>
<p><strong>Memorizzazione nel Database del Server</strong>: Lo script inserito viene salvato nel database del server senza adeguata sanificazione o validazione. Questo permette allo script di persistere all’interno del sistema.</p>
</li>
<li>
<p><strong>Lettura del Messaggio da Parte della Vittima</strong>: Quando un’altra utenza (la vittima) accede alla parte dell’applicazione che visualizza i dati memorizzati (ad esempio, leggendo un messaggio sul forum), lo script malevolo viene eseguito nel suo browser.</p>
</li>
<li>
<p><strong>Esecuzione dello Script e Furto di Informazioni</strong>: Lo script eseguito può compiere una varietà di azioni dannose, come il furto di informazioni sensibili (ad esempio, session ID o dati personali), l’esecuzione di azioni nel contesto dell’utente senza il suo consenso o il reindirizzamento a siti malevoli.</p>
</li>
<li>
<p><strong>L’Inconsapevolezza della Vittima</strong>: Tipicamente, la vittima non si rende conto che un attacco è avvenuto, poiché lo script viene eseguito in modo trasparente durante la visualizzazione del contenuto legittimo dell’applicazione.</p>
</li>
</ol>
<h3 id="impatto-degli-attacchi-xss-memorizzati">Impatto degli Attacchi XSS Memorizzati<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#impatto-degli-attacchi-xss-memorizzati" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>Gli attacchi XSS memorizzati sono particolarmente pericolosi per diversi motivi:</p>
<ul>
<li><strong>Ampio Raggio di Azione</strong>: Una volta che lo script malevolo è memorizzato sul server, può potenzialmente influenzare tutti gli utenti che accedono alla parte vulnerabile dell’applicazione.</li>
<li><strong>Durata</strong>: Lo script può rimanere memorizzato per un lungo periodo, continuando a compromettere gli utenti fino alla sua identificazione e rimozione.</li>
<li><strong>Difficoltà di Rilevamento</strong>: Spesso è difficile per gli amministratori del sistema rilevare la presenza di script malevoli memorizzati, soprattutto se non sono state implementate adeguate misure di sicurezza.</li>
</ul>
<h2 id="conclusioni">Conclusioni<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#conclusioni" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<p>Concludendo, gli attacchi XSS basati su DOM rappresentano una minaccia significativa alla sicurezza delle applicazioni web moderne. Sfruttando le vulnerabilità nel codice JavaScript che manipola il Document Object Model (DOM) senza adeguata sanificazione dell’input, gli aggressori possono eseguire script malevoli nel browser degli utenti. Questo tipo di attacco illustra l’importanza critica della sicurezza lato client e sottolinea la necessità per gli sviluppatori di essere meticolosi nella gestione degli input dell’utente e nella manipolazione del DOM.</p>
<p>L’esperimento ipotetico di tentare un attacco XSS basato su DOM attraverso l’uso di un URL modificato per riflettere un parametro e eseguire una funzione interna dimostra sia la potenziale vulnerabilità delle applicazioni web sia l’astuzia richiesta per sfruttare tali vulnerabilità. Questo tipo di attacco, che non necessita che il payload passi attraverso il server, ma avviene interamente sul lato client, rende evidente la complessità della sicurezza web e la necessità di approcci di difesa multi-strato.</p>
<p>Inoltre, il contesto “self XSS” e il concetto di XSS riflesso rivelano come la manipolazione diretta dell’URL o la convinzione della vittima a eseguire azioni specifiche possano portare a compromissioni di sicurezza significative. La discrezione con cui questi attacchi possono essere portati a termine, spesso senza che la vittima si renda conto di essere stata compromessa, sottolinea l’importanza per gli utenti di rimanere vigili e per gli sviluppatori di costruire applicazioni resilienti.</p>
<p>Infine, mentre esplorare e comprendere le vulnerabilità XSS e le tecniche per sfruttarle può essere un’attività formativa utile per migliorare la sicurezza delle applicazioni, è fondamentale che tali esplorazioni avvengano in contesti legali e etici, come ambienti di test autorizzati o piattaforme educative come WebGoat. La consapevolezza e l’educazione sulla sicurezza informatica sono fondamentali per costruire un futuro digitale più sicuro per tutti.</p>
<p>La prevenzione degli attacchi XSS memorizzati richiede una combinazione di sanificazione rigorosa dell’input, politiche di Content Security Policy (CSP), e l’adozione di pratiche di sviluppo sicuro per evitare che input malevoli siano salvati e poi eseguiti dal server. Educare gli sviluppatori sull’importanza della sicurezza dell’applicazione e implementare controlli di sicurezza robusti sono passaggi fondamentali per proteggere gli utenti da queste vulnerabilità pervasive e dannose.</p>
<h1 id="mitigation-contro-xss-cross-site-scripting">Mitigation contro XSS (Cross-Site Scripting)<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#mitigation-contro-xss-cross-site-scripting" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h1>
<p>La difesa contro gli attacchi di tipo Cross-Site Scripting (XSS) rappresenta una componente cruciale della sicurezza informatica nelle applicazioni web. Questi attacchi permettono agli aggressori di inserire script maligni nelle pagine visualizzate dagli altri utenti, potenzialmente compromettendo la sicurezza dell’utente e ottenendo accesso non autorizzato a informazioni sensibili. Di seguito sono illustrate le pratiche fondamentali per difendersi da tali attacchi.</p>
<h3 id="perché-è-importante-difendersi-da-xss">Perché è importante difendersi da XSS<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#perché-è-importante-difendersi-da-xss" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>La difesa contro gli attacchi XSS è essenziale per proteggere sia gli utenti che le applicazioni web dall’esecuzione di codice maligno nel contesto di sessioni utente autenticate. Un attacco XSS riuscito può consentire a un aggressore di rubare token di sessione, credenziali di accesso, e di manipolare i contenuti visualizzati all’utente, compromettendo l’integrità e la confidenzialità dei dati.</p>
<h3 id="cosa-codificare">Cosa codificare<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#cosa-codificare" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>Il principio base nella difesa contro XSS consiste nella codifica in output di ogni input non fidato visualizzato a schermo. Questo approccio, sebbene possa sembrare semplice, rimane la miglior difesa contro gli attacchi XSS. È fondamentale trattare ogni input come non fidato, anche i dati inseriti nel proprio database, poiché potrebbero essere stati compromessi o alterati da sistemi esterni.</p>
<h3 id="quando-e-dove-codificare">Quando e Dove Codificare<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#quando-e-dove-codificare" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>È consigliabile codificare i dati non fidati nel momento in cui vengono inviati al browser, evitando di codificarli direttamente nei dati persistenti. Nel contesto delle applicazioni web single-page (SPA), la codifica deve avvenire lato client. È importante consultare la documentazione specifica del framework o della libreria utilizzata per implementare correttamente questa difesa.</p>
<h3 id="come-codificare">Come Codificare<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#come-codificare" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<ul>
<li><strong>Nel corpo HTML:</strong> Utilizzare la codifica delle entità HTML per qualsiasi input visualizzato nel corpo della pagina.</li>
<li><strong>Negli attributi HTML:</strong> Similmente, codificare come entità HTML gli input che vengono inseriti come valore degli attributi HTML.</li>
<li><strong>Nel codice JavaScript:</strong> Nel caso in cui l’input dell’utente sia incluso in codice JavaScript, è necessario codificarlo in modo appropriato. Tuttavia, è fondamentale riflettere sulla necessità di includere input utente in script eseguibili all’interno della pagina, data l’alta potenziale esposizione a rischi di sicurezza.</li>
</ul>
<p>È importante evitare approcci basati su liste nere o filtri negativi, come tentare di bloccare esplicitamente stringhe come <code>&lt;script></code>, poiché gli aggressori possono facilmente eludere tali misure utilizzando tecniche di codifica o sfruttando vulnerabilità non considerate dal filtro.</p>
<h3 id="risorse-consigliate">Risorse consigliate<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#risorse-consigliate" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>Sebbene in questa sezione non siano elencate risorse specifiche, è altamente consigliabile consultare la documentazione ufficiale dei framework e delle librerie utilizzate, oltre a guide e best practices fornite da enti di standardizzazione e sicurezza informatica come OWASP (Open Web Application Security Project), che offre ampie risorse, guide e strumenti per la difesa da attacchi XSS e altre vulnerabilità web.</p>
<p>Ricordare sempre che la sicurezza è un processo in continua evoluzione: rimanere aggiornati sulle ultime minacce e sulle tecniche di difesa è fondamentale per mantenere le applicazioni e i dati degli utenti sicuri.</p>
<h2 id="codifica-e-escaping-dei-dati">Codifica e Escaping dei Dati<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#codifica-e-escaping-dei-dati" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<p>La codifica e l’escaping dei dati sono tecniche fondamentali nella prevenzione degli attacchi di Cross-Site Scripting (XSS) e nella sicurezza delle applicazioni web in generale. Questi metodi proteggono le applicazioni e i loro utenti dall’esecuzione di script maligni inseriti da attori esterni.</p>
<h3 id="cosa-significa-non-fidarsi-dellinput-utente">Cosa Significa Non Fidarsi dell’Input Utente<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#cosa-significa-non-fidarsi-dellinput-utente" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>Non fidarsi dell’input dell’utente implica una serie di pratiche per assicurarsi che i dati forniti siano sicuri prima di utilizzarli all’interno dell’applicazione. Questo include la validazione dei dati per tipo, lunghezza, formato e range quando attraversano un confine di fiducia, ad esempio, da un modulo web a uno script dell’applicazione. Dopo la validazione, i dati devono essere codificati prima di essere reinseriti in una pagina dinamica.</p>
<h3 id="revisione-e-trattamento-dei-dati-forniti-dallutente">Revisione e Trattamento dei Dati Forniti dall’Utente<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#revisione-e-trattamento-dei-dati-forniti-dallutente" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>È necessario esaminare ogni punto del sito dove i dati forniti dagli utenti vengono gestiti ed elaborati, assicurandosi che, prima di essere restituiti all’utente, i valori accettati dal lato client siano controllati, filtrati e codificati. La validazione lato client non è sufficientemente affidabile; tuttavia, l’input dell’utente può essere ridotto a un set alfanumerico minimo con l’elaborazione lato server prima di essere utilizzato dall’applicazione web.</p>
<h3 id="escaping">Escaping<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#escaping" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>L’escaping implica la conversione (o la marcatura) dei caratteri chiave nei dati per prevenirne l’interpretazione in un contesto pericoloso. Nel contesto dell’output HTML, è necessario convertire caratteri come <code>&lt;</code> e <code>></code> in entità equivalenti, <code>&amp;lt;</code> e <code>&amp;gt;</code>, per impedire l’esecuzione di codice maligno. Questi caratteri, una volta convertiti, non verranno interpretati come tag HTML dal browser.</p>
<h3 id="caratteri-speciali">Caratteri Speciali<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#caratteri-speciali" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>È necessario codificare i caratteri speciali come <code>&lt;</code> e <code>></code> prima che vengano visualizzati di nuovo, se ricevuti dall’input dell’utente. Ad esempio, la codifica di <code>&lt;</code> e <code>></code> assicura che un browser visualizzi <code>&lt;script></code> ma non lo esegua. In aggiunta alla codifica, le pagine web devono sempre definire il loro set di caratteri in modo che il browser non interpreti le codifiche dei caratteri speciali provenienti da altri set di caratteri.</p>
<h3 id="caratteri-speciali-rilevanti-in-xmlhtml">Caratteri Speciali Rilevanti in XML/HTML<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#caratteri-speciali-rilevanti-in-xmlhtml" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<ul>
<li><strong>&lt; (Minore di):</strong> <code>&amp;lt;</code></li>
<li><strong>> (Maggiore di):</strong> <code>&amp;gt;</code></li>
<li><strong>” (Virgoletta doppia):</strong> <code>&amp;quot;</code></li>
<li><strong>’ (Apostrofo):</strong> <code>&amp;#x27;</code></li>
<li><strong>&amp; (E commerciale):</strong> <code>&amp;amp;</code></li>
<li><strong>/ (Slash):</strong> <code>&amp;#x2F;</code></li>
</ul>
<p>Gli attacchi XSS si verificano solitamente quando uno script maligno (spesso JavaScript) viene inserito in un sito web, consentendo l’esecuzione di codice dannoso. La codifica e l’escaping dei dati sono misure preventive essenziali per proteggere le applicazioni web da tali minacce.</p>
<h2 id="risorse-per-la-difesa-contro-xss">Risorse per la Difesa contro XSS<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#risorse-per-la-difesa-contro-xss" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<p>La difesa contro gli attacchi Cross-Site Scripting (XSS) richiede un approccio informato e proattivo. Fortunatamente, esistono numerose risorse che possono aiutare gli sviluppatori a proteggere le loro applicazioni. Di seguito sono elencate alcune delle risorse più utili fornite dall’OWASP (Open Web Application Security Project), una fondazione che gioca un ruolo chiave nella diffusione delle migliori pratiche di sicurezza delle applicazioni web.</p>
<h3 id="owasp-java-encoder">OWASP Java Encoder<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#owasp-java-encoder" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<ul>
<li><strong>Progetto:</strong> OWASP Java Encoder</li>
<li><strong>Descrizione:</strong> Una libreria dedicata alla difesa delle applicazioni web Java contro XSS, convertendo i dati in formati sicuri per l’HTML.</li>
<li><strong>Link:</strong> <a href="https://www.owasp.org/index.php/OWASP_Java_Encoder_Project" class="external">OWASP Java Encoder Project<svg aria-hidden="true" class="external-icon" style="max-width:0.8em;max-height:0.8em;" viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a></li>
</ul>
<h3 id="general-xss-prevention-cheat-sheet">General XSS Prevention Cheat Sheet<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#general-xss-prevention-cheat-sheet" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<ul>
<li><strong>Descrizione:</strong> Una guida completa alle strategie di prevenzione contro gli attacchi XSS, inclusi i metodi di codifica e le pratiche di sanitizzazione.</li>
<li><strong>Link:</strong> <a href="https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html" class="external">General XSS Prevention Cheat Sheet<svg aria-hidden="true" class="external-icon" style="max-width:0.8em;max-height:0.8em;" viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a></li>
</ul>
<h3 id="dom-xss-prevention-cheat-sheet">DOM XSS Prevention Cheat Sheet<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#dom-xss-prevention-cheat-sheet" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<ul>
<li><strong>Descrizione:</strong> Una risorsa specifica per la prevenzione di attacchi XSS basati sul DOM, con consigli e tecniche per mitigare questo tipo di vulnerabilità.</li>
<li><strong>Link:</strong> <a href="https://cheatsheetseries.owasp.org/cheatsheets/DOM_based_XSS_Prevention_Cheat_Sheet.html" class="external">DOM XSS Prevention Cheat Sheet<svg aria-hidden="true" class="external-icon" style="max-width:0.8em;max-height:0.8em;" viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a></li>
</ul>
<h3 id="xss-filter-evasion-cheat-sheet">XSS Filter Evasion Cheat Sheet<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#xss-filter-evasion-cheat-sheet" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<ul>
<li><strong>Descrizione:</strong> Una guida per comprendere come gli attaccanti possono eludere i filtri XSS e come rafforzare le difese per prevenirlo.</li>
<li><strong>Link:</strong> <a href="https://www.owasp.org/index.php/XSS_Filter_Evasion_Cheat_Sheet" class="external">XSS Filter Evasion Cheat Sheet<svg aria-hidden="true" class="external-icon" style="max-width:0.8em;max-height:0.8em;" viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a></li>
</ul>
<h3 id="specifici-dei-framework-javascript">Specifici dei Framework JavaScript<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#specifici-dei-framework-javascript" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>La codifica lato client può presentare delle sfide uniche. Di seguito sono elencate alcune risorse per framework specifici:</p>
<h4 id="jquery">jQuery<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#jquery" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<ul>
<li>Attenzione all’uso di <code>$selector.html(userInputHere)</code>; è rischioso. Per un uso sicuro, preferire <code>$selector.html(someEncodeHtmlMethod(userInputHere))</code> o <code>$selector.text(someEncodeHtmlMethod(userInputHere))</code> per un output basato solo su testo.</li>
<li>Risorsa: <a href="http://stackoverflow.com/questions/9735045/is-jquery-text-method-xss-safe#9735118" class="external">jQuery .text Method XSS Safety<svg aria-hidden="true" class="external-icon" style="max-width:0.8em;max-height:0.8em;" viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a></li>
</ul>
<h4 id="backbonejs">Backbone.js<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#backbonejs" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<ul>
<li>La differenza può stare in un singolo carattere. Utilizzare template sicuri è fondamentale.</li>
<li>Risorse: <a href="http://underscorejs.org/#template" class="external">Underscore.js Template<svg aria-hidden="true" class="external-icon" style="max-width:0.8em;max-height:0.8em;" viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a>, <a href="https://nvisium.com/blog/2015/05/21/dont-break-your-backbone-xss-mitigation.html" class="external">Don’t Break Your Backbone: XSS Mitigation<svg aria-hidden="true" class="external-icon" style="max-width:0.8em;max-height:0.8em;" viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a></li>
</ul>
<h4 id="angular">Angular<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#angular" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<ul>
<li>Angular cerca di eseguire l’escaping per impostazione predefinita, ma è stato riscontrato che il linguaggio di espressione può essere soggetto a evasioni dal ‘sandbox’. È consigliabile verificare i dettagli della versione in uso e consultare la documentazione ufficiale.</li>
<li>Risorsa: <a href="https://docs.angularjs.org/guide/security" class="external">Angular Security Guide<svg aria-hidden="true" class="external-icon" style="max-width:0.8em;max-height:0.8em;" viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a></li>
</ul>
<p>Queste risorse rappresentano un punto di partenza essenziale per gli sviluppatori che cercano di rafforzare le difese delle loro applicazioni web contro gli attacchi XSS. Ricordarsi sempre di rimanere aggiornati sulle ultime tecniche di attacco e sulle strategie di difesa, poiché sia gli attacchi che le tecnologie web evolvono continuamente.
Per prevenire attacchi di tipo Reflective XSS attraverso l’escape dei parametri URL nel file JSP, è possibile utilizzare la JSTL (JavaServer Pages Standard Tag Library) per codificare in modo sicuro l’input dell’utente prima di visualizzarlo. Ciò implica l’utilizzo del tag <code>&lt;c:out></code>, che esegue automaticamente l’escape delle entità HTML e JavaScript, prevenendo così l’esecuzione di script maligni. Prima di tutto, assicurati che la JSTL sia inclusa nel tuo progetto; puoi farlo aggiungendo la libreria JSTL alla directory <code>WEB-INF/lib</code> della tua applicazione web.</p>
<p>Ecco come puoi modificare il file JSP per utilizzare il tag <code>&lt;c:out></code> per visualizzare in modo sicuro i dati degli utenti:</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="jsp" data-theme="github-light github-dark"><code data-language="jsp" data-theme="github-light github-dark" style="display:grid;"><span data-line><span>&lt;%@ page language=&quot;java&quot; contentType=&quot;text/html; charset=UTF-8&quot; pageEncoding=&quot;UTF-8&quot;%></span></span>
<span data-line><span>&lt;%@ taglib uri=&quot;http://java.sun.com/jsp/jstl/core&quot; prefix=&quot;c&quot;%></span></span>
<span data-line><span>&lt;html></span></span>
<span data-line> </span>
<span data-line><span>&lt;head></span></span>
<span data-line><span>    &lt;title>Utilizzo dei metodi GET e POST per leggere i dati del form&lt;/title></span></span>
<span data-line><span>&lt;/head></span></span>
<span data-line> </span>
<span data-line><span>&lt;body></span></span>
<span data-line><span>    &lt;h1>Utilizzo del metodo POST per leggere i dati del form&lt;/h1></span></span>
<span data-line><span>    &lt;table></span></span>
<span data-line><span>        &lt;tbody></span></span>
<span data-line><span>            &lt;tr></span></span>
<span data-line><span>                &lt;td>&lt;b>Nome:&lt;/b>&lt;/td></span></span>
<span data-line><span>                &lt;td>&lt;c:out value=&quot;${param.first_name}&quot; />&lt;/td></span></span>
<span data-line><span>            &lt;/tr></span></span>
<span data-line><span>            &lt;tr></span></span>
<span data-line><span>                &lt;td>&lt;b>Cognome:&lt;/b>&lt;/td></span></span>
<span data-line><span>                &lt;td>&lt;c:out value=&quot;${param.last_name}&quot; />&lt;/td></span></span>
<span data-line><span>            &lt;/tr></span></span>
<span data-line><span>        &lt;/tbody></span></span>
<span data-line><span>    &lt;/table></span></span>
<span data-line><span>&lt;/body></span></span>
<span data-line> </span>
<span data-line><span>&lt;/html></span></span></code></pre></figure>
<h3 id="modifiche-spiegate">Modifiche Spiegate:<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#modifiche-spiegate" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<ul>
<li><strong>Direttiva Taglib JSTL:</strong> La linea <code>&lt;%@ taglib uri=&quot;http://java.sun.com/jsp/jstl/core&quot; prefix=&quot;c&quot;%></code> viene aggiunta all’inizio del file per indicare l’uso della libreria JSTL. Questo permette di utilizzare i tag JSTL nel file JSP.</li>
<li><strong>Escape dell’input dell’utente:</strong> L’utilizzo del tag <code>&lt;c:out value=&quot;${param.first_name}&quot; /></code> e <code>&lt;c:out value=&quot;${param.last_name}&quot; /></code> consente di eseguire l’escape automatico dei caratteri speciali nell’input dell’utente, convertendoli in entità HTML sicure. Questo impedisce al browser di interpretare l’input come parte del codice della pagina, bloccando l’esecuzione di script potenzialmente pericolosi.
Per prevenire attacchi di tipo Stored XSS utilizzando OWASP AntiSamy, è necessario sanificare l’input dell’utente prima di salvarlo nel database. AntiSamy permette di creare una stringa “pulita” basandosi su un file di politiche (policy) configurabile. Ecco come si può modificare la classe <code>AntiSamyController</code> per includere questa funzionalità di sanificazione:</li>
</ul>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="java" data-theme="github-light github-dark"><code data-language="java" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> org.owasp.validator.html.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> MyCommentDAO;</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> AntiSamyController</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // Assumiamo che la connessione e altre configurazioni necessarie siano già state fatte</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ...</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> saveNewComment</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">int</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> threadID</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">int</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> userID</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, String </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">newComment</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">){</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        try</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">            // Crea un'istanza di AntiSamy basandosi sul file di policy</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            Policy policy </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Policy.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getInstance</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;path/to/antisamy-slashdot.xml&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Assicurati di specificare il percorso corretto del file di policy</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            AntiSamy antiSamy </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> AntiSamy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            </span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">            // Sanifica l'input dell'utente</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            CleanResults results </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> antiSamy.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">scan</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(newComment, policy);</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            </span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">            // Ottiene la stringa pulita e la salva nel database</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            String cleanComment </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> results.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getCleanHTML</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            MyCommentDAO.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">addComment</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(threadID, userID, cleanComment);</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">catch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (PolicyException | ScanException </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">e</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            e.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">printStackTrace</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">            // Gestire l'eccezione o registrare l'errore come più appropriato</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ...</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></figure>
<p>In questo esempio, il metodo <code>saveNewComment()</code> utilizza AntiSamy per sanificare <code>newComment</code> prima di salvarlo nel database. Questo processo di sanificazione utilizza un file di policy (<code>antisamy-slashdot.xml</code>) che definisce quali tag e attributi HTML sono permessi, garantendo così che l’input salvato nel database non contenga script potenzialmente dannosi.</p>
<p>È importante notare che il percorso del file di policy deve essere specificato correttamente. Questo file di policy può essere personalizzato per soddisfare le specifiche esigenze di sicurezza della tua applicazione.</p>
<p>Implementando questa soluzione, si previene efficacemente che l’input dannoso venga salvato e successivamente eseguito dal database, mitigando così il rischio di attacchi XSS di tipo Stored.</p></article><hr/><div class="page-footer"></div></div><div class="right sidebar"><div class="graph"><h3>Graph View</h3><div class="graph-outer"><div class="graph-container" data-cfg="{&quot;drag&quot;:true,&quot;zoom&quot;:true,&quot;depth&quot;:1,&quot;scale&quot;:1.1,&quot;repelForce&quot;:0.5,&quot;centerForce&quot;:0.3,&quot;linkDistance&quot;:30,&quot;fontSize&quot;:0.6,&quot;opacityScale&quot;:1,&quot;showTags&quot;:true,&quot;removeTags&quot;:[],&quot;focusOnHover&quot;:false,&quot;enableRadial&quot;:false}"></div><button class="global-graph-icon" aria-label="Global Graph"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 55 55" fill="currentColor" xml:space="preserve"><path d="M49,0c-3.309,0-6,2.691-6,6c0,1.035,0.263,2.009,0.726,2.86l-9.829,9.829C32.542,17.634,30.846,17,29,17
                s-3.542,0.634-4.898,1.688l-7.669-7.669C16.785,10.424,17,9.74,17,9c0-2.206-1.794-4-4-4S9,6.794,9,9s1.794,4,4,4
                c0.74,0,1.424-0.215,2.019-0.567l7.669,7.669C21.634,21.458,21,23.154,21,25s0.634,3.542,1.688,4.897L10.024,42.562
                C8.958,41.595,7.549,41,6,41c-3.309,0-6,2.691-6,6s2.691,6,6,6s6-2.691,6-6c0-1.035-0.263-2.009-0.726-2.86l12.829-12.829
                c1.106,0.86,2.44,1.436,3.898,1.619v10.16c-2.833,0.478-5,2.942-5,5.91c0,3.309,2.691,6,6,6s6-2.691,6-6c0-2.967-2.167-5.431-5-5.91
                v-10.16c1.458-0.183,2.792-0.759,3.898-1.619l7.669,7.669C41.215,39.576,41,40.26,41,41c0,2.206,1.794,4,4,4s4-1.794,4-4
                s-1.794-4-4-4c-0.74,0-1.424,0.215-2.019,0.567l-7.669-7.669C36.366,28.542,37,26.846,37,25s-0.634-3.542-1.688-4.897l9.665-9.665
                C46.042,11.405,47.451,12,49,12c3.309,0,6-2.691,6-6S52.309,0,49,0z M11,9c0-1.103,0.897-2,2-2s2,0.897,2,2s-0.897,2-2,2
                S11,10.103,11,9z M6,51c-2.206,0-4-1.794-4-4s1.794-4,4-4s4,1.794,4,4S8.206,51,6,51z M33,49c0,2.206-1.794,4-4,4s-4-1.794-4-4
                s1.794-4,4-4S33,46.794,33,49z M29,31c-3.309,0-6-2.691-6-6s2.691-6,6-6s6,2.691,6,6S32.309,31,29,31z M47,41c0,1.103-0.897,2-2,2
                s-2-0.897-2-2s0.897-2,2-2S47,39.897,47,41z M49,10c-2.206,0-4-1.794-4-4s1.794-4,4-4s4,1.794,4,4S51.206,10,49,10z"></path></svg></button></div><div class="global-graph-outer"><div class="global-graph-container" data-cfg="{&quot;drag&quot;:true,&quot;zoom&quot;:true,&quot;depth&quot;:-1,&quot;scale&quot;:0.9,&quot;repelForce&quot;:0.5,&quot;centerForce&quot;:0.2,&quot;linkDistance&quot;:30,&quot;fontSize&quot;:0.6,&quot;opacityScale&quot;:1,&quot;showTags&quot;:true,&quot;removeTags&quot;:[],&quot;focusOnHover&quot;:true,&quot;enableRadial&quot;:true}"></div></div></div><div class="toc desktop-only"><button type="button" class="toc-header" aria-controls="toc-12" aria-expanded="true"><h3>Table of Contents</h3><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="fold"><polyline points="6 9 12 15 18 9"></polyline></svg></button><ul id="list-1" class="toc-content overflow"><li class="depth-0"><a href="#attacco" data-for="attacco">Attacco</a></li><li class="depth-1"><a href="#cross-site-scripting-xss-panoramica-e-impatto" data-for="cross-site-scripting-xss-panoramica-e-impatto">Cross-Site Scripting (XSS): Panoramica e Impatto</a></li><li class="depth-2"><a href="#natura-delle-vulnerabilità-xss" data-for="natura-delle-vulnerabilità-xss">Natura delle Vulnerabilità XSS</a></li><li class="depth-2"><a href="#la-prevalenza-e-il-significato-dellxss" data-for="la-prevalenza-e-il-significato-dellxss">La Prevalenza e il Significato dell’XSS</a></li><li class="depth-2"><a href="#esempi-di-attacchi-xss" data-for="esempi-di-attacchi-xss">Esempi di Attacchi XSS</a></li><li class="depth-2"><a href="#sperimentare-con-lxss" data-for="sperimentare-con-lxss">Sperimentare con l’XSS</a></li><li class="depth-1"><a href="#le-località-più-comuni-per-le-vulnerabilità-xss" data-for="le-località-più-comuni-per-le-vulnerabilità-xss">Le Località Più Comuni per le Vulnerabilità XSS</a></li><li class="depth-2"><a href="#campi-di-ricerca" data-for="campi-di-ricerca">Campi di Ricerca</a></li><li class="depth-2"><a href="#campi-di-input" data-for="campi-di-input">Campi di Input</a></li><li class="depth-2"><a href="#messaggi-di-errore" data-for="messaggi-di-errore">Messaggi di Errore</a></li><li class="depth-2"><a href="#campi-nascosti" data-for="campi-nascosti">Campi Nascosti</a></li><li class="depth-2"><a href="#pagine-che-visualizzano-dati-forniti-dallutente" data-for="pagine-che-visualizzano-dati-forniti-dallutente">Pagine che Visualizzano Dati Forniti dall’Utente</a></li><li class="depth-2"><a href="#intestazioni-http" data-for="intestazioni-http">Intestazioni HTTP</a></li><li class="depth-1"><a href="#perché-dovremmo-preoccuparci-degli-attacchi-xss" data-for="perché-dovremmo-preoccuparci-degli-attacchi-xss">Perché Dovremmo Preoccuparci degli Attacchi XSS?</a></li><li class="depth-2"><a href="#furto-di-cookie-di-sessione" data-for="furto-di-cookie-di-sessione">Furto di Cookie di Sessione</a></li><li class="depth-2"><a href="#creazione-di-richieste-false" data-for="creazione-di-richieste-false">Creazione di Richieste False</a></li><li class="depth-2"><a href="#raccolta-di-credenziali-tramite-campi-falsi" data-for="raccolta-di-credenziali-tramite-campi-falsi">Raccolta di Credenziali tramite Campi Falsi</a></li><li class="depth-2"><a href="#reindirizzamento-a-siti-malevoli" data-for="reindirizzamento-a-siti-malevoli">Reindirizzamento a Siti Malevoli</a></li><li class="depth-2"><a href="#mascheramento-di-richieste-come-utente-valido" data-for="mascheramento-di-richieste-come-utente-valido">Mascheramento di Richieste Come Utente Valido</a></li><li class="depth-2"><a href="#furto-di-informazioni-riservate" data-for="furto-di-informazioni-riservate">Furto di Informazioni Riservate</a></li><li class="depth-2"><a href="#esecuzione-di-codice-dannoso" data-for="esecuzione-di-codice-dannoso">Esecuzione di Codice Dannoso</a></li><li class="depth-2"><a href="#inserimento-di-contenuti-ostili-o-inappropriati" data-for="inserimento-di-contenuti-ostili-o-inappropriati">Inserimento di Contenuti Ostili o Inappropriati</a></li><li class="depth-2"><a href="#legittimazione-degli-attacchi-di-phishing" data-for="legittimazione-degli-attacchi-di-phishing">Legittimazione degli Attacchi di Phishing</a></li><li class="depth-1"><a href="#tipi-di-attacchi-xss" data-for="tipi-di-attacchi-xss">Tipi di Attacchi XSS</a></li><li class="depth-2"><a href="#xss-riflesso" data-for="xss-riflesso">XSS Riflesso</a></li><li class="depth-2"><a href="#xss-basato-su-dom-tecnicamente-riflesso" data-for="xss-basato-su-dom-tecnicamente-riflesso">XSS basato su DOM (Tecnicamente Riflesso)</a></li><li class="depth-2"><a href="#xss-memorizzato-o-persistente" data-for="xss-memorizzato-o-persistente">XSS Memorizzato o Persistente</a></li><li class="depth-1"><a href="#scenario-di-attacco-xss-riflesso" data-for="scenario-di-attacco-xss-riflesso">Scenario di Attacco XSS Riflesso</a></li><li class="depth-2"><a href="#1-creazione-dellurl-malevolo" data-for="1-creazione-dellurl-malevolo">1. Creazione dell’URL Malevolo</a></li><li class="depth-2"><a href="#2-invio-dellurl-alla-vittima" data-for="2-invio-dellurl-alla-vittima">2. Invio dell’URL alla Vittima</a></li><li class="depth-2"><a href="#3-vittima-clicca-sul-link" data-for="3-vittima-clicca-sul-link">3. Vittima Clicca sul Link</a></li><li class="depth-2"><a href="#4-esecuzione-dello-script-malevolo" data-for="4-esecuzione-dello-script-malevolo">4. Esecuzione dello Script Malevolo</a></li><li class="depth-2"><a href="#5-la-vittima-rimane-ignara-dellattacco" data-for="5-la-vittima-rimane-ignara-dellattacco">5. La Vittima Rimane Ignara dell’Attacco</a></li><li class="depth-2"><a href="#scenario-carrello-della-spesa" data-for="scenario-carrello-della-spesa">Scenario: Carrello della Spesa</a></li><li class="depth-2"><a href="#obiettivo" data-for="obiettivo">Obiettivo</a></li><li class="depth-2"><a href="#procedimento" data-for="procedimento">Procedimento</a></li><li class="depth-2"><a href="#perché-è-considerato-self-xss" data-for="perché-è-considerato-self-xss">Perché è Considerato “Self XSS”?</a></li><li class="depth-2"><a href="#caratteristiche-del-self-xss" data-for="caratteristiche-del-self-xss">Caratteristiche del Self XSS</a></li><li class="depth-2"><a href="#rischi-associati-al-self-xss" data-for="rischi-associati-al-self-xss">Rischi Associati al Self XSS</a></li><li class="depth-2"><a href="#xss-riflesso-1" data-for="xss-riflesso-1">XSS Riflesso</a></li><li class="depth-2"><a href="#xss-basato-su-dom" data-for="xss-basato-su-dom">XSS basato su DOM</a></li><li class="depth-2"><a href="#scenario-di-attacco" data-for="scenario-di-attacco">Scenario di Attacco</a></li><li class="depth-2"><a href="#considerazioni-sulla-sicurezza" data-for="considerazioni-sulla-sicurezza">Considerazioni sulla Sicurezza</a></li><li class="depth-2"><a href="#passaggi-per-identificare-xss-basato-su-dom" data-for="passaggi-per-identificare-xss-basato-su-dom">Passaggi per Identificare XSS basato su DOM</a></li><li class="depth-2"><a href="#esempio-pratico" data-for="esempio-pratico">Esempio Pratico</a></li><li class="depth-2"><a href="#come-sfruttare-la-vulnerabilità" data-for="come-sfruttare-la-vulnerabilità">Come Sfruttare la Vulnerabilità</a></li><li class="depth-1"><a href="#stored-cross-site-scripting-xss-memorizzato" data-for="stored-cross-site-scripting-xss-memorizzato">Stored Cross-Site Scripting (XSS) Memorizzato</a></li><li class="depth-2"><a href="#scenario-di-attacco-xss-memorizzato" data-for="scenario-di-attacco-xss-memorizzato">Scenario di Attacco XSS Memorizzato</a></li><li class="depth-2"><a href="#impatto-degli-attacchi-xss-memorizzati" data-for="impatto-degli-attacchi-xss-memorizzati">Impatto degli Attacchi XSS Memorizzati</a></li><li class="depth-1"><a href="#conclusioni" data-for="conclusioni">Conclusioni</a></li><li class="depth-0"><a href="#mitigation-contro-xss-cross-site-scripting" data-for="mitigation-contro-xss-cross-site-scripting">Mitigation contro XSS (Cross-Site Scripting)</a></li><li class="depth-2"><a href="#perché-è-importante-difendersi-da-xss" data-for="perché-è-importante-difendersi-da-xss">Perché è importante difendersi da XSS</a></li><li class="depth-2"><a href="#cosa-codificare" data-for="cosa-codificare">Cosa codificare</a></li><li class="depth-2"><a href="#quando-e-dove-codificare" data-for="quando-e-dove-codificare">Quando e Dove Codificare</a></li><li class="depth-2"><a href="#come-codificare" data-for="come-codificare">Come Codificare</a></li><li class="depth-2"><a href="#risorse-consigliate" data-for="risorse-consigliate">Risorse consigliate</a></li><li class="depth-1"><a href="#codifica-e-escaping-dei-dati" data-for="codifica-e-escaping-dei-dati">Codifica e Escaping dei Dati</a></li><li class="depth-2"><a href="#cosa-significa-non-fidarsi-dellinput-utente" data-for="cosa-significa-non-fidarsi-dellinput-utente">Cosa Significa Non Fidarsi dell’Input Utente</a></li><li class="depth-2"><a href="#revisione-e-trattamento-dei-dati-forniti-dallutente" data-for="revisione-e-trattamento-dei-dati-forniti-dallutente">Revisione e Trattamento dei Dati Forniti dall’Utente</a></li><li class="depth-2"><a href="#escaping" data-for="escaping">Escaping</a></li><li class="depth-2"><a href="#caratteri-speciali" data-for="caratteri-speciali">Caratteri Speciali</a></li><li class="depth-2"><a href="#caratteri-speciali-rilevanti-in-xmlhtml" data-for="caratteri-speciali-rilevanti-in-xmlhtml">Caratteri Speciali Rilevanti in XML/HTML</a></li><li class="depth-1"><a href="#risorse-per-la-difesa-contro-xss" data-for="risorse-per-la-difesa-contro-xss">Risorse per la Difesa contro XSS</a></li><li class="depth-2"><a href="#owasp-java-encoder" data-for="owasp-java-encoder">OWASP Java Encoder</a></li><li class="depth-2"><a href="#general-xss-prevention-cheat-sheet" data-for="general-xss-prevention-cheat-sheet">General XSS Prevention Cheat Sheet</a></li><li class="depth-2"><a href="#dom-xss-prevention-cheat-sheet" data-for="dom-xss-prevention-cheat-sheet">DOM XSS Prevention Cheat Sheet</a></li><li class="depth-2"><a href="#xss-filter-evasion-cheat-sheet" data-for="xss-filter-evasion-cheat-sheet">XSS Filter Evasion Cheat Sheet</a></li><li class="depth-2"><a href="#specifici-dei-framework-javascript" data-for="specifici-dei-framework-javascript">Specifici dei Framework JavaScript</a></li><li class="depth-2"><a href="#modifiche-spiegate" data-for="modifiche-spiegate">Modifiche Spiegate:</a></li><li class="overflow-end"></li></ul></div></div><footer class><p>Created with <a href="https://quartz.jzhao.xyz/">Quartz v4.5.1</a> © 2025</p><ul><li><a href="https://github.com/jackyzha0/quartz">GitHub</a></li><li><a href="https://discord.gg/cRFFHYye7t">Discord Community</a></li></ul></footer></div></div></body><script type="application/javascript">function n(){let t=this.parentElement;t.classList.toggle("is-collapsed");let e=t.getElementsByClassName("callout-content")[0];if(!e)return;let l=t.classList.contains("is-collapsed");e.style.gridTemplateRows=l?"0fr":"1fr"}function c(){let t=document.getElementsByClassName("callout is-collapsible");for(let e of t){let l=e.getElementsByClassName("callout-title")[0],s=e.getElementsByClassName("callout-content")[0];if(!l||!s)continue;l.addEventListener("click",n),window.addCleanup(()=>l.removeEventListener("click",n));let o=e.classList.contains("is-collapsed");s.style.gridTemplateRows=o?"0fr":"1fr"}}document.addEventListener("nav",c);
</script><script type="module">function f(i,e){if(!i)return;function r(o){o.target===this&&(o.preventDefault(),o.stopPropagation(),e())}function t(o){o.key.startsWith("Esc")&&(o.preventDefault(),e())}i?.addEventListener("click",r),window.addCleanup(()=>i?.removeEventListener("click",r)),document.addEventListener("keydown",t),window.addCleanup(()=>document.removeEventListener("keydown",t))}function y(i){for(;i.firstChild;)i.removeChild(i.firstChild)}var h=class{constructor(e,r){this.container=e;this.content=r;this.setupEventListeners(),this.setupNavigationControls(),this.resetTransform()}isDragging=!1;startPan={x:0,y:0};currentPan={x:0,y:0};scale=1;MIN_SCALE=.5;MAX_SCALE=3;cleanups=[];setupEventListeners(){let e=this.onMouseDown.bind(this),r=this.onMouseMove.bind(this),t=this.onMouseUp.bind(this),o=this.resetTransform.bind(this);this.container.addEventListener("mousedown",e),document.addEventListener("mousemove",r),document.addEventListener("mouseup",t),window.addEventListener("resize",o),this.cleanups.push(()=>this.container.removeEventListener("mousedown",e),()=>document.removeEventListener("mousemove",r),()=>document.removeEventListener("mouseup",t),()=>window.removeEventListener("resize",o))}cleanup(){for(let e of this.cleanups)e()}setupNavigationControls(){let e=document.createElement("div");e.className="mermaid-controls";let r=this.createButton("+",()=>this.zoom(.1)),t=this.createButton("-",()=>this.zoom(-.1)),o=this.createButton("Reset",()=>this.resetTransform());e.appendChild(t),e.appendChild(o),e.appendChild(r),this.container.appendChild(e)}createButton(e,r){let t=document.createElement("button");return t.textContent=e,t.className="mermaid-control-button",t.addEventListener("click",r),window.addCleanup(()=>t.removeEventListener("click",r)),t}onMouseDown(e){e.button===0&&(this.isDragging=!0,this.startPan={x:e.clientX-this.currentPan.x,y:e.clientY-this.currentPan.y},this.container.style.cursor="grabbing")}onMouseMove(e){this.isDragging&&(e.preventDefault(),this.currentPan={x:e.clientX-this.startPan.x,y:e.clientY-this.startPan.y},this.updateTransform())}onMouseUp(){this.isDragging=!1,this.container.style.cursor="grab"}zoom(e){let r=Math.min(Math.max(this.scale+e,this.MIN_SCALE),this.MAX_SCALE),t=this.content.getBoundingClientRect(),o=t.width/2,n=t.height/2,c=r-this.scale;this.currentPan.x-=o*c,this.currentPan.y-=n*c,this.scale=r,this.updateTransform()}updateTransform(){this.content.style.transform=`translate(${this.currentPan.x}px, ${this.currentPan.y}px) scale(${this.scale})`}resetTransform(){this.scale=1;let e=this.content.querySelector("svg");this.currentPan={x:e.getBoundingClientRect().width/2,y:e.getBoundingClientRect().height/2},this.updateTransform()}},C=["--secondary","--tertiary","--gray","--light","--lightgray","--highlight","--dark","--darkgray","--codeFont"],E;document.addEventListener("nav",async()=>{let e=document.querySelector(".center").querySelectorAll("code.mermaid");if(e.length===0)return;E||=await import("https://cdnjs.cloudflare.com/ajax/libs/mermaid/11.4.0/mermaid.esm.min.mjs");let r=E.default,t=new WeakMap;for(let n of e)t.set(n,n.innerText);async function o(){for(let s of e){s.removeAttribute("data-processed");let a=t.get(s);a&&(s.innerHTML=a)}let n=C.reduce((s,a)=>(s[a]=window.getComputedStyle(document.documentElement).getPropertyValue(a),s),{}),c=document.documentElement.getAttribute("saved-theme")==="dark";r.initialize({startOnLoad:!1,securityLevel:"loose",theme:c?"dark":"base",themeVariables:{fontFamily:n["--codeFont"],primaryColor:n["--light"],primaryTextColor:n["--darkgray"],primaryBorderColor:n["--tertiary"],lineColor:n["--darkgray"],secondaryColor:n["--secondary"],tertiaryColor:n["--tertiary"],clusterBkg:n["--light"],edgeLabelBackground:n["--highlight"]}}),await r.run({nodes:e})}await o(),document.addEventListener("themechange",o),window.addCleanup(()=>document.removeEventListener("themechange",o));for(let n=0;n<e.length;n++){let v=function(){let g=l.querySelector("#mermaid-space"),m=l.querySelector(".mermaid-content");if(!m)return;y(m);let w=c.querySelector("svg").cloneNode(!0);m.appendChild(w),l.classList.add("active"),g.style.cursor="grab",u=new h(g,m)},M=function(){l.classList.remove("active"),u?.cleanup(),u=null},c=e[n],s=c.parentElement,a=s.querySelector(".clipboard-button"),d=s.querySelector(".expand-button"),p=window.getComputedStyle(a),L=a.offsetWidth+parseFloat(p.marginLeft||"0")+parseFloat(p.marginRight||"0");d.style.right=`calc(${L}px + 0.3rem)`,s.prepend(d);let l=s.querySelector("#mermaid-container");if(!l)return;let u=null;d.addEventListener("click",v),f(l,M),window.addCleanup(()=>{u?.cleanup(),d.removeEventListener("click",v)})}});
</script><script src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/copy-tex.min.js" type="application/javascript"></script><script type="application/javascript">
        const socket = new WebSocket('ws://localhost:3001')
        // reload(true) ensures resources like images and scripts are fetched again in firefox
        socket.addEventListener('message', () => document.location.reload(true))
      </script><script src="../../postscript.js" type="module"></script></html>