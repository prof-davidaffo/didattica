<!DOCTYPE html>
<html lang="en"><head><title>SQL Injection</title><meta charset="utf-8"/><link rel="preconnect" href="https://fonts.googleapis.com"/><link rel="preconnect" href="https://fonts.gstatic.com"/><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Schibsted Grotesk:wght@400;700&amp;family=Source Sans Pro:ital,wght@0,400;0,600;1,400;1,600&amp;family=IBM Plex Mono:wght@400;600&amp;display=swap"/><link rel="preconnect" href="https://cdnjs.cloudflare.com" crossorigin="anonymous"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta name="og:site_name" content="Quartz 4"/><meta property="og:title" content="SQL Injection"/><meta property="og:type" content="website"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:title" content="SQL Injection"/><meta name="twitter:description" content="Introduzione al SQL (Structured Query Language) SQL è un linguaggio di programmazione progettato per gestire e manipolare i database relazionali."/><meta property="og:description" content="Introduzione al SQL (Structured Query Language) SQL è un linguaggio di programmazione progettato per gestire e manipolare i database relazionali."/><meta property="og:image:alt" content="Introduzione al SQL (Structured Query Language) SQL è un linguaggio di programmazione progettato per gestire e manipolare i database relazionali."/><meta property="twitter:domain" content="/didattica/"/><meta property="og:url" content="https://didattica/Argomenti/Cybersecurity-e-Ethical-hacking/SQL-Injection"/><meta property="twitter:url" content="https://didattica/Argomenti/Cybersecurity-e-Ethical-hacking/SQL-Injection"/><link rel="icon" href="../../static/icon.png"/><meta name="description" content="Introduzione al SQL (Structured Query Language) SQL è un linguaggio di programmazione progettato per gestire e manipolare i database relazionali."/><meta name="generator" content="Quartz"/><link href="../../index.css" rel="stylesheet" type="text/css" spa-preserve/><style>.expand-button {
  position: absolute;
  display: flex;
  float: right;
  padding: 0.4rem;
  margin: 0.3rem;
  right: 0;
  color: var(--gray);
  border-color: var(--dark);
  background-color: var(--light);
  border: 1px solid;
  border-radius: 5px;
  opacity: 0;
  transition: 0.2s;
}
.expand-button > svg {
  fill: var(--light);
  filter: contrast(0.3);
}
.expand-button:hover {
  cursor: pointer;
  border-color: var(--secondary);
}
.expand-button:focus {
  outline: 0;
}

pre:hover > .expand-button {
  opacity: 1;
  transition: 0.2s;
}

#mermaid-container {
  position: fixed;
  contain: layout;
  z-index: 999;
  left: 0;
  top: 0;
  width: 100vw;
  height: 100vh;
  overflow: hidden;
  display: none;
  backdrop-filter: blur(4px);
  background: rgba(0, 0, 0, 0.5);
}
#mermaid-container.active {
  display: inline-block;
}
#mermaid-container > #mermaid-space {
  border: 1px solid var(--lightgray);
  background-color: var(--light);
  border-radius: 5px;
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  height: 80vh;
  width: 80vw;
  overflow: hidden;
}
#mermaid-container > #mermaid-space > .mermaid-content {
  padding: 2rem;
  position: relative;
  transform-origin: 0 0;
  transition: transform 0.1s ease;
  overflow: visible;
  min-height: 200px;
  min-width: 200px;
}
#mermaid-container > #mermaid-space > .mermaid-content pre {
  margin: 0;
  border: none;
}
#mermaid-container > #mermaid-space > .mermaid-content svg {
  max-width: none;
  height: auto;
}
#mermaid-container > #mermaid-space > .mermaid-controls {
  position: absolute;
  bottom: 20px;
  right: 20px;
  display: flex;
  gap: 8px;
  padding: 8px;
  background: var(--light);
  border: 1px solid var(--lightgray);
  border-radius: 6px;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
  z-index: 2;
}
#mermaid-container > #mermaid-space > .mermaid-controls .mermaid-control-button {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 32px;
  height: 32px;
  padding: 0;
  border: 1px solid var(--lightgray);
  background: var(--light);
  color: var(--dark);
  border-radius: 4px;
  cursor: pointer;
  font-size: 16px;
  font-family: var(--bodyFont);
  transition: all 0.2s ease;
}
#mermaid-container > #mermaid-space > .mermaid-controls .mermaid-control-button:hover {
  background: var(--lightgray);
}
#mermaid-container > #mermaid-space > .mermaid-controls .mermaid-control-button:active {
  transform: translateY(1px);
}
#mermaid-container > #mermaid-space > .mermaid-controls .mermaid-control-button:nth-child(2) {
  width: auto;
  padding: 0 12px;
  font-size: 14px;
}
/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VSb290IjoiL2hvbWUvZGF2aWRhZmZvL3BsYXlncm91bmQvcXVhcnR6L3F1YXJ0ei9jb21wb25lbnRzL3N0eWxlcyIsInNvdXJjZXMiOlsibWVybWFpZC5pbmxpbmUuc2NzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUNFO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBOztBQUVBO0VBQ0U7RUFDQTs7QUFHRjtFQUNFO0VBQ0E7O0FBR0Y7RUFDRTs7O0FBS0Y7RUFDRTtFQUNBOzs7QUFJSjtFQUNFO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7O0FBRUE7RUFDRTs7QUFHRjtFQUNFO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBOztBQUVBO0VBQ0U7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7O0FBRUE7RUFDRTtFQUNBOztBQUdGO0VBQ0U7RUFDQTs7QUFJSjtFQUNFO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7O0FBRUE7RUFDRTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBOztBQUVBO0VBQ0U7O0FBR0Y7RUFDRTs7QUFJRjtFQUNFO0VBQ0E7RUFDQSIsInNvdXJjZXNDb250ZW50IjpbIi5leHBhbmQtYnV0dG9uIHtcbiAgcG9zaXRpb246IGFic29sdXRlO1xuICBkaXNwbGF5OiBmbGV4O1xuICBmbG9hdDogcmlnaHQ7XG4gIHBhZGRpbmc6IDAuNHJlbTtcbiAgbWFyZ2luOiAwLjNyZW07XG4gIHJpZ2h0OiAwOyAvLyBOT1RFOiByaWdodCB3aWxsIGJlIHNldCBpbiBtZXJtYWlkLmlubGluZS50c1xuICBjb2xvcjogdmFyKC0tZ3JheSk7XG4gIGJvcmRlci1jb2xvcjogdmFyKC0tZGFyayk7XG4gIGJhY2tncm91bmQtY29sb3I6IHZhcigtLWxpZ2h0KTtcbiAgYm9yZGVyOiAxcHggc29saWQ7XG4gIGJvcmRlci1yYWRpdXM6IDVweDtcbiAgb3BhY2l0eTogMDtcbiAgdHJhbnNpdGlvbjogMC4ycztcblxuICAmID4gc3ZnIHtcbiAgICBmaWxsOiB2YXIoLS1saWdodCk7XG4gICAgZmlsdGVyOiBjb250cmFzdCgwLjMpO1xuICB9XG5cbiAgJjpob3ZlciB7XG4gICAgY3Vyc29yOiBwb2ludGVyO1xuICAgIGJvcmRlci1jb2xvcjogdmFyKC0tc2Vjb25kYXJ5KTtcbiAgfVxuXG4gICY6Zm9jdXMge1xuICAgIG91dGxpbmU6IDA7XG4gIH1cbn1cblxucHJlIHtcbiAgJjpob3ZlciA+IC5leHBhbmQtYnV0dG9uIHtcbiAgICBvcGFjaXR5OiAxO1xuICAgIHRyYW5zaXRpb246IDAuMnM7XG4gIH1cbn1cblxuI21lcm1haWQtY29udGFpbmVyIHtcbiAgcG9zaXRpb246IGZpeGVkO1xuICBjb250YWluOiBsYXlvdXQ7XG4gIHotaW5kZXg6IDk5OTtcbiAgbGVmdDogMDtcbiAgdG9wOiAwO1xuICB3aWR0aDogMTAwdnc7XG4gIGhlaWdodDogMTAwdmg7XG4gIG92ZXJmbG93OiBoaWRkZW47XG4gIGRpc3BsYXk6IG5vbmU7XG4gIGJhY2tkcm9wLWZpbHRlcjogYmx1cig0cHgpO1xuICBiYWNrZ3JvdW5kOiByZ2JhKDAsIDAsIDAsIDAuNSk7XG5cbiAgJi5hY3RpdmUge1xuICAgIGRpc3BsYXk6IGlubGluZS1ibG9jaztcbiAgfVxuXG4gICYgPiAjbWVybWFpZC1zcGFjZSB7XG4gICAgYm9yZGVyOiAxcHggc29saWQgdmFyKC0tbGlnaHRncmF5KTtcbiAgICBiYWNrZ3JvdW5kLWNvbG9yOiB2YXIoLS1saWdodCk7XG4gICAgYm9yZGVyLXJhZGl1czogNXB4O1xuICAgIHBvc2l0aW9uOiBmaXhlZDtcbiAgICB0b3A6IDUwJTtcbiAgICBsZWZ0OiA1MCU7XG4gICAgdHJhbnNmb3JtOiB0cmFuc2xhdGUoLTUwJSwgLTUwJSk7XG4gICAgaGVpZ2h0OiA4MHZoO1xuICAgIHdpZHRoOiA4MHZ3O1xuICAgIG92ZXJmbG93OiBoaWRkZW47XG5cbiAgICAmID4gLm1lcm1haWQtY29udGVudCB7XG4gICAgICBwYWRkaW5nOiAycmVtO1xuICAgICAgcG9zaXRpb246IHJlbGF0aXZlO1xuICAgICAgdHJhbnNmb3JtLW9yaWdpbjogMCAwO1xuICAgICAgdHJhbnNpdGlvbjogdHJhbnNmb3JtIDAuMXMgZWFzZTtcbiAgICAgIG92ZXJmbG93OiB2aXNpYmxlO1xuICAgICAgbWluLWhlaWdodDogMjAwcHg7XG4gICAgICBtaW4td2lkdGg6IDIwMHB4O1xuXG4gICAgICBwcmUge1xuICAgICAgICBtYXJnaW46IDA7XG4gICAgICAgIGJvcmRlcjogbm9uZTtcbiAgICAgIH1cblxuICAgICAgc3ZnIHtcbiAgICAgICAgbWF4LXdpZHRoOiBub25lO1xuICAgICAgICBoZWlnaHQ6IGF1dG87XG4gICAgICB9XG4gICAgfVxuXG4gICAgJiA+IC5tZXJtYWlkLWNvbnRyb2xzIHtcbiAgICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTtcbiAgICAgIGJvdHRvbTogMjBweDtcbiAgICAgIHJpZ2h0OiAyMHB4O1xuICAgICAgZGlzcGxheTogZmxleDtcbiAgICAgIGdhcDogOHB4O1xuICAgICAgcGFkZGluZzogOHB4O1xuICAgICAgYmFja2dyb3VuZDogdmFyKC0tbGlnaHQpO1xuICAgICAgYm9yZGVyOiAxcHggc29saWQgdmFyKC0tbGlnaHRncmF5KTtcbiAgICAgIGJvcmRlci1yYWRpdXM6IDZweDtcbiAgICAgIGJveC1zaGFkb3c6IDAgMnB4IDRweCByZ2JhKDAsIDAsIDAsIDAuMSk7XG4gICAgICB6LWluZGV4OiAyO1xuXG4gICAgICAubWVybWFpZC1jb250cm9sLWJ1dHRvbiB7XG4gICAgICAgIGRpc3BsYXk6IGZsZXg7XG4gICAgICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7XG4gICAgICAgIGp1c3RpZnktY29udGVudDogY2VudGVyO1xuICAgICAgICB3aWR0aDogMzJweDtcbiAgICAgICAgaGVpZ2h0OiAzMnB4O1xuICAgICAgICBwYWRkaW5nOiAwO1xuICAgICAgICBib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1saWdodGdyYXkpO1xuICAgICAgICBiYWNrZ3JvdW5kOiB2YXIoLS1saWdodCk7XG4gICAgICAgIGNvbG9yOiB2YXIoLS1kYXJrKTtcbiAgICAgICAgYm9yZGVyLXJhZGl1czogNHB4O1xuICAgICAgICBjdXJzb3I6IHBvaW50ZXI7XG4gICAgICAgIGZvbnQtc2l6ZTogMTZweDtcbiAgICAgICAgZm9udC1mYW1pbHk6IHZhcigtLWJvZHlGb250KTtcbiAgICAgICAgdHJhbnNpdGlvbjogYWxsIDAuMnMgZWFzZTtcblxuICAgICAgICAmOmhvdmVyIHtcbiAgICAgICAgICBiYWNrZ3JvdW5kOiB2YXIoLS1saWdodGdyYXkpO1xuICAgICAgICB9XG5cbiAgICAgICAgJjphY3RpdmUge1xuICAgICAgICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlWSgxcHgpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gU3R5bGUgdGhlIHJlc2V0IGJ1dHRvbiBkaWZmZXJlbnRseVxuICAgICAgICAmOm50aC1jaGlsZCgyKSB7XG4gICAgICAgICAgd2lkdGg6IGF1dG87XG4gICAgICAgICAgcGFkZGluZzogMCAxMnB4O1xuICAgICAgICAgIGZvbnQtc2l6ZTogMTRweDtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfVxufVxuIl19 */</style><link href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" rel="stylesheet" type="text/css" spa-preserve/><script src="../../prescript.js" type="application/javascript" spa-preserve></script><script type="application/javascript" spa-preserve>const fetchData = fetch("../../static/contentIndex.json").then(data => data.json())</script><link rel="alternate" type="application/rss+xml" title="RSS Feed" href="https:///didattica//index.xml"/><meta property="og:image:width" content="1200"/><meta property="og:image:height" content="630"/><meta property="og:image" content="https:///didattica//Argomenti/Cybersecurity-e-Ethical-hacking/SQL-Injection-og-image.webp"/><meta property="og:image:url" content="https:///didattica//Argomenti/Cybersecurity-e-Ethical-hacking/SQL-Injection-og-image.webp"/><meta name="twitter:image" content="https:///didattica//Argomenti/Cybersecurity-e-Ethical-hacking/SQL-Injection-og-image.webp"/><meta property="og:image:type" content="image/.webp"/></head><body data-slug="Argomenti/Cybersecurity-e-Ethical-hacking/SQL-Injection"><div id="quartz-root" class="page"><div id="quartz-body"><div class="left sidebar"><h2 class="page-title"><a href="../..">Quartz 4</a></h2><div class="spacer mobile-only"></div><div class="flex-component" style="flex-direction: row; flex-wrap: nowrap; gap: 1rem;"><div style="flex-grow: 1; flex-shrink: 1; flex-basis: auto; order: 0; align-self: center; justify-self: center;"><div class="search"><button class="search-button"><p>Search</p><svg role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 19.9 19.7"><title>Search</title><g class="search-path" fill="none"><path stroke-linecap="square" d="M18.5 18.3l-5.4-5.4"></path><circle cx="8" cy="8" r="7"></circle></g></svg></button><div class="search-container"><div class="search-space"><input autocomplete="off" class="search-bar" name="search" type="text" aria-label="Search for something" placeholder="Search for something"/><div class="search-layout" data-preview="true"></div></div></div></div></div><div style="flex-grow: 0; flex-shrink: 1; flex-basis: auto; order: 0; align-self: center; justify-self: center;"><button class="darkmode"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" class="dayIcon" x="0px" y="0px" viewBox="0 0 35 35" style="enable-background:new 0 0 35 35" xml:space="preserve" aria-label="Dark mode"><title>Dark mode</title><path d="M6,17.5C6,16.672,5.328,16,4.5,16h-3C0.672,16,0,16.672,0,17.5    S0.672,19,1.5,19h3C5.328,19,6,18.328,6,17.5z M7.5,26c-0.414,0-0.789,0.168-1.061,0.439l-2,2C4.168,28.711,4,29.086,4,29.5    C4,30.328,4.671,31,5.5,31c0.414,0,0.789-0.168,1.06-0.44l2-2C8.832,28.289,9,27.914,9,27.5C9,26.672,8.329,26,7.5,26z M17.5,6    C18.329,6,19,5.328,19,4.5v-3C19,0.672,18.329,0,17.5,0S16,0.672,16,1.5v3C16,5.328,16.671,6,17.5,6z M27.5,9    c0.414,0,0.789-0.168,1.06-0.439l2-2C30.832,6.289,31,5.914,31,5.5C31,4.672,30.329,4,29.5,4c-0.414,0-0.789,0.168-1.061,0.44    l-2,2C26.168,6.711,26,7.086,26,7.5C26,8.328,26.671,9,27.5,9z M6.439,8.561C6.711,8.832,7.086,9,7.5,9C8.328,9,9,8.328,9,7.5    c0-0.414-0.168-0.789-0.439-1.061l-2-2C6.289,4.168,5.914,4,5.5,4C4.672,4,4,4.672,4,5.5c0,0.414,0.168,0.789,0.439,1.06    L6.439,8.561z M33.5,16h-3c-0.828,0-1.5,0.672-1.5,1.5s0.672,1.5,1.5,1.5h3c0.828,0,1.5-0.672,1.5-1.5S34.328,16,33.5,16z     M28.561,26.439C28.289,26.168,27.914,26,27.5,26c-0.828,0-1.5,0.672-1.5,1.5c0,0.414,0.168,0.789,0.439,1.06l2,2    C28.711,30.832,29.086,31,29.5,31c0.828,0,1.5-0.672,1.5-1.5c0-0.414-0.168-0.789-0.439-1.061L28.561,26.439z M17.5,29    c-0.829,0-1.5,0.672-1.5,1.5v3c0,0.828,0.671,1.5,1.5,1.5s1.5-0.672,1.5-1.5v-3C19,29.672,18.329,29,17.5,29z M17.5,7    C11.71,7,7,11.71,7,17.5S11.71,28,17.5,28S28,23.29,28,17.5S23.29,7,17.5,7z M17.5,25c-4.136,0-7.5-3.364-7.5-7.5    c0-4.136,3.364-7.5,7.5-7.5c4.136,0,7.5,3.364,7.5,7.5C25,21.636,21.636,25,17.5,25z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" class="nightIcon" x="0px" y="0px" viewBox="0 0 100 100" style="enable-background:new 0 0 100 100" xml:space="preserve" aria-label="Light mode"><title>Light mode</title><path d="M96.76,66.458c-0.853-0.852-2.15-1.064-3.23-0.534c-6.063,2.991-12.858,4.571-19.655,4.571  C62.022,70.495,50.88,65.88,42.5,57.5C29.043,44.043,25.658,23.536,34.076,6.47c0.532-1.08,0.318-2.379-0.534-3.23  c-0.851-0.852-2.15-1.064-3.23-0.534c-4.918,2.427-9.375,5.619-13.246,9.491c-9.447,9.447-14.65,22.008-14.65,35.369  c0,13.36,5.203,25.921,14.65,35.368s22.008,14.65,35.368,14.65c13.361,0,25.921-5.203,35.369-14.65  c3.872-3.871,7.064-8.328,9.491-13.246C97.826,68.608,97.611,67.309,96.76,66.458z"></path></svg></button></div><div style="flex-grow: 0; flex-shrink: 1; flex-basis: auto; order: 0; align-self: center; justify-self: center;"><button class="readermode"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" class="readerIcon" fill="currentColor" stroke="currentColor" stroke-width="0.2" stroke-linecap="round" stroke-linejoin="round" width="64px" height="64px" viewBox="0 0 24 24" aria-label="Reader mode"><title>Reader mode</title><g transform="translate(-1.8, -1.8) scale(1.15, 1.2)"><path d="M8.9891247,2.5 C10.1384702,2.5 11.2209868,2.96705384 12.0049645,3.76669482 C12.7883914,2.96705384 13.8709081,2.5 15.0202536,2.5 L18.7549359,2.5 C19.1691495,2.5 19.5049359,2.83578644 19.5049359,3.25 L19.5046891,4.004 L21.2546891,4.00457396 C21.6343849,4.00457396 21.9481801,4.28672784 21.9978425,4.6528034 L22.0046891,4.75457396 L22.0046891,20.25 C22.0046891,20.6296958 21.7225353,20.943491 21.3564597,20.9931534 L21.2546891,21 L2.75468914,21 C2.37499337,21 2.06119817,20.7178461 2.01153575,20.3517706 L2.00468914,20.25 L2.00468914,4.75457396 C2.00468914,4.37487819 2.28684302,4.061083 2.65291858,4.01142057 L2.75468914,4.00457396 L4.50368914,4.004 L4.50444233,3.25 C4.50444233,2.87030423 4.78659621,2.55650904 5.15267177,2.50684662 L5.25444233,2.5 L8.9891247,2.5 Z M4.50368914,5.504 L3.50468914,5.504 L3.50468914,19.5 L10.9478955,19.4998273 C10.4513189,18.9207296 9.73864328,18.5588115 8.96709342,18.5065584 L8.77307039,18.5 L5.25444233,18.5 C4.87474657,18.5 4.56095137,18.2178461 4.51128895,17.8517706 L4.50444233,17.75 L4.50368914,5.504 Z M19.5049359,17.75 C19.5049359,18.1642136 19.1691495,18.5 18.7549359,18.5 L15.2363079,18.5 C14.3910149,18.5 13.5994408,18.8724714 13.0614828,19.4998273 L20.5046891,19.5 L20.5046891,5.504 L19.5046891,5.504 L19.5049359,17.75 Z M18.0059359,3.999 L15.0202536,4 L14.8259077,4.00692283 C13.9889509,4.06666544 13.2254227,4.50975805 12.7549359,5.212 L12.7549359,17.777 L12.7782651,17.7601316 C13.4923805,17.2719483 14.3447024,17 15.2363079,17 L18.0059359,16.999 L18.0056891,4.798 L18.0033792,4.75457396 L18.0056891,4.71 L18.0059359,3.999 Z M8.9891247,4 L6.00368914,3.999 L6.00599909,4.75457396 L6.00599909,4.75457396 L6.00368914,4.783 L6.00368914,16.999 L8.77307039,17 C9.57551536,17 10.3461406,17.2202781 11.0128313,17.6202194 L11.2536891,17.776 L11.2536891,5.211 C10.8200889,4.56369974 10.1361548,4.13636104 9.37521067,4.02745763 L9.18347055,4.00692283 L8.9891247,4 Z"></path></g></svg></button></div></div><div class="explorer" data-behavior="link" data-collapsed="collapsed" data-savestate="true" data-data-fns="{&quot;order&quot;:[&quot;filter&quot;,&quot;map&quot;,&quot;sort&quot;],&quot;sortFn&quot;:&quot;(a,b)=>!a.isFolder&amp;&amp;!b.isFolder||a.isFolder&amp;&amp;b.isFolder?a.displayName.localeCompare(b.displayName,void 0,{numeric:!0,sensitivity:\&quot;base\&quot;}):!a.isFolder&amp;&amp;b.isFolder?1:-1&quot;,&quot;filterFn&quot;:&quot;node=>node.slugSegment!==\&quot;tags\&quot;&quot;,&quot;mapFn&quot;:&quot;node=>node&quot;}"><button type="button" class="explorer-toggle mobile-explorer hide-until-loaded" data-mobile="true" aria-controls="explorer-47"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide-menu"><line x1="4" x2="20" y1="12" y2="12"></line><line x1="4" x2="20" y1="6" y2="6"></line><line x1="4" x2="20" y1="18" y2="18"></line></svg></button><button type="button" class="title-button explorer-toggle desktop-explorer" data-mobile="false" aria-expanded="true"><h2>Explorer</h2><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="5 8 14 8" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="fold"><polyline points="6 9 12 15 18 9"></polyline></svg></button><div id="explorer-47" class="explorer-content" aria-expanded="false" role="group"><ul class="explorer-ul overflow" id="list-0"><li class="overflow-end"></li></ul></div><template id="template-file"><li><a href="#"></a></li></template><template id="template-folder"><li><div class="folder-container"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="5 8 14 8" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="folder-icon"><polyline points="6 9 12 15 18 9"></polyline></svg><div><button class="folder-button"><span class="folder-title"></span></button></div></div><div class="folder-outer"><ul class="content"></ul></div></li></template></div></div><div class="center"><div class="page-header"><div class="popover-hint"><nav class="breadcrumb-container" aria-label="breadcrumbs"><div class="breadcrumb-element"><a href="../../">Home</a><p> ❯ </p></div><div class="breadcrumb-element"><a href="../../Argomenti/">Argomenti</a><p> ❯ </p></div><div class="breadcrumb-element"><a href="../../Argomenti/Cybersecurity-e-Ethical-hacking/">Cybersecurity e Ethical hacking</a><p> ❯ </p></div><div class="breadcrumb-element"><a href>SQL Injection</a></div></nav><h1 class="article-title">SQL Injection</h1><p show-comma="true" class="content-meta"><time datetime="2024-03-18T10:04:13.461Z">Mar 18, 2024</time><span>46 min read</span></p></div></div><article class="popover-hint"><h2 id="introduzione-al-sql-structured-query-language">Introduzione al SQL (Structured Query Language)<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#introduzione-al-sql-structured-query-language" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<p><strong>SQL</strong> è un linguaggio di programmazione progettato per gestire e manipolare i database relazionali. Viene utilizzato per eseguire varie operazioni sui dati, come l’inserimento, l’aggiornamento, la cancellazione e la ricerca di record nei database. SQL gioca un ruolo cruciale nell’interazione con i database, permettendo agli sviluppatori e agli analisti di dati di estrarre facilmente informazioni significative.</p>
<h3 id="concetti-fondamentali-di-sql">Concetti Fondamentali di SQL<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#concetti-fondamentali-di-sql" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<ul>
<li><strong>DML (Data Manipulation Language):</strong> Include comandi come <code>SELECT</code>, <code>INSERT</code>, <code>UPDATE</code>, e <code>DELETE</code>, usati per manipolare i dati presenti nelle tabelle.</li>
<li><strong>DDL (Data Definition Language):</strong> Comprende istruzioni come <code>CREATE</code>, <code>ALTER</code>, <code>DROP</code>, che sono utilizzate per definire e modificare la struttura del database, come la creazione di tabelle.</li>
<li><strong>DCL (Data Control Language):</strong> Include comandi come <code>GRANT</code> e <code>REVOKE</code>, impiegati per definire i diritti e gli accessi degli utenti.</li>
</ul>
<h2 id="comprensione-dellsql-injection">Comprensione dell’SQL injection<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#comprensione-dellsql-injection" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<p>L’SQL injection è una tecnica di attacco informatico che sfrutta le vulnerabilità nel codice di un’applicazione per manipolare le query SQL. Questo permette agli aggressori di eseguire operazioni non autorizzate sul database, come accedere a dati sensibili, modificarli o eliminarli.</p>
<h3 id="tipi-di-sql-injection">Tipi di SQL injection<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#tipi-di-sql-injection" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<ul>
<li><strong>SQL injection basata su Stringhe:</strong> Si verifica quando l’attaccante inserisce una sequenza di caratteri che termina la stringa SQL originale e aggiunge una nuova query o condizione.</li>
<li><strong>SQL injection Numerica:</strong> Avviene quando l’input atteso è un numero, e l’attaccante inserisce una query SQL o condizioni logiche che alterano la query originale.</li>
</ul>
<h3 id="sql-injection-e-la-triade-cia">SQL injection e la Triade CIA<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#sql-injection-e-la-triade-cia" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>La triade CIA (Confidenzialità, Integrità, Disponibilità) rappresenta i principi fondamentali della sicurezza informatica. L’SQL injection impatta negativamente su tutti e tre gli aspetti:</p>
<ul>
<li><strong>Confidenzialità:</strong> L’SQL injection può essere utilizzata per accedere a dati riservati senza autorizzazione, violando la confidenzialità.</li>
<li><strong>Integrità:</strong> Gli attacchi possono alterare o cancellare dati, compromettendo l’integrità delle informazioni memorizzate nel database.</li>
<li><strong>Disponibilità:</strong> Un attacco SQL Injection può anche portare al sovraccarico del sistema o alla corruzione dei dati, influenzando la disponibilità dei servizi</li>
</ul>
<h1 id="struttura-di-base-e-select">Struttura di base e select<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#struttura-di-base-e-select" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h1>
<p>Questa lezione introduce le basi di SQL (Structured Query Language), il linguaggio standardizzato usato per gestire database relazionali e per eseguire varie operazioni sui dati contenuti. SQL consente di organizzare i dati in righe, colonne e tabelle, e di indicizzarli per rendere più efficiente la ricerca di informazioni pertinenti.</p>
<h3 id="esempio-di-tavola-sql">Esempio di Tavola SQL<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#esempio-di-tavola-sql" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>L’esempio fornito mostra una tabella chiamata <code>employees</code> che contiene dati sugli impiegati di un’azienda. Ogni riga rappresenta un dipendente e include informazioni come numero di identificazione unico (<code>userid</code>), nome, cognome, dipartimento, salario e un numero di autenticazione della transazione (<code>auth_tan</code>).</p>
<h3 id="categorie-principali-di-comandi-sql">Categorie Principali di Comandi SQL<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#categorie-principali-di-comandi-sql" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<ol>
<li><strong>Data Manipulation Language (DML):</strong> Questi comandi sono utilizzati per manipolare i dati all’interno delle tabelle del database. Esempi includono <code>SELECT</code>, <code>INSERT</code>, <code>UPDATE</code>, e <code>DELETE</code>.</li>
<li><strong>Data Definition Language (DDL):</strong> Questi comandi sono usati per definire, modificare o eliminare strutture di dati, come le tabelle. Esempi includono <code>CREATE</code>, <code>ALTER</code>, e <code>DROP</code>.</li>
<li><strong>Data Control Language (DCL):</strong> Questi comandi gestiscono le autorizzazioni e l’accesso ai dati, includendo comandi come <code>GRANT</code> e <code>REVOKE</code>.</li>
</ol>
<p>Ognuno di questi tipi di comandi può essere sfruttato dagli attaccanti per compromettere la confidenzialità, l’integrità e/o la disponibilità di un sistema.</p>
<p>Certo, per l’esercizio di recupero del dipartimento del dipendente Bob Franco dalla tabella <code>employees</code>, ecco una rappresentazione più dettagliata che include il testo dell’esercizio, la struttura della tabella e la query SQL esemplificativa.</p>
<h2 id="esercizio">Esercizio<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#esercizio" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<p>Si consideri la seguente tabella SQL denominata <code>employees</code>, che contiene dati sugli impiegati di un’azienda. L’azienda registra le seguenti informazioni sui propri dipendenti: un numero unico di identificazione del dipendente (<code>userid</code>), il cognome (<code>last_name</code>), il nome (<code>first_name</code>), il dipartimento (<code>department</code>), il salario (<code>salary</code>) e un numero di autenticazione della transazione (<code>auth_tan</code>). Ogni pezzo di informazione è memorizzato in una colonna separata, e ogni riga rappresenta un singolo dipendente dell’azienda.</p>
<h3 id="struttura-della-tavola-employees">Struttura della Tavola <code>employees</code><a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#struttura-della-tavola-employees" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>





















































<div class="table-container"><table><thead><tr><th>userid</th><th>first_name</th><th>last_name</th><th>department</th><th>salary</th><th>auth_tan</th></tr></thead><tbody><tr><td>32147</td><td>Paulina</td><td>Travers</td><td>Accounting</td><td>$46.000</td><td>P45JSI</td></tr><tr><td>89762</td><td>Tobi</td><td>Barnett</td><td>Development</td><td>$77.000</td><td>TA9LL1</td></tr><tr><td>96134</td><td>Bob</td><td>Franco</td><td>Marketing</td><td>$83.700</td><td>LO9S2V</td></tr><tr><td>34477</td><td>Abraham</td><td>Holman</td><td>Development</td><td>$50.000</td><td>UU2ALK</td></tr><tr><td>37648</td><td>John</td><td>Smith</td><td>Marketing</td><td>$64.350</td><td>3SL99A</td></tr></tbody></table></div>
<h3 id="esercizio-1">Esercizio<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#esercizio-1" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p><strong>Compito:</strong> Recuperare il dipartimento del dipendente Bob Franco. Si assume di avere pieni privilegi amministrativi per questo compito e di poter accedere a tutti i dati senza autenticazione.</p>
<h3 id="query-sql-esemplificativa">Query SQL Esemplificativa<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#query-sql-esemplificativa" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>Per ottenere il dipartimento di Bob Franco, si utilizza la seguente query SQL:</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="sql" data-theme="github-light github-dark"><code data-language="sql" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> department </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> employees </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> first_name </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 'Bob'</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> AND</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> last_name </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 'Franco'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre></figure>
<h3 id="risultato-atteso">Risultato Atteso<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#risultato-atteso" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>La query dovrebbe restituire il dipartimento di Bob Franco, che, secondo la tabella fornita, è “Marketing”.</p>
<h3 id="conclusioni">Conclusioni<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#conclusioni" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>Questo esercizio dimostra come utilizzare una query SQL <code>SELECT</code> per filtrare e recuperare informazioni specifiche da una tabella basandosi su criteri definiti, come il nome e il cognome di un dipendente. Gli esercizi come questo sono fondamentali per comprendere le operazioni di base di SQL e per imparare a manipolare e accedere ai dati all’interno di un database relazionale.</p>
<h1 id="data-manipulation-language-dml">Data Manipulation Language (DML)<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#data-manipulation-language-dml" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h1>
<p>Il <strong>Data Manipulation Language (DML)</strong> è una componente fondamentale del SQL che si occupa della manipolazione dei dati all’interno dei database. Attraverso l’utilizzo di comandi DML, è possibile eseguire operazioni come la richiesta, l’aggiunta, la modifica e la cancellazione di record. Gli attacchi di SQL Injection sfruttano proprio questi comandi per compromettere la sicurezza dei sistemi.</p>
<h4 id="comandi-dml-principali">Comandi DML Principali:<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#comandi-dml-principali" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<ul>
<li><strong>SELECT:</strong> Per recuperare dati da una o più tabelle.</li>
<li><strong>INSERT:</strong> Per inserire nuovi dati nelle tabelle.</li>
<li><strong>UPDATE:</strong> Per aggiornare i dati esistenti.</li>
<li><strong>DELETE:</strong> Per eliminare i record dalle tabelle.</li>
</ul>
<p>Questi comandi sono essenziali sia per la gestione quotidiana dei dati che per lo sviluppo di applicazioni robuste e sicure.</p>
<h4 id="esempio-di-utilizzo-dml">Esempio di Utilizzo DML:<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#esempio-di-utilizzo-dml" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<p>Per recuperare il numero di telefono di un dipendente specifico, si utilizzerebbe il comando <code>SELECT</code> come segue:</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="sql" data-theme="github-light github-dark"><code data-language="sql" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> phone</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> employees</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> userid </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 96134</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre></figure>
<p>Questo comando estrae il numero di telefono del dipendente con <code>userid</code> 96134.</p>
<h3 id="esercizio-pratico-modifica-del-dipartimento">Esercizio Pratico: Modifica del Dipartimento<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#esercizio-pratico-modifica-del-dipartimento" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p><strong>Obiettivo:</strong> Cambiare il dipartimento di Tobi Barnett in ‘Sales’.</p>
<p><strong>Premessa:</strong> Si assume di avere pieni privilegi amministrativi, il che permette di accedere e modificare tutti i dati senza necessità di autenticazione.</p>
<h4 id="passaggi-consigliati">Passaggi Consigliati:<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#passaggi-consigliati" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<ol>
<li><strong>Identificare il Record:</strong> Prima di tutto, è necessario individuare il record corrispondente a Tobi Barnett nella tabella <code>employees</code>.</li>
<li><strong>Eseguire l’UPDATE:</strong> Utilizzare il comando <code>UPDATE</code> per modificare il dipartimento di Tobi Barnett.</li>
</ol>
<h4 id="query-sql-di-esempio">Query SQL di Esempio:<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#query-sql-di-esempio" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="sql" data-theme="github-light github-dark"><code data-language="sql" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">UPDATE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> employees</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SET</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> department </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 'Sales'</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> first_name </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 'Tobi'</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> AND</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> last_name </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 'Barnett'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre></figure>
<p>Questa query modifica il dipartimento di Tobi Barnett in ‘Sales’, dimostrando come un comando DML <code>UPDATE</code> possa essere utilizzato per aggiornare i dati in un database.</p>
<h3 id="riflessione-sulla-sicurezza">Riflessione sulla Sicurezza<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#riflessione-sulla-sicurezza" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>La capacità di manipolare i dati tramite DML sottolinea l’importanza di proteggere le applicazioni web da attacchi di SQL Injection. Tali attacchi possono violare la confidenzialità, l’integrità e la disponibilità dei dati, compromettendo gravemente la sicurezza di un sistema. Implementare misure di sicurezza come la validazione dell’input, l’uso di query parametrizzate e la limitazione dei privilegi di accesso al database sono passi cruciali per mitigare questo rischio.</p>
<h1 id="ddl-data-definition-language">DDL (Data Definition Language)<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#ddl-data-definition-language" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h1>
<p>La <strong>Data Definition Language (DDL)</strong> comprende comandi utilizzati per definire la struttura dei dati all’interno di un database. Questi comandi sono fondamentali per la creazione, la modifica e l’eliminazione degli oggetti del database, contribuendo a delineare lo schema del database, che include tabelle, indici, viste, relazioni, trigger e altro ancora.</p>
<h3 id="comandi-ddl-principali">Comandi DDL Principali<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#comandi-ddl-principali" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<ul>
<li><strong><code>CREATE</code></strong>: Utilizzato per creare nuovi oggetti nel database, come tabelle e viste.</li>
<li><strong><code>ALTER</code></strong>: Modifica la struttura di un oggetto esistente, come aggiungere o rimuovere colonne in una tabella.</li>
<li><strong><code>DROP</code></strong>: Elimina oggetti dal database, rimuovendo definitivamente tabelle, viste o altri oggetti.</li>
</ul>
<h3 id="esempio-creazione-di-una-tabella">Esempio: Creazione di una Tabella<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#esempio-creazione-di-una-tabella" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="sql" data-theme="github-light github-dark"><code data-language="sql" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">CREATE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> TABLE</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> employees</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    userid </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">varchar</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">6</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">not null</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> primary key</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    first_name </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">varchar</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">20</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    last_name </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">varchar</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">20</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    department </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">varchar</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">20</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    salary </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">varchar</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    auth_tan </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">varchar</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">6</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre></figure>
<p>Questo comando <code>CREATE TABLE</code> crea la tabella degli impiegati (<code>employees</code>) con varie colonne per memorizzare informazioni quali l’ID utente, il nome, il cognome, il dipartimento, lo stipendio e un numero di autenticazione della transazione.</p>
<h3 id="rischi-per-la-sicurezza-con-ddl">Rischi per la Sicurezza con DDL<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#rischi-per-la-sicurezza-con-ddl" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>Un attaccante che riesce a iniettare comandi DDL in un database può compromettere l’integrità e la disponibilità del sistema:</p>
<ul>
<li><strong>Integrità</strong>: Utilizzando comandi <code>ALTER</code> e <code>DROP</code>, un attaccante può alterare o rimuovere elementi strutturali essenziali del database, influenzando l’integrità dei dati.</li>
<li><strong>Disponibilità</strong>: I comandi <code>DROP</code> possono essere utilizzati per eliminare tabelle o altri oggetti del database, influenzando negativamente la disponibilità dei dati per gli utenti legittimi.</li>
</ul>
<h3 id="esercizio-pratico-modifica-dello-schema">Esercizio Pratico: Modifica dello Schema<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#esercizio-pratico-modifica-dello-schema" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p><strong>Obiettivo</strong>: Aggiungere una colonna “phone” (<code>varchar(20)</code>) alla tabella “employees”.</p>
<p>Avendo pieni privilegi amministrativi, per aggiungere una nuova colonna alla tabella <code>employees</code>, si utilizza il comando <code>ALTER TABLE</code> come segue:</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="sql" data-theme="github-light github-dark"><code data-language="sql" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ALTER</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> TABLE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> employees</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ADD</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> COLUMN phone </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">varchar</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">20</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre></figure>
<p>Questo comando aggiunge una colonna <code>phone</code> alla tabella <code>employees</code>, permettendo di memorizzare numeri di telefono degli impiegati fino a 20 caratteri.
Comprendere e utilizzare correttamente i comandi DDL è essenziale per la gestione efficace della struttura di un database. Tuttavia, è fondamentale garantire che queste operazioni siano protette da accessi non autorizzati per preservare l’integrità e la disponibilità dei dati all’interno del sistema.</p>
<h1 id="dcl-data-control-language">DCL (Data Control Language)<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#dcl-data-control-language" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h1>
<p>La <strong>Data Control Language (DCL)</strong> comprende comandi utilizzati per implementare la logica di controllo degli accessi in un database. DCL si occupa principalmente della sicurezza e della gestione degli accessi, permettendo agli amministratori di database di specificare i diritti di accesso agli oggetti del database, come tabelle, viste e funzioni.</p>
<h3 id="comandi-principali-dcl">Comandi Principali DCL<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#comandi-principali-dcl" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<ul>
<li><strong><code>GRANT</code></strong>: Utilizzato per concedere privilegi di accesso a un utente o a un gruppo su specifici oggetti del database.</li>
<li><strong><code>REVOKE</code></strong>: Utilizzato per revocare privilegi di accesso precedentemente concessi a un utente o a un gruppo.</li>
</ul>
<h3 id="rischi-per-la-sicurezza-con-dcl">Rischi per la Sicurezza con DCL<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#rischi-per-la-sicurezza-con-dcl" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>Se un attaccante riesce a iniettare comandi DCL in un database, può compromettere:</p>
<ul>
<li><strong>Confidenzialità</strong>: Utilizzando comandi <code>GRANT</code>, potrebbe concedere a sé stesso o ad altri privilegi amministrativi, accedendo così a dati sensibili.</li>
<li><strong>Disponibilità</strong>: Utilizzando comandi <code>REVOKE</code>, potrebbe revocare i privilegi di accesso all’amministratore del database o ad altri utenti legittimi, influenzando la disponibilità dei dati.</li>
</ul>
<h3 id="esercizio-pratico-concessione-dei-diritti">Esercizio Pratico: Concessione dei Diritti<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#esercizio-pratico-concessione-dei-diritti" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p><strong>Obiettivo</strong>: Concedere i diritti alla tabella <code>grant_rights</code> all’utente <code>unauthorized_user</code>.</p>
<p>Considerando che si dispone di pieni privilegi amministrativi per l’assegnazione, il comando DCL per concedere diritti sull’oggetto tabella <code>grant_rights</code> a <code>unauthorized_user</code> sarebbe:</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="sql" data-theme="github-light github-dark"><code data-language="sql" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">GRANT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">INSERT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">UPDATE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">DELETE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ON</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> grant_rights </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">TO</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> unauthorized_user;</span></span></code></pre></figure>
<p>Questo comando concede all’<code>unauthorized_user</code> i privilegi per eseguire operazioni di <code>SELECT</code>, <code>INSERT</code>, <code>UPDATE</code>, e <code>DELETE</code> sulla tabella <code>grant_rights</code>.
La comprensione e l’uso appropriato dei comandi DCL sono cruciali per mantenere la sicurezza dei dati all’interno di un database, garantendo che solo gli utenti autorizzati abbiano accesso alle informazioni appropriate. Gli amministratori di database devono essere diligentemente consapevoli dei diritti concessi e revocati per prevenire potenziali violazioni della sicurezza e assicurare che l’integrità e la confidenzialità dei dati siano preservate.</p>
<h1 id="sql-injection">SQL Injection<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#sql-injection" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h1>
<p>L’iniezione SQL (SQLi) è una tecnica di hacking tra le più comuni che sfrutta le vulnerabilità nell’interazione tra le applicazioni web e i loro sistemi di gestione del database. Consiste nell’inserimento o “iniezione” di codice SQL maligno attraverso i campi di input forniti agli utenti, come form di ricerca o di login. Se un’applicazione non sanifica correttamente l’input utente o non filtra i caratteri speciali, gli aggressori possono manipolare le query SQL sottostanti per ottenere accesso non autorizzato o danneggiare i dati.</p>
<h3 id="esempi-di-iniezione-sql">Esempi di Iniezione SQL<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#esempi-di-iniezione-sql" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>Consideriamo un’applicazione web che consente agli utenti di recuperare informazioni inserendo un nome utente in un campo di un form. L’input dell’utente viene inviato al server e inserito in una query SQL, che viene poi interpretata da un motore SQL.</p>
<h4 id="esempio-di-query-sql-base">Esempio di Query SQL Base:<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#esempio-di-query-sql-base" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="sql" data-theme="github-light github-dark"><code data-language="sql" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;SELECT * FROM users WHERE name = '&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> +</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> userName </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;'&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre></figure>
<p>Se l’input fosse <code>Smith</code>, la query diventerebbe:</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="sql" data-theme="github-light github-dark"><code data-language="sql" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;SELECT * FROM users WHERE name = 'Smith'&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre></figure>
<p>e restituirebbe tutti i dati relativi all’utente con nome <code>Smith</code>.</p>
<h4 id="manipolazione-tramite-iniezione-sql">Manipolazione tramite Iniezione SQL:<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#manipolazione-tramite-iniezione-sql" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<p>Se un aggressore inserisce dati contenenti caratteri o stringhe che hanno un significato “speciale” per l’interprete SQL (come <code>;</code>, <code>--</code>, o <code>'</code>), e i dati non vengono correttamente sanificati o validati, l’aggressore può modificare il comportamento previsto della query SQL per eseguire azioni (maligne) sul database.</p>
<h4 id="esempi-di-input-maligni">Esempi di Input Maligni:<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#esempi-di-input-maligni" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<ul>
<li>
<p><code>Smith' OR '1' = '1</code>: Risulta in <code>SELECT * FROM users WHERE name = 'Smith' OR TRUE;</code> che restituirà tutte le voci dalla tabella <code>users</code>.</p>
</li>
<li>
<p><code>Smith' OR 1 = 1; --</code>: Risulta in <code>SELECT * FROM users WHERE name = 'Smith' OR TRUE;--';</code> che, come nel primo esempio, restituirà tutte le voci dalla tabella <code>users</code>.</p>
</li>
<li>
<p><code>Smith'; DROP TABLE users; TRUNCATE audit_log; --</code>: Concatena più comandi SQL per eliminare sia la tabella <code>users</code> che cancellare tutte le voci dalla tabella <code>audit_log</code>.</p>
</li>
</ul>
<h3 id="impatto-delliniezione-sql">Impatto dell’Iniezione SQL<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#impatto-delliniezione-sql" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>L’iniezione SQL può compromettere seriamente l’integrità, la confidenzialità e la disponibilità dei dati in un sistema:</p>
<ul>
<li><strong>Confidenzialità</strong>: Accedendo a dati sensibili senza autorizzazione.</li>
<li><strong>Integrità</strong>: Modificando o cancellando dati.</li>
<li><strong>Disponibilità</strong>: Rendendo i dati o l’intero database inaccessibili.</li>
</ul>
<h3 id="prevenzione-delliniezione-sql">Prevenzione dell’Iniezione SQL<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#prevenzione-delliniezione-sql" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>Per prevenire l’iniezione SQL, le applicazioni dovrebbero:</p>
<ul>
<li>Utilizzare statement SQL parametrizzati o ORM che automaticamente gestiscono la sicurezza dell’input.</li>
<li>Sanificare e validare tutti gli input utente, in particolare quelli che influenzano le query SQL.</li>
<li>Adottare il principio del minimo privilegio, limitando i diritti degli utenti sui database solo a quelli strettamente necessari.</li>
</ul>
<p>L’adozione di queste pratiche migliora notevolmente la sicurezza delle applicazioni web e protegge i dati sensibili da accessi non autorizzati o manipolazioni dannose.</p>
<p>L’iniezione SQL (SQLi) rappresenta una minaccia significativa per la sicurezza dei database collegati alle applicazioni web. Questa tecnica di attacco sfrutta le vulnerabilità nell’input dell’utente che non viene adeguatamente filtrato o sanificato prima di essere eseguito come parte di una query SQL. Le conseguenze di un attacco SQLi riuscito sono vaste e possono avere impatti devastanti sulla sicurezza e l’integrità dei dati. Di seguito, sono dettagliate le possibili conseguenze di un’iniezione SQL:</p>
<h3 id="lettura-e-modifica-di-dati-sensibili">Lettura e Modifica di Dati Sensibili<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#lettura-e-modifica-di-dati-sensibili" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>Gli attaccanti possono leggere dati sensibili dal database, come informazioni personali degli utenti, dati finanziari, o credenziali di accesso. Questo viola la confidenzialità dei dati e può portare a furti di identità, frodi finanziarie, o altre forme di abuso di dati.</p>
<h3 id="esecuzione-di-operazioni-amministrative-sul-database">Esecuzione di Operazioni Amministrative sul Database<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#esecuzione-di-operazioni-amministrative-sul-database" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>Le iniezioni SQL possono consentire agli attaccanti di eseguire operazioni amministrative sul database, come:</p>
<ul>
<li><strong>Disattivazione dell’auditing o del DBMS</strong>: Compromettendo la capacità di monitorare e registrare le attività sospette.</li>
<li><strong>Troncamento di tabelle e log</strong>: Eliminando i dati importanti e le tracce delle attività degli attaccanti.</li>
<li><strong>Aggiunta di utenti</strong>: Creando nuovi account con privilegi elevati, gli attaccanti possono garantirsi l’accesso continuo al sistema.</li>
</ul>
<h3 id="recupero-del-contenuto-di-file-presenti-nel-file-system-del-dbms">Recupero del Contenuto di File Presenti nel File System del DBMS<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#recupero-del-contenuto-di-file-presenti-nel-file-system-del-dbms" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>Gli attaccanti possono utilizzare l’iniezione SQL per leggere il contenuto di file specifici presenti nel file system del DBMS, ottenendo così accesso a dati o configurazioni sensibili del sistema.</p>
<h3 id="emissione-di-comandi-al-sistema-operativo">Emissione di Comandi al Sistema Operativo<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#emissione-di-comandi-al-sistema-operativo" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>In alcuni casi, l’iniezione SQL può permettere agli attaccanti di eseguire comandi direttamente sul sistema operativo sottostante, compromettendo l’intera macchina ospitante il database.</p>
<h3 id="conseguenze-delliniezione-sql-sugli-obiettivi-di-sicurezza">Conseguenze dell’Iniezione SQL sugli Obiettivi di Sicurezza<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#conseguenze-delliniezione-sql-sugli-obiettivi-di-sicurezza" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<ul>
<li><strong>Falsificazione dell’Identità</strong>: Gli attaccanti possono impersonare altri utenti, accedendo a dati o eseguendo azioni non autorizzate.</li>
<li><strong>Alterazione dei Dati Esistenti</strong>: Possono modificare o cancellare dati, compromettendo l’integrità delle informazioni.</li>
<li><strong>Problemi di Ripudio</strong>: Possono alterare bilanci, annullare transazioni o modificare dati critici, creando confusione e problemi legali.</li>
<li><strong>Divulgazione Completa dei Dati</strong>: Possono accedere a tutti i dati del sistema, esponendo informazioni riservate o sensibili.</li>
<li><strong>Distruggere i Dati o Renderli Altrimenti Non Disponibili</strong>: Possono cancellare dati critici o rendere il sistema inutilizzabile, influenzando la disponibilità.</li>
<li><strong>Diventare Amministratori del Server del Database</strong>: Ottenendo il controllo completo sul database e potenzialmente sull’intero sistema.
L’iniezione SQL rappresenta una grave minaccia per la sicurezza delle applicazioni web, ma la gravità di un attacco può variare ampiamente a seconda di diversi fattori. Ecco una panoramica dei principali elementi che influenzano la severità di un’iniezione SQL:</li>
</ul>
<h3 id="abilità-e-immaginazione-dellattaccante">Abilità e Immaginazione dell’Attaccante<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#abilità-e-immaginazione-dellattaccante" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>La gravità di un’iniezione SQL è fortemente influenzata dall’abilità tecnica e dall’ingegnosità dell’attaccante. Un aggressore con una profonda conoscenza dei sistemi di gestione dei database (DBMS) e delle tecniche avanzate di iniezione SQL può sfruttare vulnerabilità che altri potrebbero non riuscire a identificare o sfruttare.</p>
<h3 id="misure-di-difesa-stratificate">Misure di Difesa Stratificate<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#misure-di-difesa-stratificate" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>La presenza di misure di difesa multilivello può limitare significativamente l’impatto di un attacco SQLi. Queste misure includono:</p>
<ul>
<li><strong>Validazione dell’Input</strong>: Assicurare che tutti gli input ricevuti dall’utente siano validati per tipologia e formato atteso può prevenire l’esecuzione di query SQL malevole.</li>
<li><strong>Principio del Minimo Privilegio</strong>: Limitare i diritti di accesso al database solo a ciò che è strettamente necessario per l’esecuzione delle funzioni dell’applicazione riduce il potenziale impatto di un’iniezione SQL riuscita.</li>
</ul>
<h3 id="tecnologia-del-database">Tecnologia del Database<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#tecnologia-del-database" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>La tecnologia del database in uso può influenzare la fattibilità e l’efficacia di un attacco SQLi. Alcuni database non supportano il chaining di comandi, il che può limitare le azioni che un attaccante può eseguire attraverso un’unica iniezione. Ad esempio:</p>
<ul>
<li><strong>Microsoft Access</strong>, <strong>MySQL Connector/J e C</strong>, e <strong>Oracle</strong> hanno limitazioni specifiche che possono ridurre la gravità di un attacco SQLi.</li>
</ul>
<h3 id="linguaggi-di-programmazione">Linguaggi di Programmazione<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#linguaggi-di-programmazione" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>L’iniezione SQL è più comune in linguaggi di programmazione più vecchi o meno sicuri come PHP, Classic ASP, Cold Fusion, che inizialmente non fornivano supporto per le query parametrizzate. Tuttavia, le versioni più recenti di questi linguaggi hanno introdotto il supporto per le query parametrizzate, mitigando così il rischio di iniezione SQL.</p>
<ul>
<li><strong>Query Parametrizzate</strong>: L’uso di query parametrizzate è una delle difese più efficaci contro l’iniezione SQL, poiché separa chiaramente i dati dalle istruzioni SQL, impedendo l’esecuzione di input malevoli come parte della query.</li>
</ul>
<h3 id="specificità-dei-database">Specificità dei Database<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#specificità-dei-database" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>Non tutti i database sono uguali. SQL Server, ad esempio, offre funzionalità che possono essere sfruttate dagli attaccanti, come:</p>
<ul>
<li><strong>Shell dei Comandi</strong>: Utilizzando <code>master.dbo.xp_cmdshell</code> per eseguire comandi diretti del sistema operativo.</li>
<li><strong>Comandi del Registro di Sistema</strong>: Funzioni come <code>xp_regread</code> e <code>xp_regdeletekey</code> possono essere usate per manipolare il registro di sistema del server.</li>
</ul>
<h3 id="conclusione">Conclusione<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#conclusione" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>La severità di un attacco SQLi può variare notevolmente, ma comprendere i fattori che influenzano questa gravità è essenziale per sviluppare strategie di difesa efficaci. Implementare la validazione dell’input, adottare il principio del minimo privilegio, utilizzare tecnologie di database sicure e sfruttare le funzionalità di sicurezza offerte dai linguaggi di programmazione moderni sono passi critici per proteggere le applicazioni web dalle vulnerabilità di iniezione SQL.</p>
<h2 id="string-sql-injection">String SQL Injection<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#string-sql-injection" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<p>Nella nostra dispensa sull’iniezione SQL, esploreremo ora come eseguire un attacco di tipo String SQL Injection e il potenziale impatto di tale attacco su una query dinamica. Questo esercizio dimostra la vulnerabilità di un’applicazione web che costruisce query SQL dinamicamente, combinando stringhe in modo insicuro.</p>
<h3 id="esercizio-iniezione-sql-di-tipo-stringa">Esercizio: Iniezione SQL di Tipo Stringa<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#esercizio-iniezione-sql-di-tipo-stringa" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>Immaginiamo di avere una query SQL costruita dinamicamente nel codice di un’applicazione web, simile all’esempio fornito. Questa pratica di costruire query concatenando stringhe rende l’applicazione vulnerabile agli attacchi di iniezione SQL di tipo stringa.</p>
<h4 id="query-vulnerabile">Query Vulnerabile:<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#query-vulnerabile" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="sql" data-theme="github-light github-dark"><code data-language="sql" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;SELECT * FROM user_data WHERE first_name = 'John' AND last_name = '&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> +</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> lastName </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;'&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre></figure>
<p>In questa query, <code>lastName</code> è una variabile che contiene l’input dell’utente. Se l’input non viene sanificato o filtrato adeguatamente, un attaccante può iniettare SQL malevolo.</p>
<h4 id="obiettivo-dellesercizio">Obiettivo dell’Esercizio:<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#obiettivo-dellesercizio" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<p>Utilizzare il form sottostante per recuperare tutti gli utenti dalla tabella <code>user_data</code>, senza necessità di conoscere un nome utente specifico.</p>
<h4 id="soluzione-vulnerabile">Soluzione Vulnerabile:<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#soluzione-vulnerabile" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<p>Per eseguire un attacco e recuperare tutti gli utenti, un attaccante potrebbe inserire un valore per <code>lastName</code> che chiuda la query precedente e ne inserisca una nuova o alteri il comportamento della query originale. Un esempio di input malevolo potrebbe essere:</p>
<pre><code>' OR '1'='1
</code></pre>
<p>L’inserimento di questo input modificherebbe la query in:</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="sql" data-theme="github-light github-dark"><code data-language="sql" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> user_data </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> first_name </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 'John'</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> AND</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> last_name </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ''</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> OR</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> '1'</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">'1'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre></figure>
<p>Questo causa l’esecuzione di una condizione sempre vera (<code>'1'='1'</code>), risultando nella restituzione di tutti i record dalla tabella <code>user_data</code>, indipendentemente dal valore dei campi <code>first_name</code> o <code>last_name</code>.</p>
<h3 id="discussione">Discussione:<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#discussione" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>Questo esercizio dimostra la pericolosità di costruire query SQL dinamicamente senza adeguati controlli o sanificazioni sull’input dell’utente. L’iniezione di stringhe SQL può portare alla divulgazione di informazioni sensibili, alla modifica non autorizzata dei dati o ad altre conseguenze dannose.</p>
<p>Nella sezione sulla Numeric SQL Injection della nostra dispensa, ci concentriamo su un esercizio pratico che dimostra come un’applicazione web possa essere vulnerabile agli attacchi di iniezione SQL numerica a causa della costruzione dinamica delle query SQL. Questo tipo di vulnerabilità si verifica quando l’input dell’utente, che dovrebbe essere un numero, viene concatenato direttamente in una query SQL senza adeguati controlli o sanificazioni.</p>
<h2 id="numeric-sql-injection">Numeric SQL Injection<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#numeric-sql-injection" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<p>Consideriamo una query SQL costruita dinamicamente che utilizza l’input numerico dell’utente:</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="sql" data-theme="github-light github-dark"><code data-language="sql" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;SELECT * FROM user_data WHERE login_count = &quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> +</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Login_Count </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot; AND userid = &quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> +</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> User_ID;</span></span></code></pre></figure>
<p>In questa query, <code>Login_Count</code> e <code>User_ID</code> sono valori forniti dall’utente. Senza adeguata validazione o sanificazione, un attaccante può inserire valori malevoli per manipolare la query.</p>
<h4 id="obiettivo-dellesercizio-1">Obiettivo dell’Esercizio:<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#obiettivo-dellesercizio-1" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<p>Utilizzare i due campi di input forniti per recuperare tutti i dati dalla tabella <code>user_data</code>, identificando quale dei due campi è vulnerabile all’iniezione SQL numerica per recuperare con successo tutti i dati.</p>
<h4 id="identificazione-della-vulnerabilità">Identificazione della Vulnerabilità:<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#identificazione-della-vulnerabilità" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<p>Per determinare quale campo è suscettibile all’iniezione SQL numerica, consideriamo che l’iniezione avviene quando l’input atteso è un numero. Un attaccante potrebbe inserire un input come <code>0 OR 1=1</code> per alterare la logica della query. Questo input forzerebbe la query a restituire tutti i record dalla tabella, ignorando le condizioni originali.</p>
<pre><code>Login_Count: [lasciato vuoto o un valore valido]
User_ID: 0 OR 1=1
</code></pre>
<p>Ciò modificherebbe la query in:</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="sql" data-theme="github-light github-dark"><code data-language="sql" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> user_data </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> login_count </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [Login_Count] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">AND</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> userid </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> OR</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre></figure>
<p>Questa manipolazione sfrutta la priorità degli operatori e la logica delle condizioni nelle query SQL. La condizione <code>1=1</code> è universalmente vera, quindi l’uso di <code>OR 1=1</code> dopo <code>userid = 0</code> rende l’intera condizione <code>WHERE</code> vera per ogni riga nella tabella, indipendentemente dai valori di <code>login_count</code> e <code>User_ID</code>. L’attacco non funzionerebbe invertendo i valori, in quanto l’OR sarebbe in mezzo all’espressione booleana, e quindi verrebbe comunque effettuato alla fine un AND che mi rende falsa l’espressione.</p>
<p>Nella nostra dispensa che esplora come un’iniezione SQL possa compromettere la riservatezza dei dati, ci concentriamo su un esempio pratico che illustra l’uso dell’iniezione SQL di tipo stringa per accedere a dati sensibili. Questo esercizio aiuta a comprendere come le vulnerabilità di sicurezza possano essere sfruttate per violare la confidenzialità dei dati all’interno di un sistema.</p>
<h1 id="sql-injection-per-compromettere-la-triade-cia">SQL Injection per compromettere la triade CIA<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#sql-injection-per-compromettere-la-triade-cia" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h1>
<h2 id="confidentiality-c-compromissione-della-riservatezza-tramite-iniezione-sql-di-tipo-stringa">Confidentiality (C): Compromissione della Riservatezza tramite Iniezione SQL di Tipo Stringa<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#confidentiality-c-compromissione-della-riservatezza-tramite-iniezione-sql-di-tipo-stringa" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<p>L’iniezione SQL di tipo stringa si verifica quando un’applicazione costruisce query SQL concatenando direttamente input forniti dall’utente, senza adeguata sanificazione o preparazione. Questo approccio rende l’applicazione vulnerabile, permettendo agli attaccanti di modificare il comportamento delle query SQL inserendo appositamente sequenze di caratteri malevoli.</p>
<h4 id="scenario-pratico-accesso-ai-dati-dei-colleghi">Scenario Pratico: Accesso ai Dati dei Colleghi<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#scenario-pratico-accesso-ai-dati-dei-colleghi" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<p><strong>Situazione</strong>: Sei un dipendente di nome John Smith in una grande azienda che dispone di un sistema interno per visualizzare i dati interni dei dipendenti, come il dipartimento di appartenenza e lo stipendio, utilizzando un TAN di autenticazione unico.</p>
<p><strong>Obiettivo</strong>: Vuoi esplorare il sistema per visualizzare i dati di tutti i tuoi colleghi, non solo i tuoi, per confrontare gli stipendi.</p>
<p><strong>Vulnerabilità Sfruttata</strong>: La query SQL che gestisce la tua richiesta è vulnerabile all’iniezione SQL:</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="sql" data-theme="github-light github-dark"><code data-language="sql" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;SELECT * FROM employees WHERE last_name = '&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> +</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> +</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;' AND auth_tan = '&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> +</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> auth_tan </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;'&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre></figure>
<p><strong>Approccio di Iniezione</strong>:
Per sfruttare questa vulnerabilità, inserisci un input che termini la query SQL corrente e ne modifichi il comportamento per restituire i dati di tutti i dipendenti. Un esempio di input malevolo potrebbe essere:</p>
<p><strong><code>name</code></strong>: <code>' OR '1'='1</code></p>
<p>Questo approccio utilizza l’iniezione di <code>' OR '1'='1</code> per creare una condizione sempre vera, ignorando i controlli su <code>last_name</code> e <code>auth_tan</code>.</p>
<h4 id="risultato-atteso-1">Risultato Atteso<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#risultato-atteso-1" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<p>La query modificata ignora i criteri di autenticazione e seleziona tutti i record dalla tabella <code>employees</code>, esponendo i dati sensibili di tutti i dipendenti, inclusi i dettagli sugli stipendi.</p>
<p>Nella nostra dispensa che esplora le vulnerabilità di sicurezza nelle applicazioni web, il focus ora si sposta sulla compromissione dell’integrità dei dati attraverso l’uso di SQL query chaining. Questa tecnica di attacco permette agli aggressori di eseguire più istruzioni SQL in un’unica operazione, potenzialmente alterando o distruggendo dati critici.</p>
<h3 id="integrity-i-compromissione-dellintegrità-tramite-query-chaining">Integrity (I): Compromissione dell’Integrità tramite Query Chaining<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#integrity-i-compromissione-dellintegrità-tramite-query-chaining" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p><strong>Definizione di Query Chaining</strong>:
Il chaining di query SQL si riferisce alla pratica di aggiungere una o più istruzioni SQL alla fine di una query effettiva, utilizzando il carattere <code>;</code> come delimitatore. Questo carattere segnala la fine di una dichiarazione SQL e l’inizio di un’altra, consentendo agli attaccanti di iniettare ulteriori comandi che possono alterare i dati o la struttura del database.</p>
<h4 id="scenario-pratico-modifica-dello-stipendio">Scenario Pratico: Modifica dello Stipendio<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#scenario-pratico-modifica-dello-stipendio" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<p>Nell’esercizio precedente, hai scoperto che i tuoi colleghi Tobi e Bob guadagnano più di te. Motivato da questo, decidi di modificare il tuo stipendio nel sistema per assicurarti di essere il dipendente con lo stipendio più alto.</p>
<p><strong>Informazioni Conosciute</strong>:</p>
<ul>
<li>Il tuo nome è John Smith.</li>
<li>Il tuo TAN attuale è 3SL99A.</li>
</ul>
<h4 id="approccio-di-attacco">Approccio di Attacco:<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#approccio-di-attacco" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<p>Per modificare il tuo stipendio utilizzando il chaining di query, dovresti trovare un punto di iniezione che permetta l’esecuzione di più istruzioni SQL. L’obiettivo sarebbe iniettare una query aggiuntiva per aggiornare il tuo stipendio nella tabella <code>employees</code>.</p>
<p>Un esempio ipotetico di attacco, che non dovrebbe essere tentato o eseguito su sistemi reali senza autorizzazione, potrebbe apparire così:</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="sql" data-theme="github-light github-dark"><code data-language="sql" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">'; UPDATE employees SET salary = '</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">100000</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">' WHERE last_name = '</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Smith</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">' AND auth_tan = '</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">3SL99A</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">'; --</span></span></code></pre></figure>
<p>Questa iniezione ipotetica si conclude con il termine della query originale (<code>'</code>), seguito da un punto e virgola (<code>;</code>) per iniziare una nuova istruzione. La nuova istruzione <code>UPDATE</code> modifica lo stipendio per l’utente specificato (in questo caso, John Smith con TAN 3SL99A), e infine, un commento SQL (<code>--</code>) è usato per ignorare il resto della query originale e prevenire errori di sintassi.</p>
<h3 id="availability-a-compromissione-della-disponibilità-tramite-iniezione-sql">Availability (A): Compromissione della Disponibilità tramite Iniezione SQL<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#availability-a-compromissione-della-disponibilità-tramite-iniezione-sql" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>La sezione della nostra dispensa su SQL Injection si focalizza ora sulla compromissione della disponibilità dei dati, l’ultimo elemento della triade CIA (Confidenzialità, Integrità, Disponibilità). Questa fase dimostra come un attacco di iniezione SQL possa essere utilizzato per rendere i dati inaccessibili, violando così la disponibilità.
Violare la disponibilità significa rendere i dati inaccessibili agli utenti legittimi. Ciò può avvenire attraverso diverse tecniche, tra cui la modifica delle credenziali di accesso, l’eliminazione di account, dati o intere tabelle del database, o la revoca dei diritti di accesso. Un attaccante potrebbe, ad esempio, eliminare la tabella <code>access_log</code> per nascondere le tracce delle sue azioni.</p>
<h4 id="esempio-pratico-eliminazione-della-tabella-access_log">Esempio Pratico: Eliminazione della Tabella <code>access_log</code><a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#esempio-pratico-eliminazione-della-tabella-access_log" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<p>Dopo aver compromesso la confidenzialità e l’integrità dei dati nelle lezioni precedenti, scopri l’esistenza di una tabella <code>access_log</code> che registra tutte le tue azioni. Per evitare che le tue manipolazioni vengano scoperte, decidi di eliminare completamente questa tabella.</p>
<h4 id="tecnica-di-attacco-query-chaining">Tecnica di Attacco: Query Chaining<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#tecnica-di-attacco-query-chaining" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<p>Il “Query Chaining” consente di eseguire più query SQL in sequenza, separate da un punto e virgola (<code>;</code>). Questa tecnica può essere sfruttata per appendere una query di eliminazione alla query originale, con l’obiettivo di eliminare la tabella <code>access_log</code>.</p>
<h5 id="input-malevolo">Input Malevolo:<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#input-malevolo" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h5>
<p>Supponiamo che l’applicazione vulnerabile permetta l’inserimento di input non sanificati in una forma che poi viene utilizzata per costruire dinamicamente una query SQL. Per eliminare la tabella <code>access_log</code>, potresti inserire:</p>
<pre><code>'; DROP TABLE access_log; --
</code></pre>
<p>Questo input termina la query SQL originale (usando <code>';</code>), esegue il comando <code>DROP TABLE access_log</code> per eliminare la tabella e infine utilizza <code>--</code> per commentare il resto della query, prevenendo errori di sintassi dovuti a eventuali segmenti rimanenti della query originale.</p>
<h1 id="tecniche-avanzate">Tecniche avanzate<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#tecniche-avanzate" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h1>
<h2 id="introduzione">Introduzione<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#introduzione" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<p>Gli attacchi SQL Injection possono essere molto sofisticati e vengono eseguiti in diverse forme, tra cui:</p>
<ol>
<li><strong>SQL Injection Classica:</strong> L’attaccante sfrutta input non sanificati per alterare la struttura della query SQL, potenzialmente esponendo dati sensibili.</li>
<li><strong>Blind SQL Injection (Iniezione SQL Cieca):</strong> Anche senza visualizzare direttamente i risultati di una query, un attaccante può dedurre informazioni sensibili tramite domande di vero/falso inviate al database.</li>
<li><strong>Iniezione SQL Basata su Errori:</strong> Tramite messaggi di errore dettagliati forniti dall’applicazione, gli attaccanti possono ottenere informazioni preziose sul database.</li>
<li><strong>Iniezione SQL di Secondo Ordine:</strong> Questo avviene quando i dati forniti dall’utente vengono memorizzati e poi eseguiti in seguito come una query SQL.</li>
</ol>
<p>Per mitigare il rischio di attacchi SQL Injection, gli sviluppatori devono adottare pratiche di programmazione sicura, come l’utilizzo di query parametrizzate, la sanificazione dell’input dell’utente e l’implementazione di principi di minimo privilegio per l’accesso al database. La consapevolezza e la comprensione di come funzionano gli attacchi SQL Injection sono fondamentali per la sicurezza delle applicazioni web moderne.</p>
<h2 id="caratteri-speciali-e-statement-speciali">Caratteri speciali e statement speciali<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#caratteri-speciali-e-statement-speciali" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<p>Questa sezione copre l’uso di caratteri speciali e dichiarazioni nell’ambito delle iniezioni SQL, offrendo strumenti potenti per manipolare e accedere ai dati in modi non previsti dall’applicazione. Ecco un’elaborazione e integrazione basata sulle informazioni fornite:</p>
<h3 id="caratteri-speciali-nelle-sql-injection">Caratteri Speciali nelle SQL Injection<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#caratteri-speciali-nelle-sql-injection" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<ol>
<li>
<p><strong>Commenti Inline (<code>/* */</code>) e di Linea (<code>--</code>, <code>#</code>):</strong> Sono utilizzati per terminare prematuramente una query, permettendo all’attaccante di inserire parti di query che possono ignorare i controlli di sicurezza o le parti della query originale dopo l’iniezione.</p>
</li>
<li>
<p><strong>Concatenazione di Stringhe (<code>', +, ||</code>):</strong> Questi operatori consentono di unire stringhe diverse per creare input malevoli. La capacità di concatenare stringhe può essere sfruttata per costruire query SQL dannose in modo dinamico.</p>
</li>
<li>
<p><strong>Uso di <code>Char()</code> per Evitare Quotazioni:</strong> Questa funzione consente di inserire caratteri speciali o riservati in una query senza l’uso diretto di apici, bypassando alcuni tipi di filtraggio input.</p>
</li>
<li>
<p><strong>Chaining di Query con <code>;</code>:</strong> Permette di eseguire più comandi SQL in una sola volta. Questo può essere particolarmente distruttivo se l’attaccante riesce a inserire comandi come <code>DROP TABLE</code>, che possono eliminare interi set di dati.</p>
</li>
</ol>
<h3 id="dichiarazioni-speciali">Dichiarazioni Speciali<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#dichiarazioni-speciali" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<ol>
<li>
<p><strong><code>UNION</code>:</strong> Utilizzato per combinare i risultati di due o più comandi SELECT in un unico set di risultati. L’operatore <code>UNION</code> richiede che ogni query SELECT nell’unione abbia lo stesso numero di colonne nei risultati, con tipi di dati compatibili. Questo può essere usato in un attacco SQL Injection per estrarre dati da diverse tabelle in un’unica query.</p>
</li>
<li>
<p><strong><code>UNION ALL</code>:</strong> A differenza di <code>UNION</code>, <code>UNION ALL</code> permette di includere valori duplicati nei risultati. Questo può essere utile in scenari di attacco dove l’aggregazione di dati da diverse fonti, anche con ripetizioni, è desiderata.</p>
</li>
<li>
<p><strong><code>JOIN</code>:</strong> È utilizzato per combinare le righe di due o più tabelle basate su una colonna relazionata tra loro. Attraverso tecniche di iniezione che sfruttano i <code>JOIN</code>, gli attaccanti possono ottenere informazioni correlate da diverse tabelle, aumentando l’ampiezza dell’attacco.</p>
</li>
</ol>
<p>Per informazioni più dettagliate sulla join visita: <a href="https://www.w3schools.com/sql/sql_join.asp" class="external">https://www.w3schools.com/sql/sql_join.asp<svg aria-hidden="true" class="external-icon" style="max-width:0.8em;max-height:0.8em;" viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a></p>
<h2 id="esercizio-estrazione-di-dati-tramite-sql-injection">Esercizio: Estrazione di Dati tramite SQL Injection<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#esercizio-estrazione-di-dati-tramite-sql-injection" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<p><strong>Obiettivo:</strong> Utilizzare le tecniche di SQL Injection per recuperare dati sensibili da una tabella non direttamente esposta attraverso l’input dell’utente in un’applicazione web simulata.</p>
<p><strong>Scenario:</strong> Immagina di essere un tester per la sicurezza incaricato di valutare la vulnerabilità di un’applicazione web agli attacchi SQL Injection. Durante il tuo testing, hai identificato un campo di input che accetta il cognome degli utenti come input e lo utilizza per eseguire una query SQL alla tabella <code>user_data</code>. La struttura delle tabelle interessate è la seguente:</p>
<ul>
<li>
<p>Tabella <code>user_data</code>:</p>
<pre><code>CREATE TABLE user_data (
  userid int not null,
  first_name varchar(20),
  last_name varchar(20),
  cc_number varchar(30),
  cc_type varchar(10),
  cookie varchar(20),
  login_count int
);
</code></pre>
</li>
<li>
<p>Tabella <code>user_system_data</code>:</p>
<pre><code>CREATE TABLE user_system_data (
  userid int not null primary key,
  user_name varchar(12),
  password varchar(10),
  cookie varchar(30)
);
</code></pre>
</li>
</ul>
<p><strong>Compiti:</strong></p>
<ol>
<li>
<p><strong>Estrazione di Tutti i Dati:</strong> Sfrutta la vulnerabilità SQL Injection per estrarre tutti i dati dalla tabella <code>user_system_data</code>. Considera l’uso della clausola <code>UNION</code> o l’apposizione di un nuovo comando SQL.</p>
</li>
<li>
<p><strong>Recupero di una Password Specifica:</strong> Una volta che sei in grado di estrarre dati dalla tabella <code>user_system_data</code>, identifica la password dell’utente Dave.</p>
</li>
</ol>
<p><strong>Suggerimenti:</strong></p>
<ul>
<li>Assicurati che il numero di colonne selezionate con <code>UNION</code> corrisponda tra le tabelle.</li>
<li>Ricorda che alcuni sistemi di gestione del database potrebbero non permettere l’esecuzione di più statement SQL separati da <code>;</code>.</li>
</ul>
<p><strong>Nota Etica:</strong> Questo esercizio è destinato esclusivamente a scopi educativi e di formazione sulla sicurezza. Non tentare di applicare queste tecniche su applicazioni o database senza esplicita autorizzazione.</p>
<p>Questo testo fornisce una panoramica chiara e un contesto per l’esercizio, incoraggiando l’apprendimento e la consapevolezza delle vulnerabilità di sicurezza senza promuovere azioni non etiche o illegali.</p>
<h3 id="utilizzo-di-union">Utilizzo di <code>UNION</code><a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#utilizzo-di-union" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>Per estrarre dati da un’altra tabella utilizzando <code>UNION</code>, l’attaccante deve prima assicurarsi che il numero di colonne selezionate nella query iniettata corrisponda al numero di colonne nella query originale. In questo scenario, l’obiettivo è ottenere informazioni dalla tabella <code>user_system_data</code>.</p>
<ol>
<li>
<p><strong>Analizzare la Query Originale:</strong> La query vulnerabile potrebbe assomigliare a qualcosa del tipo: <code>SELECT * FROM user_data WHERE last_name = '&lt;input dell'utente>';</code>. L’input dell’utente è il punto di iniezione.</p>
</li>
<li>
<p><strong>Costruire la Query Iniettata:</strong> Utilizzando <code>UNION</code>, l’attaccante può aggiungere una seconda query SELECT che estrae dati dalla tabella <code>user_system_data</code>. Per fare ciò, deve assicurarsi di selezionare lo stesso numero di colonne presenti nella tabella <code>user_data</code> e di usare valori fittizi o null per mantenere l’allineamento delle colonne, se necessario.</p>
</li>
</ol>
<h3 id="appendere-un-nuovo-statement-sql">Appendere un Nuovo Statement SQL<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#appendere-un-nuovo-statement-sql" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>Un’altra tecnica consiste nell’appendere un nuovo comando SQL alla query originale, spesso utilizzando il carattere <code>;</code> per separare le due istruzioni. Tuttavia, questo approccio dipende dalla possibilità di eseguire più comandi SQL in una singola istruzione, che potrebbe essere limitata in base alla configurazione del database o dell’interfaccia applicativa.</p>
<h3 id="considerazioni-sulla-sicurezza">Considerazioni sulla Sicurezza<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#considerazioni-sulla-sicurezza" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>Questi esempi dimostrano la pericolosità delle vulnerabilità SQL Injection e sottolineano l’importanza di adottare misure di sicurezza adeguate, come:</p>
<ul>
<li><strong>Utilizzare Query Parametrizzate:</strong> Previene l’iniezione SQL trattando i dati di input come parametri separati dal codice SQL.</li>
<li><strong>Sanificare l’Input:</strong> Rimuovere o neutralizzare caratteri speciali dall’input utente.</li>
<li><strong>Limitare i Privilegi:</strong> Assicurarsi che l’account del database usato dall’applicazione abbia solo i privilegi necessari per le sue funzioni.</li>
<li><strong>Usare ORM (Object Relational Mapping):</strong> Molti ORM moderni utilizzano query parametrizzate per prevenire le iniezioni SQL.</li>
</ul>
<h1 id="mitigation-delle-sql-injection">Mitigation delle SQL Injection<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#mitigation-delle-sql-injection" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h1>
<p>Le tecniche descritte sono metodologie per prevenire o ridurre il rischio di attacchi di iniezione SQL, un tipo di vulnerabilità di sicurezza che permette a un aggressore di interferire con le query che un’applicazione invia al suo database. Esaminiamo queste tecniche più da vicino.</p>
<h3 id="query-statiche">Query Statiche<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#query-statiche" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>Le query statiche sono esempi di query immutabili. Sono definite in modo esplicito nel codice e non cambiano indipendentemente dai dati forniti dall’utente. Ecco due esempi di query statiche:</p>
<ol>
<li>
<p>Query per selezionare tutti i prodotti:</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="sql" data-theme="github-light github-dark"><code data-language="sql" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">String query </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;SELECT * FROM products&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre></figure>
</li>
<li>
<p>Query per selezionare un utente specifico basandosi sull’ID di sessione (omesso inizialmente, ora incluso):</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="sql" data-theme="github-light github-dark"><code data-language="sql" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">String query </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;SELECT * FROM users WHERE user = '&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> +</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> session</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">getAttribute</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;UserID&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;'&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre></figure>
</li>
</ol>
<h3 id="query-con-parametri">Query con Parametri<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#query-con-parametri" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>Le query parametrizzate sono una tecnica di prevenzione dell’iniezione SQL che separa nettamente i dati delle istruzioni SQL dalla logica di esecuzione delle query. In questo modo, i dati forniti dall’utente vengono gestiti in modo sicuro e non possono modificare la struttura logica della query.</p>
<p><strong>Esempio di Query Parametrizzata:</strong></p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="java" data-theme="github-light github-dark"><code data-language="java" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">String query </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;SELECT * FROM utenti WHERE cognome = ?&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">PreparedStatement statement </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> connection.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">prepareStatement</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(query);</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">statement.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">setString</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, nomeAccount);</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ResultSet results </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> statement.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">executeQuery</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span></code></pre></figure>
<p>In questo caso, <code>?</code> funge da segnaposto per il valore del parametro che viene impostato in modo sicuro attraverso <code>statement.setString(1, nomeAccount);</code>. Questo metodo garantisce che il valore passato venga sempre trattato come un dato, mai come parte del codice SQL.</p>
<h3 id="procedure-memorizzate">Procedure Memorizzate<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#procedure-memorizzate" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>Le procedure memorizzate possono offrire un livello di protezione dall’iniezione SQL, a condizione che non generino SQL dinamico all’interno della procedura stessa. Sono blocchi di codice eseguibili che risiedono nel database e che possono essere invocati dalle applicazioni.</p>
<p><strong>Considerazione Importante:</strong>
Le procedure memorizzate devono essere progettate con cura per non introdurre vulnerabilità attraverso l’uso di SQL dinamico, il quale potrebbe esporre a rischi simili a quelli delle query formulate direttamente nell’applicazione.</p>
<p>In sintesi, l’uso di query immutabili, parametrizzate e di procedure memorizzate sono tecniche fondamentali per proteggere le applicazioni web dall’iniezione SQL, assicurando che i dati forniti dall’utente siano gestiti in modo sicuro e che non sia possibile per gli aggressori alterare la logica delle query per accedere o manipolare dati sensibili in modo non autorizzato.</p>
<h2 id="procedure-memorizzate-1">Procedure memorizzate<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#procedure-memorizzate-1" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<p>La distinzione tra procedure memorizzate sicure e quelle vulnerabili a iniezioni SQL è fondamentale nella protezione dei database. Di seguito, analizzeremo due esempi specifici relativi a Microsoft SQL Server che illustrano questa differenza.</p>
<h3 id="procedure-memorizzate-sicure">Procedure Memorizzate Sicure<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#procedure-memorizzate-sicure" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>Una procedura memorizzata sicura è progettata in modo tale da evitare la possibilità di iniezione SQL, trattando i dati in ingresso esclusivamente come valori, senza permettere che questi possano influenzare la logica o la struttura della query SQL. Questo approccio impedisce agli attaccanti di inserire o modificare il codice SQL eseguito dal database. Un esempio di procedura memorizzata sicura in Microsoft SQL Server è:</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="sql" data-theme="github-light github-dark"><code data-language="sql" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">CREATE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> PROCEDURE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ListCustomers(@Country </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">nvarchar</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">30</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">AS</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">BEGIN</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> city, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">COUNT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> customers</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> country </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">LIKE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> @Country</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    GROUP BY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> city</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">END</span></span></code></pre></figure>
<p>Per eseguire questa procedura memorizzata, si utilizza il seguente comando, dove <code>'USA'</code> è il parametro che viene passato alla procedura:</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="sql" data-theme="github-light github-dark"><code data-language="sql" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">EXEC</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ListCustomers </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">'USA'</span></span></code></pre></figure>
<p>In questo esempio, il parametro <code>@Country</code> viene utilizzato direttamente nella query in modo sicuro, senza consentire l’interpretazione di eventuali input dannosi come parte del codice SQL.</p>
<h3 id="procedure-memorizzate-vulnerabili-a-iniezioni">Procedure Memorizzate Vulnerabili a Iniezioni<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#procedure-memorizzate-vulnerabili-a-iniezioni" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>Al contrario, una procedura memorizzata che genera SQL dinamico e incorpora direttamente i parametri forniti dagli utenti senza una corretta sanificazione o senza utilizzare approcci come le query parametrizzate, può essere vulnerabile alle iniezioni SQL. Questo tipo di procedura può eseguire accidentalmente codice SQL malevolo inserito tramite i parametri. Un esempio di procedura memorizzata vulnerabile a iniezioni SQL in Microsoft SQL Server è:</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="sql" data-theme="github-light github-dark"><code data-language="sql" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">CREATE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> PROCEDURE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> getUser(@lastName </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">nvarchar</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">25</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">AS</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">BEGIN</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    DECLARE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> @sql </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">nvarchar</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">255</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    SET</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> @sql </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 'SELECT * FROM users WHERE lastname = '''</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> +</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> @lastName </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ''''</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    EXEC</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sp_executesql @sql</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">END</span></span></code></pre></figure>
<p>In questo esempio, il parametro <code>@lastName</code> viene concatenato direttamente alla stringa SQL. Se un attaccante fornisce un valore per <code>@lastName</code> che include codice SQL malevolo, potrebbe eseguire operazioni non autorizzate sul database, come l’eliminazione di tabelle o l’estrazione di dati sensibili.</p>
<h2 id="validazione-e-sicurezza-del-nome-utente-con-query-parametrizzate-in-java">Validazione e Sicurezza del Nome Utente con Query Parametrizzate in Java<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#validazione-e-sicurezza-del-nome-utente-con-query-parametrizzate-in-java" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<p>L’utilizzo delle query parametrizzate rappresenta una tecnica essenziale per migliorare la sicurezza delle applicazioni che interagiscono con i database, specialmente per prevenire gli attacchi di iniezione SQL. Questo metodo consente di separare il codice SQL dalla gestione dei dati forniti dall’utente, riducendo i rischi di sicurezza associati.</p>
<h3 id="validazione-del-nome-utente">Validazione del Nome Utente<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#validazione-del-nome-utente" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>Per assicurarsi che il nome utente sia valido e per prevenire l’iniezione SQL, si può impiegare il seguente frammento di codice Java:</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="java" data-theme="github-light github-dark"><code data-language="java" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> static</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> boolean</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> isUsernameValid</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(String username) {</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    Regex r </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Regex</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;^[A-Za-z0-9]{16}$&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> r.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">isMatch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(username);</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// La connessione java.sql.Connection conn viene impostata altrove per brevità.</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">PreparedStatement ps </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> null</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ResultSet rs </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> null</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">try</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    String pUsername </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> request.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getParameter</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;UserName&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">isUsernameValid</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(pUsername)) {</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        ps </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> conn.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">prepareStatement</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;SELECT * FROM user_table WHERE username = ?&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        ps.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">setString</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, pUsername);</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        rs </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ps.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">executeQuery</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (rs.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">next</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()) {</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">            // Esegue il lavoro per rendere attivo il record dell'utente in qualche modo</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // Gestisce l'input non valido</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">} </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">catch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (Exception </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">e</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // Gestisce tutte le eccezioni</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></figure>
<h3 id="uso-corretto-delle-query-parametrizzate-per-linserimento-dei-dati">Uso Corretto delle Query Parametrizzate per l’Inserimento dei Dati<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#uso-corretto-delle-query-parametrizzate-per-linserimento-dei-dati" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>L’adozione di pratiche corrette nell’utilizzo delle query parametrizzate è fondamentale per prevenire vulnerabilità come l’iniezione SQL. È importante impostare i parametri con i metodi <code>ps.set...()</code> ed evitare la costruzione di stringhe SQL dinamiche basate sull’input dell’utente. Di seguito sono presentati esempi di uso non corretto e uso corretto per l’inserimento dei dati:</p>
<ul>
<li>
<p><strong>Uso non corretto</strong>: (Questo approccio va evitato poiché può esporre a vulnerabilità di sicurezza)</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="java" data-theme="github-light github-dark"><code data-language="java" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">String insertStatement </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> String.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">format</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;INSERT INTO USERS (id, name, email) VALUES (%s, %s, %s)&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;1&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;webgoat&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;webgoat@owasp.org&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">PreparedStatement statement </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> conn.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">prepareStatement</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(insertStatement);</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">statement.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">executeUpdate</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span></code></pre></figure>
</li>
<li>
<p><strong>Uso corretto</strong>: (Questo è l’approccio consigliato per mantenere l’integrità e la sicurezza dei dati)</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="java" data-theme="github-light github-dark"><code data-language="java" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">PreparedStatement statement </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> conn.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">prepareStatement</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;INSERT INTO USERS (id, name, email) VALUES (?, ?, ?)&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">statement.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">setString</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;1&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">statement.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">setString</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;webgoat&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">statement.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">setString</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;webgoat@owasp.org&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">statement.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">executeUpdate</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span></code></pre></figure>
</li>
</ul>
<p>Seguendo le migliori pratiche per la validazione dell’input e l’uso appropriato dei PreparedStatement, gli sviluppatori possono efficacemente mitigare i rischi di iniezione SQL e migliorare la sicurezza delle loro applicazioni.</p>
<h2 id="esempio-di-query-parametrizzata-in-java">Esempio di Query Parametrizzata in Java<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#esempio-di-query-parametrizzata-in-java" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<p>Questo esempio illustra l’uso delle query parametrizzate in Java per migliorare la sicurezza e l’efficienza nella gestione dei dati di un database. Le query parametrizzate sono fondamentali per prevenire attacchi di iniezione SQL, garantendo che i dati forniti dagli utenti siano trattati in modo sicuro.</p>
<h3 id="descrizione-del-codice">Descrizione del Codice<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#descrizione-del-codice" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>Il seguente frammento di codice dimostra come caricare dati relativi a un account utilizzando una query parametrizzata:</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="java" data-theme="github-light github-dark"><code data-language="java" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> static</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> String </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">loadAccount</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // Il parser ritorna solo dati stringa validi</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  String accountID </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> getParser</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">().</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getStringParameter</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ACCT_ID, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  String data </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> null</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  String query </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;SELECT first_name, last_name, acct_id, balance FROM user_data WHERE acct_id = ?&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  try</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (Connection connection </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> dataSource.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getConnection</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">       PreparedStatement statement </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> connection.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">prepareStatement</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(query)) {</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">     statement.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">setString</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, accountID);</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">     ResultSet results </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> statement.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">executeQuery</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">     if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (results </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> null</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &amp;&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> results.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">first</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()) {</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">       results.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">last</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(); </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Dovrebbe essere restituito solo un record per questa query</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">       if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (results.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getRow</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">         data </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> processAccount</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(results);</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">       } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">         // Gestione dell'errore - Problema di integrità del database</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">       }</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">     } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">       // Gestione dell'errore - nessun record trovato</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">     }</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">catch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (SQLException </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">sqle</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // Log e gestione dell'SQL Exception</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> data;</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></figure>
<h3 id="spiegazione-del-processo">Spiegazione del Processo<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#spiegazione-del-processo" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<ol>
<li>
<p><strong>Validazione dell’Input:</strong> Prima di tutto, il codice assicura che l’ID dell’account fornito sia un dato valido tramite un metodo di parsing. Questo passaggio è cruciale per evitare iniezioni SQL.</p>
</li>
<li>
<p><strong>Preparazione della Query:</strong> La query SQL è definita con un placeholder (<code>?</code>) per l’ID dell’account. Questo metodo impedisce l’esecuzione di codice SQL malevolo.</p>
</li>
<li>
<p><strong>Impostazione dei Parametri:</strong> Il valore dell’ID dell’account è impostato come parametro della query tramite <code>statement.setString(1, accountID)</code>. Questo approccio mantiene separati il codice SQL e i dati forniti dall’utente.</p>
</li>
<li>
<p><strong>Esecuzione della Query e Gestione dei Risultati:</strong> La query viene eseguita e, se trovato, il record dell’account viene processato. Il codice gestisce anche le situazioni in cui non vengono trovati record o si verifica un problema di integrità del database.</p>
</li>
<li>
<p><strong>Gestione delle Eccezioni:</strong> Infine, le eccezioni SQL sono catturate e gestite adeguatamente, permettendo al programma di reagire in modo appropriato agli errori di connessione o esecuzione della query.</p>
</li>
</ol>
<p>L’uso delle query parametrizzate, come mostrato in questo esempio, è essenziale per costruire applicazioni sicure che interagiscono con database, riducendo il rischio di vulnerabilità legate all’iniezione SQL e garantendo l’integrità dei dati.</p>
<h2 id="esercizio-1-1">Esercizio 1<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#esercizio-1-1" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<p>Per completare il codice in modo sicuro ed efficiente, prevenendo vulnerabilità come le iniezioni SQL, utilizzeremo l’approccio delle query parametrizzate. Questo metodo consente di inserire i valori delle variabili in modo sicuro, senza il rischio che input dannosi possano essere interpretati come parte del codice SQL. Di seguito, il codice completato con l’utilizzo di <code>PreparedStatement</code>, una classe che facilita l’uso di query parametrizzate in Java.</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="java" data-theme="github-light github-dark"><code data-language="java" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Assumiamo che DBURL, DBUSER, e DBPW siano definiti altrove nel codice.</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Connection conn </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> DriverManager.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getConnection</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(DBURL, DBUSER, DBPW);</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Preparazione della query SQL con parametri.</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">String sql </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;SELECT status FROM users WHERE name=? AND mail=?&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">PreparedStatement statement </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> conn.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">prepareStatement</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(sql);</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Assumiamo che 'userName' e 'userMail' siano le variabili che contengono</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// i valori per il nome e l'indirizzo mail dell'utente.</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Si deve prestare attenzione a sanificare questi input se provengono dall'esterno.</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">statement.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">setString</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, userName);</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">statement.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">setString</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, userMail);</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Esecuzione della query.</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ResultSet resultSet </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> statement.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">executeQuery</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Processamento dei risultati.</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (resultSet.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">next</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()) {</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    String status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> resultSet.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getString</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;status&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // Qui si può gestire lo stato dell'utente come necessario.</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">} </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // Gestione del caso in cui non vengono trovati record corrispondenti.</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Si ricorda di chiudere le risorse una volta che non sono più necessarie</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// per evitare leak di memoria. Questo può essere fatto automaticamente</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// usando il try-with-resources o manualmente nel blocco finally.</span></span></code></pre></figure>
<h3 id="spiegazioni-importanti">Spiegazioni Importanti:<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#spiegazioni-importanti" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<ul>
<li>
<p><strong>Creazione della Connessione:</strong> Utilizziamo <code>DriverManager.getConnection</code> con i parametri appropriati (<code>DBURL</code>, <code>DBUSER</code>, <code>DBPW</code>) per stabilire una connessione al database.</p>
</li>
<li>
<p><strong>Preparazione della Query:</strong> Definiamo una stringa SQL con dei placeholder (<code>?</code>) per i parametri che vogliamo inserire in modo sicuro. Successivamente, creiamo un <code>PreparedStatement</code> a partire da questa stringa.</p>
</li>
<li>
<p><strong>Impostazione dei Parametri:</strong> Con <code>statement.setString(index, value)</code>, impostiamo i valori di <code>userName</code> e <code>userMail</code> nei posti corretti all’interno della query. Questo passaggio previene le iniezioni SQL poiché i valori sono trattati esclusivamente come dati, senza essere interpretati come parte del comando SQL.</p>
</li>
<li>
<p><strong>Esecuzione e Gestione dei Risultati:</strong> Eseguiamo la query con <code>statement.executeQuery()</code> e processiamo i risultati ottenuti. È importante gestire anche il caso in cui non si ottengano risultati.</p>
</li>
<li>
<p><strong>Gestione delle Risorse:</strong> È buona pratica assicurarsi che tutte le risorse utilizzate (come oggetti <code>Connection</code>, <code>PreparedStatement</code> e <code>ResultSet</code>) siano chiuse dopo il loro uso per evitare perdite di risorse. Nel codice sopra, questo aspetto va gestito adeguatamente nel contesto dell’applicazione.</p>
</li>
</ul>
<p>Questo approccio garantisce che l’applicazione sia protetta da attacchi di iniezione SQL, mantenendo al contempo una struttura di codice chiara e manutenibile.</p>
<h2 id="query-parametrizzate-in-net">Query Parametrizzate in .NET<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#query-parametrizzate-in-net" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<p>Nell’esempio fornito, viene dimostrato come utilizzare le query parametrizzate in un contesto .NET per accedere ai dati in modo sicuro, prevenendo attacchi di iniezione SQL. Questo approccio è essenziale per proteggere le applicazioni .NET che interagiscono con database SQL.</p>
<h3 id="descrizione-del-codice-1">Descrizione del Codice<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#descrizione-del-codice-1" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>Il codice verifica prima la validità del nome utente utilizzando una espressione regolare. Successivamente, prepara e esegue una query SQL parametrizzata per selezionare i dati dall’utente specificato. Qui di seguito è riportato il codice corretto e leggermente modificato per migliorarne la leggibilità e la correttezza sintattica:</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="csharp" data-theme="github-light github-dark"><code data-language="csharp" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> static</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> bool</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> IsUsernameValid</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">string</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> username</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    Regex</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> r</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Regex</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;^[A-Za-z0-9]{1,16}$&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Modifica per consentire nomi utente fino a 16 caratteri</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> r.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">IsMatch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(username); </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Corretto in IsMatch</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// SqlConnection conn è impostata e aperta altrove per brevità.</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">try</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    string</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> selectString</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;SELECT * FROM user_table WHERE username = @userID&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    SqlCommand</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> cmd</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> SqlCommand</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(selectString, conn);</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    string</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> uid</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;someUsername&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Assumiamo che uid sia il nome utente da verificare</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">IsUsernameValid</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(uid)) {</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        cmd.Parameters.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Add</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;@userID&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, SqlDbType.VarChar, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">16</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">).Value </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> uid;</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        using</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">SqlDataReader</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> myReader</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> cmd.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ExecuteReader</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()) {</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">            if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (myReader.HasRows) {</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                // Rendi il record dell'utente attivo in qualche modo.</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            }</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            myReader.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Close</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // Gestisci input non valido</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">catch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Exception</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> e</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // Gestisci tutte le eccezioni...</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></figure>
<h3 id="punti-chiave">Punti Chiave<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#punti-chiave" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<ul>
<li>
<p><strong>Validazione dell’input</strong>: Prima di eseguire la query, il nome utente viene validato utilizzando un’espressione regolare. Questo aiuta a prevenire attacchi di iniezione basati su input non validi.</p>
</li>
<li>
<p><strong>Uso di query parametrizzate</strong>: La query SQL utilizza un parametro (<code>@userID</code>) al posto di concatenare direttamente il nome utente nella stringa di query. Questo parametro viene poi valorizzato con il nome utente validato, prevenendo così efficacemente l’iniezione SQL.</p>
</li>
<li>
<p><strong>Gestione delle risorse</strong>: L’uso della parola chiave <code>using</code> assicura che l’oggetto <code>SqlDataReader</code> venga chiuso e rilasciato correttamente, anche in caso di eccezioni.</p>
</li>
<li>
<p><strong>Gestione delle eccezioni</strong>: Tutte le potenziali eccezioni generate durante l’esecuzione della query o la connessione al database sono catturate e possono essere gestite in modo appropriato.</p>
</li>
</ul>
<p>Questo esempio illustra come scrivere codice sicuro e robusto per operazioni di database in un’applicazione .NET, utilizzando pratiche consigliate come la validazione dell’input e le query parametrizzate.</p>
<h2 id="necessità-della-validazione-degli-input">Necessità della Validazione degli Input<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#necessità-della-validazione-degli-input" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<p>Anche se le tue query sono protette contro le iniezioni SQL grazie all’uso di query parametrizzate, la validazione degli input rimane una pratica essenziale nella sicurezza informatica. La validazione degli input serve non solo a prevenire iniezioni SQL, ma anche a proteggere l’applicazione da una varietà di altre vulnerabilità e attacchi. Di seguito, alcuni motivi per cui è importante continuare a validare gli input:</p>
<h3 id="prevenzione-di-altri-tipi-di-attacchi">Prevenzione di Altri Tipi di Attacchi<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#prevenzione-di-altri-tipi-di-attacchi" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<ul>
<li>
<p><strong>Stored XSS (Cross-Site Scripting):</strong> Senza una valida sanificazione e validazione degli input, un attaccante potrebbe inserire script dannosi nel database, che poi vengono eseguiti nel browser dell’utente quando i dati vengono visualizzati. La validazione degli input aiuta a prevenire l’inserimento di questi script.</p>
</li>
<li>
<p><strong>Fuga di Informazioni:</strong> Input non validati potrebbero essere usati per esfiltrare dati sensibili dall’applicazione o dal sistema sottostante. Ad esempio, un input malevolo potrebbe essere progettato per rivelare informazioni sulla struttura del database o sui dati degli utenti.</p>
</li>
</ul>
<h3 id="mantenimento-dellintegrità-logica-e-dei-dati">Mantenimento dell’Integrità Logica e dei Dati<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#mantenimento-dellintegrità-logica-e-dei-dati" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<ul>
<li>
<p><strong>Errori Logici e Validazione delle Regole di Business:</strong> La validazione degli input è fondamentale per assicurarsi che i dati inseriti nell’applicazione rispettino le regole di business e la logica applicativa. Ad esempio, un campo che dovrebbe accettare solo valori numerici potrebbe causare errori logici o di calcolo se vengono inseriti testi o caratteri speciali.</p>
</li>
<li>
<p><strong>Iniezione SQL:</strong> Sebbene le query parametrizzate siano una difesa efficace contro l’iniezione SQL, la validazione degli input fornisce un ulteriore livello di sicurezza. Inoltre, in alcune situazioni particolari o con configurazioni specifiche del database, potrebbero esistere ancora vettori per iniezioni SQL che la validazione degli input può contribuire a mitigare.</p>
</li>
</ul>
<h3 id="considerazione-del-database-come-entità-fiduciaria">Considerazione del Database Come Entità Fiduciaria<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#considerazione-del-database-come-entità-fiduciaria" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>Spesso il database viene considerato una parte fiduciaria del sistema. Ciò significa che i dati al suo interno si presume siano accurati, validi e sicuri. La validazione degli input contribuisce a mantenere questa fiducia, assicurando che solo dati validi e previsti siano inseriti nel database. Questo approccio protegge non solo l’applicazione ma anche l’integrità dei dati e la fiducia degli utenti.</p>
<h2 id="validazione-degli-input-un-primo-passo-necessario-ma-non-sufficiente">Validazione degli Input: Un Primo Passo Necessario ma Non Sufficiente<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#validazione-degli-input-un-primo-passo-necessario-ma-non-sufficiente" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<p>La validazione degli input è un passo critico per garantire che solo dati corretti e attesi siano accettati dall’applicazione. Questo può includere la verifica che un numero telefonico contenga solo cifre, che un indirizzo email segua il formato standard, o che una stringa di testo non contenga caratteri speciali potenzialmente pericolosi. Tuttavia, anche la più robusta validazione degli input può essere aggirata o può fallire in scenari non previsti.</p>
<p>Ad esempio, un filtro che permette solo lettere e numeri per evitare iniezioni SQL potrebbe essere considerato sicuro. Tuttavia, se la logica di validazione non tiene conto di tutti i contesti possibili o di tecniche di attacco innovative, potrebbero esserci delle lacune. Un attaccante potrebbe scoprire un modo per sfruttare un input apparentemente innocuo che passa la validazione ma che, a causa di particolari condizioni o vulnerabilità del sistema sottostante, porta a un’iniezione SQL o ad altri attacchi.</p>
<h3 id="limportanza-delle-query-parametrizzate">L’Importanza delle Query Parametrizzate<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#limportanza-delle-query-parametrizzate" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>Le query parametrizzate risolvono il problema alla radice trattando i dati di input separatamente dal codice SQL. Con le query parametrizzate, l’input dell’utente viene sempre trattato come dati, mai come parte del codice SQL, indipendentemente dalla sua forma. Questo elimina la possibilità che l’input venga interpretato in modo errato come istruzione SQL dal database, prevenendo così le iniezioni SQL.</p>
<h3 id="debolezze-dellapproccio-di-solo-filtraggio">Debolezze dell’Approccio di Solo Filtraggio<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#debolezze-dellapproccio-di-solo-filtraggio" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>Affidarsi esclusivamente alla validazione o al filtraggio degli input per prevenire le iniezioni SQL presenta diverse debolezze:</p>
<ul>
<li>
<p><strong>Complessità del Filtraggio:</strong> Determinare un set completo di regole di validazione che copra tutti i possibili vettori di attacco può essere estremamente complesso e soggetto a errori.</p>
</li>
<li>
<p><strong>Variabilità degli Ambienti di Esecuzione:</strong> Differenze nell’interpretazione dei comandi SQL tra diversi sistemi di gestione del database possono rendere alcuni filtri inefficaci in specifici contesti.</p>
</li>
<li>
<p><strong>Evoluzione delle Tecniche di Attacco:</strong> Gli attaccanti sviluppano continuamente nuove tecniche per aggirare i filtri esistenti. Senza un aggiornamento costante, i filtri possono diventare obsoleti.</p>
</li>
</ul>
<p>Nell’esercizio mostrato, è presente un filtro che non permette all’utente di inserire degli spazi. Tuttavia questo filtro è facilmente bypassabile utilizzando dei commenti al posto degli spazi:</p>
<pre><code>a'/**/union/**/select/**/user_system_data.*,'1','1',1/**/from/**/user_system_data;--
</code></pre>
<p>Nell’esercizio successivo, si nota che il form rimuove le parole chiave select e from. Tuttavia, si può ingannare l’algoritmo scrivendo la parola select dentro select, in modo tale che una volta che quello interno viene eliminato dal filtro, rimane quello esterno:</p>
<pre><code>/**/ &lt;-- HSQLDB comment instead of white space  
selselectect &lt;-- instead of 'select'  
frfromom &lt;-- instead of 'from'
</code></pre>
<h2 id="protezione-dalle-iniezioni-sql-e-uso-delle-query-parametrizzate-nella-clausola-order-by">Protezione dalle Iniezioni SQL e Uso delle Query Parametrizzate nella Clausola ORDER BY<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#protezione-dalle-iniezioni-sql-e-uso-delle-query-parametrizzate-nella-clausola-order-by" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<p>Le iniezioni SQL rappresentano una minaccia significativa per la sicurezza delle applicazioni web, permettendo agli aggressori di manipolare le query SQL per accedere o alterare i dati in modi non autorizzati. Una domanda comune riguarda l’efficacia delle query parametrizzate nel prevenire queste iniezioni, specialmente in contesti come l’uso dinamico della clausola <code>ORDER BY</code>.</p>
<h3 id="il-problema-con-la-clausola-order-by">Il Problema con la Clausola ORDER BY<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#il-problema-con-la-clausola-order-by" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>Consideriamo il seguente esempio di codice SQL, dove il nome della colonna di ordinamento (<code>sortColumnName</code>) viene inserito direttamente nella query:</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="sql" data-theme="github-light github-dark"><code data-language="sql" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;SELECT * FROM users ORDER BY &quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> +</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sortColumnName </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;;&quot;</span></span></code></pre></figure>
<p>A prima vista, potrebbe sembrare che l’uso di query parametrizzate possa prevenire efficacemente le iniezioni SQL in casi come questo. Tuttavia, la specifica grammaticale SQL mostra che una <code>orderExpression</code> nella clausola <code>ORDER BY</code> può essere molto più di un semplice nome di colonna; può essere un’espressione complessa, inclusa una funzione. Ciò significa che, attraverso un’espressione ingegnosa, un attaccante potrebbe inserire logica condizionale o altre funzioni SQL che potrebbero essere sfruttate per scopi malevoli.</p>
<h3 id="esempio-di-iniezione-nella-clausola-order-by">Esempio di Iniezione nella Clausola ORDER BY<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#esempio-di-iniezione-nella-clausola-order-by" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="sql" data-theme="github-light github-dark"><code data-language="sql" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> users </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ORDER BY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">CASE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> WHEN</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (TRUE) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">THEN</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> lastname </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ELSE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> firstname </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">END</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre></figure>
<p>In questo esempio, l’iniezione tramite la clausola <code>ORDER BY</code> sfrutta la capacità di SQL di eseguire espressioni condizionali. Anche se il nome della colonna viene parametrizzato, un attaccante potrebbe tentare di inserire espressioni o funzioni complesse che non sono intese per l’uso previsto della query.</p>
<h3 id="misure-di-mitigazione">Misure di Mitigazione<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#misure-di-mitigazione" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>Per mitigare i rischi associati alle iniezioni tramite la clausola <code>ORDER BY</code>, si consiglia di adottare un approccio basato su una lista di controllo (whitelist) per i nomi delle colonne consentite per l’ordinamento. Ecco alcune linee guida:</p>
<ul>
<li>
<p><strong>Implementare una Lista di Controllo:</strong> Prima di costruire la query SQL, verificare che il nome della colonna fornito per l’ordinamento corrisponda a uno dei valori consentiti definiti in una lista di controllo. Questo limita l’ordinamento alle colonne predefinite come ‘firstname’ o ‘lastname’, riducendo il rischio di manipolazioni non autorizzate della query.</p>
</li>
<li>
<p><strong>Evitare l’Inserimento Diretto:</strong> Non inserire mai direttamente input dell’utente nella query SQL senza una validazione adeguata. Anche quando si utilizzano query parametrizzate, è essenziale assicurarsi che ogni parte dinamica della query sia rigorosamente controllata.</p>
</li>
<li>
<p><strong>Validazione e Sanificazione dell’Input:</strong> Oltre all’uso di una lista di controllo, è utile implementare una robusta logica di validazione e sanificazione per qualsiasi input che influenzi la logica SQL, compresi i nomi delle colonne e i valori di ordinamento.</p>
</li>
</ul>
<h2 id="principio-del-minimo-privilegio-nelle-connessioni-al-database">Principio del Minimo Privilegio nelle Connessioni al Database<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#principio-del-minimo-privilegio-nelle-connessioni-al-database" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<p>Il principio del minimo privilegio è una pratica di sicurezza essenziale nella gestione degli accessi alle risorse informatiche, inclusi i database. Questo principio implica che un account, un programma o un processo operativo dovrebbe avere esclusivamente le autorizzazioni necessarie per svolgere i suoi compiti, niente di più. Nel contesto di un’applicazione che si connette a un database, l’implementazione di questo principio può significativamente ridurre il rischio di danni accidentali o malevoli, limitando le potenziali azioni che possono essere eseguite.</p>
<h3 id="connessione-con-set-minimo-di-privilegi">Connessione con Set Minimo di Privilegi<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#connessione-con-set-minimo-di-privilegi" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<h4 id="distinzione-di-fiducia-e-credenziali-differenziate">Distinzione di Fiducia e Credenziali Differenziate<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#distinzione-di-fiducia-e-credenziali-differenziate" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<ul>
<li><strong>Credenziali Differenziate:</strong> L’applicazione dovrebbe stabilire connessioni al database utilizzando credenziali diverse a seconda del livello di fiducia e delle esigenze specifiche di accesso. Questo approccio implica la creazione di account di database separati per differenti contesti operativi, ad esempio, per lettura, scrittura o esecuzione di procedure memorizzate.</li>
</ul>
<h4 id="limitazione-dei-diritti-di-eliminazione">Limitazione dei Diritti di Eliminazione<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#limitazione-dei-diritti-di-eliminazione" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<ul>
<li><strong>Diritti Limitati:</strong> È raro che un’applicazione necessiti di diritti di eliminazione su una tabella o su un database intero. Limitare i permessi ai soli necessari riduce il rischio di perdita di dati accidentale o di attacchi che mirano a danneggiare o compromettere l’integrità del database.</li>
</ul>
<h3 id="gestione-degli-accessi-allo-schema">Gestione degli Accessi allo Schema<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#gestione-degli-accessi-allo-schema" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<ul>
<li><strong>Accesso Limitato allo Schema:</strong> Gli account di database dovrebbero avere accesso limitato agli schemi di cui necessitano. Questo limita l’esposizione e il rischio in caso di compromissione delle credenziali.</li>
</ul>
<h3 id="account-di-database-per-accesso-in-lettura-e-scrittura">Account di Database per Accesso in Lettura e Scrittura<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#account-di-database-per-accesso-in-lettura-e-scrittura" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<ul>
<li><strong>Definizione di Account Specifici:</strong> Creare account di database dedicati per l’accesso in lettura e per l’accesso in lettura/scrittura. Questa distinzione garantisce che le operazioni di modifica dei dati siano consentite solo attraverso le credenziali appropriate.</li>
</ul>
<h3 id="pool-di-connessione-basati-sullaccesso">Pool di Connessione Basati sull’Accesso<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#pool-di-connessione-basati-sullaccesso" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<ul>
<li>
<p><strong>Pool di Connessione Differenziati:</strong> Utilizzare pool di connessione multipli basati sul tipo di accesso richiesto. Questo consente all’applicazione di stabilire connessioni con il livello di privilegio adeguato in base all’operazione da eseguire, ad esempio:</p>
<ul>
<li>
<p><strong>Accesso in Sola Lettura:</strong> per le query di autenticazione o per la lettura di dati, dove non sono necessarie modifiche al database.</p>
</li>
<li>
<p><strong>Accesso in Lettura/Scrittura:</strong> per le query che necessitano di modificare i dati, come gli aggiornamenti o le inserzioni.</p>
</li>
<li>
<p><strong>Accesso per l’Esecuzione di Procedure Memorizzate:</strong> quando si richiama una procedura memorizzata, utilizzare credenziali che limitano l’account al solo diritto di esecuzione per quella specifica procedura.</p>
</li>
</ul>
</li>
</ul></article><hr/><div class="page-footer"></div></div><div class="right sidebar"><div class="graph"><h3>Graph View</h3><div class="graph-outer"><div class="graph-container" data-cfg="{&quot;drag&quot;:true,&quot;zoom&quot;:true,&quot;depth&quot;:1,&quot;scale&quot;:1.1,&quot;repelForce&quot;:0.5,&quot;centerForce&quot;:0.3,&quot;linkDistance&quot;:30,&quot;fontSize&quot;:0.6,&quot;opacityScale&quot;:1,&quot;showTags&quot;:true,&quot;removeTags&quot;:[],&quot;focusOnHover&quot;:false,&quot;enableRadial&quot;:false}"></div><button class="global-graph-icon" aria-label="Global Graph"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 55 55" fill="currentColor" xml:space="preserve"><path d="M49,0c-3.309,0-6,2.691-6,6c0,1.035,0.263,2.009,0.726,2.86l-9.829,9.829C32.542,17.634,30.846,17,29,17
                s-3.542,0.634-4.898,1.688l-7.669-7.669C16.785,10.424,17,9.74,17,9c0-2.206-1.794-4-4-4S9,6.794,9,9s1.794,4,4,4
                c0.74,0,1.424-0.215,2.019-0.567l7.669,7.669C21.634,21.458,21,23.154,21,25s0.634,3.542,1.688,4.897L10.024,42.562
                C8.958,41.595,7.549,41,6,41c-3.309,0-6,2.691-6,6s2.691,6,6,6s6-2.691,6-6c0-1.035-0.263-2.009-0.726-2.86l12.829-12.829
                c1.106,0.86,2.44,1.436,3.898,1.619v10.16c-2.833,0.478-5,2.942-5,5.91c0,3.309,2.691,6,6,6s6-2.691,6-6c0-2.967-2.167-5.431-5-5.91
                v-10.16c1.458-0.183,2.792-0.759,3.898-1.619l7.669,7.669C41.215,39.576,41,40.26,41,41c0,2.206,1.794,4,4,4s4-1.794,4-4
                s-1.794-4-4-4c-0.74,0-1.424,0.215-2.019,0.567l-7.669-7.669C36.366,28.542,37,26.846,37,25s-0.634-3.542-1.688-4.897l9.665-9.665
                C46.042,11.405,47.451,12,49,12c3.309,0,6-2.691,6-6S52.309,0,49,0z M11,9c0-1.103,0.897-2,2-2s2,0.897,2,2s-0.897,2-2,2
                S11,10.103,11,9z M6,51c-2.206,0-4-1.794-4-4s1.794-4,4-4s4,1.794,4,4S8.206,51,6,51z M33,49c0,2.206-1.794,4-4,4s-4-1.794-4-4
                s1.794-4,4-4S33,46.794,33,49z M29,31c-3.309,0-6-2.691-6-6s2.691-6,6-6s6,2.691,6,6S32.309,31,29,31z M47,41c0,1.103-0.897,2-2,2
                s-2-0.897-2-2s0.897-2,2-2S47,39.897,47,41z M49,10c-2.206,0-4-1.794-4-4s1.794-4,4-4s4,1.794,4,4S51.206,10,49,10z"></path></svg></button></div><div class="global-graph-outer"><div class="global-graph-container" data-cfg="{&quot;drag&quot;:true,&quot;zoom&quot;:true,&quot;depth&quot;:-1,&quot;scale&quot;:0.9,&quot;repelForce&quot;:0.5,&quot;centerForce&quot;:0.2,&quot;linkDistance&quot;:30,&quot;fontSize&quot;:0.6,&quot;opacityScale&quot;:1,&quot;showTags&quot;:true,&quot;removeTags&quot;:[],&quot;focusOnHover&quot;:true,&quot;enableRadial&quot;:true}"></div></div></div><div class="toc desktop-only"><button type="button" class="toc-header" aria-controls="toc-17" aria-expanded="true"><h3>Table of Contents</h3><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="fold"><polyline points="6 9 12 15 18 9"></polyline></svg></button><ul id="list-1" class="toc-content overflow"><li class="depth-1"><a href="#introduzione-al-sql-structured-query-language" data-for="introduzione-al-sql-structured-query-language">Introduzione al SQL (Structured Query Language)</a></li><li class="depth-2"><a href="#concetti-fondamentali-di-sql" data-for="concetti-fondamentali-di-sql">Concetti Fondamentali di SQL</a></li><li class="depth-1"><a href="#comprensione-dellsql-injection" data-for="comprensione-dellsql-injection">Comprensione dell’SQL injection</a></li><li class="depth-2"><a href="#tipi-di-sql-injection" data-for="tipi-di-sql-injection">Tipi di SQL injection</a></li><li class="depth-2"><a href="#sql-injection-e-la-triade-cia" data-for="sql-injection-e-la-triade-cia">SQL injection e la Triade CIA</a></li><li class="depth-0"><a href="#struttura-di-base-e-select" data-for="struttura-di-base-e-select">Struttura di base e select</a></li><li class="depth-2"><a href="#esempio-di-tavola-sql" data-for="esempio-di-tavola-sql">Esempio di Tavola SQL</a></li><li class="depth-2"><a href="#categorie-principali-di-comandi-sql" data-for="categorie-principali-di-comandi-sql">Categorie Principali di Comandi SQL</a></li><li class="depth-1"><a href="#esercizio" data-for="esercizio">Esercizio</a></li><li class="depth-2"><a href="#struttura-della-tavola-employees" data-for="struttura-della-tavola-employees">Struttura della Tavola employees</a></li><li class="depth-2"><a href="#esercizio-1" data-for="esercizio-1">Esercizio</a></li><li class="depth-2"><a href="#query-sql-esemplificativa" data-for="query-sql-esemplificativa">Query SQL Esemplificativa</a></li><li class="depth-2"><a href="#risultato-atteso" data-for="risultato-atteso">Risultato Atteso</a></li><li class="depth-2"><a href="#conclusioni" data-for="conclusioni">Conclusioni</a></li><li class="depth-0"><a href="#data-manipulation-language-dml" data-for="data-manipulation-language-dml">Data Manipulation Language (DML)</a></li><li class="depth-2"><a href="#esercizio-pratico-modifica-del-dipartimento" data-for="esercizio-pratico-modifica-del-dipartimento">Esercizio Pratico: Modifica del Dipartimento</a></li><li class="depth-2"><a href="#riflessione-sulla-sicurezza" data-for="riflessione-sulla-sicurezza">Riflessione sulla Sicurezza</a></li><li class="depth-0"><a href="#ddl-data-definition-language" data-for="ddl-data-definition-language">DDL (Data Definition Language)</a></li><li class="depth-2"><a href="#comandi-ddl-principali" data-for="comandi-ddl-principali">Comandi DDL Principali</a></li><li class="depth-2"><a href="#esempio-creazione-di-una-tabella" data-for="esempio-creazione-di-una-tabella">Esempio: Creazione di una Tabella</a></li><li class="depth-2"><a href="#rischi-per-la-sicurezza-con-ddl" data-for="rischi-per-la-sicurezza-con-ddl">Rischi per la Sicurezza con DDL</a></li><li class="depth-2"><a href="#esercizio-pratico-modifica-dello-schema" data-for="esercizio-pratico-modifica-dello-schema">Esercizio Pratico: Modifica dello Schema</a></li><li class="depth-0"><a href="#dcl-data-control-language" data-for="dcl-data-control-language">DCL (Data Control Language)</a></li><li class="depth-2"><a href="#comandi-principali-dcl" data-for="comandi-principali-dcl">Comandi Principali DCL</a></li><li class="depth-2"><a href="#rischi-per-la-sicurezza-con-dcl" data-for="rischi-per-la-sicurezza-con-dcl">Rischi per la Sicurezza con DCL</a></li><li class="depth-2"><a href="#esercizio-pratico-concessione-dei-diritti" data-for="esercizio-pratico-concessione-dei-diritti">Esercizio Pratico: Concessione dei Diritti</a></li><li class="depth-0"><a href="#sql-injection" data-for="sql-injection">SQL Injection</a></li><li class="depth-2"><a href="#esempi-di-iniezione-sql" data-for="esempi-di-iniezione-sql">Esempi di Iniezione SQL</a></li><li class="depth-2"><a href="#impatto-delliniezione-sql" data-for="impatto-delliniezione-sql">Impatto dell’Iniezione SQL</a></li><li class="depth-2"><a href="#prevenzione-delliniezione-sql" data-for="prevenzione-delliniezione-sql">Prevenzione dell’Iniezione SQL</a></li><li class="depth-2"><a href="#lettura-e-modifica-di-dati-sensibili" data-for="lettura-e-modifica-di-dati-sensibili">Lettura e Modifica di Dati Sensibili</a></li><li class="depth-2"><a href="#esecuzione-di-operazioni-amministrative-sul-database" data-for="esecuzione-di-operazioni-amministrative-sul-database">Esecuzione di Operazioni Amministrative sul Database</a></li><li class="depth-2"><a href="#recupero-del-contenuto-di-file-presenti-nel-file-system-del-dbms" data-for="recupero-del-contenuto-di-file-presenti-nel-file-system-del-dbms">Recupero del Contenuto di File Presenti nel File System del DBMS</a></li><li class="depth-2"><a href="#emissione-di-comandi-al-sistema-operativo" data-for="emissione-di-comandi-al-sistema-operativo">Emissione di Comandi al Sistema Operativo</a></li><li class="depth-2"><a href="#conseguenze-delliniezione-sql-sugli-obiettivi-di-sicurezza" data-for="conseguenze-delliniezione-sql-sugli-obiettivi-di-sicurezza">Conseguenze dell’Iniezione SQL sugli Obiettivi di Sicurezza</a></li><li class="depth-2"><a href="#abilità-e-immaginazione-dellattaccante" data-for="abilità-e-immaginazione-dellattaccante">Abilità e Immaginazione dell’Attaccante</a></li><li class="depth-2"><a href="#misure-di-difesa-stratificate" data-for="misure-di-difesa-stratificate">Misure di Difesa Stratificate</a></li><li class="depth-2"><a href="#tecnologia-del-database" data-for="tecnologia-del-database">Tecnologia del Database</a></li><li class="depth-2"><a href="#linguaggi-di-programmazione" data-for="linguaggi-di-programmazione">Linguaggi di Programmazione</a></li><li class="depth-2"><a href="#specificità-dei-database" data-for="specificità-dei-database">Specificità dei Database</a></li><li class="depth-2"><a href="#conclusione" data-for="conclusione">Conclusione</a></li><li class="depth-1"><a href="#string-sql-injection" data-for="string-sql-injection">String SQL Injection</a></li><li class="depth-2"><a href="#esercizio-iniezione-sql-di-tipo-stringa" data-for="esercizio-iniezione-sql-di-tipo-stringa">Esercizio: Iniezione SQL di Tipo Stringa</a></li><li class="depth-2"><a href="#discussione" data-for="discussione">Discussione:</a></li><li class="depth-1"><a href="#numeric-sql-injection" data-for="numeric-sql-injection">Numeric SQL Injection</a></li><li class="depth-0"><a href="#sql-injection-per-compromettere-la-triade-cia" data-for="sql-injection-per-compromettere-la-triade-cia">SQL Injection per compromettere la triade CIA</a></li><li class="depth-1"><a href="#confidentiality-c-compromissione-della-riservatezza-tramite-iniezione-sql-di-tipo-stringa" data-for="confidentiality-c-compromissione-della-riservatezza-tramite-iniezione-sql-di-tipo-stringa">Confidentiality (C): Compromissione della Riservatezza tramite Iniezione SQL di Tipo Stringa</a></li><li class="depth-2"><a href="#integrity-i-compromissione-dellintegrità-tramite-query-chaining" data-for="integrity-i-compromissione-dellintegrità-tramite-query-chaining">Integrity (I): Compromissione dell’Integrità tramite Query Chaining</a></li><li class="depth-2"><a href="#availability-a-compromissione-della-disponibilità-tramite-iniezione-sql" data-for="availability-a-compromissione-della-disponibilità-tramite-iniezione-sql">Availability (A): Compromissione della Disponibilità tramite Iniezione SQL</a></li><li class="depth-0"><a href="#tecniche-avanzate" data-for="tecniche-avanzate">Tecniche avanzate</a></li><li class="depth-1"><a href="#introduzione" data-for="introduzione">Introduzione</a></li><li class="depth-1"><a href="#caratteri-speciali-e-statement-speciali" data-for="caratteri-speciali-e-statement-speciali">Caratteri speciali e statement speciali</a></li><li class="depth-2"><a href="#caratteri-speciali-nelle-sql-injection" data-for="caratteri-speciali-nelle-sql-injection">Caratteri Speciali nelle SQL Injection</a></li><li class="depth-2"><a href="#dichiarazioni-speciali" data-for="dichiarazioni-speciali">Dichiarazioni Speciali</a></li><li class="depth-1"><a href="#esercizio-estrazione-di-dati-tramite-sql-injection" data-for="esercizio-estrazione-di-dati-tramite-sql-injection">Esercizio: Estrazione di Dati tramite SQL Injection</a></li><li class="depth-2"><a href="#utilizzo-di-union" data-for="utilizzo-di-union">Utilizzo di UNION</a></li><li class="depth-2"><a href="#appendere-un-nuovo-statement-sql" data-for="appendere-un-nuovo-statement-sql">Appendere un Nuovo Statement SQL</a></li><li class="depth-2"><a href="#considerazioni-sulla-sicurezza" data-for="considerazioni-sulla-sicurezza">Considerazioni sulla Sicurezza</a></li><li class="depth-0"><a href="#mitigation-delle-sql-injection" data-for="mitigation-delle-sql-injection">Mitigation delle SQL Injection</a></li><li class="depth-2"><a href="#query-statiche" data-for="query-statiche">Query Statiche</a></li><li class="depth-2"><a href="#query-con-parametri" data-for="query-con-parametri">Query con Parametri</a></li><li class="depth-2"><a href="#procedure-memorizzate" data-for="procedure-memorizzate">Procedure Memorizzate</a></li><li class="depth-1"><a href="#procedure-memorizzate-1" data-for="procedure-memorizzate-1">Procedure memorizzate</a></li><li class="depth-2"><a href="#procedure-memorizzate-sicure" data-for="procedure-memorizzate-sicure">Procedure Memorizzate Sicure</a></li><li class="depth-2"><a href="#procedure-memorizzate-vulnerabili-a-iniezioni" data-for="procedure-memorizzate-vulnerabili-a-iniezioni">Procedure Memorizzate Vulnerabili a Iniezioni</a></li><li class="depth-1"><a href="#validazione-e-sicurezza-del-nome-utente-con-query-parametrizzate-in-java" data-for="validazione-e-sicurezza-del-nome-utente-con-query-parametrizzate-in-java">Validazione e Sicurezza del Nome Utente con Query Parametrizzate in Java</a></li><li class="depth-2"><a href="#validazione-del-nome-utente" data-for="validazione-del-nome-utente">Validazione del Nome Utente</a></li><li class="depth-2"><a href="#uso-corretto-delle-query-parametrizzate-per-linserimento-dei-dati" data-for="uso-corretto-delle-query-parametrizzate-per-linserimento-dei-dati">Uso Corretto delle Query Parametrizzate per l’Inserimento dei Dati</a></li><li class="depth-1"><a href="#esempio-di-query-parametrizzata-in-java" data-for="esempio-di-query-parametrizzata-in-java">Esempio di Query Parametrizzata in Java</a></li><li class="depth-2"><a href="#descrizione-del-codice" data-for="descrizione-del-codice">Descrizione del Codice</a></li><li class="depth-2"><a href="#spiegazione-del-processo" data-for="spiegazione-del-processo">Spiegazione del Processo</a></li><li class="depth-1"><a href="#esercizio-1-1" data-for="esercizio-1-1">Esercizio 1</a></li><li class="depth-2"><a href="#spiegazioni-importanti" data-for="spiegazioni-importanti">Spiegazioni Importanti:</a></li><li class="depth-1"><a href="#query-parametrizzate-in-net" data-for="query-parametrizzate-in-net">Query Parametrizzate in .NET</a></li><li class="depth-2"><a href="#descrizione-del-codice-1" data-for="descrizione-del-codice-1">Descrizione del Codice</a></li><li class="depth-2"><a href="#punti-chiave" data-for="punti-chiave">Punti Chiave</a></li><li class="depth-1"><a href="#necessità-della-validazione-degli-input" data-for="necessità-della-validazione-degli-input">Necessità della Validazione degli Input</a></li><li class="depth-2"><a href="#prevenzione-di-altri-tipi-di-attacchi" data-for="prevenzione-di-altri-tipi-di-attacchi">Prevenzione di Altri Tipi di Attacchi</a></li><li class="depth-2"><a href="#mantenimento-dellintegrità-logica-e-dei-dati" data-for="mantenimento-dellintegrità-logica-e-dei-dati">Mantenimento dell’Integrità Logica e dei Dati</a></li><li class="depth-2"><a href="#considerazione-del-database-come-entità-fiduciaria" data-for="considerazione-del-database-come-entità-fiduciaria">Considerazione del Database Come Entità Fiduciaria</a></li><li class="depth-1"><a href="#validazione-degli-input-un-primo-passo-necessario-ma-non-sufficiente" data-for="validazione-degli-input-un-primo-passo-necessario-ma-non-sufficiente">Validazione degli Input: Un Primo Passo Necessario ma Non Sufficiente</a></li><li class="depth-2"><a href="#limportanza-delle-query-parametrizzate" data-for="limportanza-delle-query-parametrizzate">L’Importanza delle Query Parametrizzate</a></li><li class="depth-2"><a href="#debolezze-dellapproccio-di-solo-filtraggio" data-for="debolezze-dellapproccio-di-solo-filtraggio">Debolezze dell’Approccio di Solo Filtraggio</a></li><li class="depth-1"><a href="#protezione-dalle-iniezioni-sql-e-uso-delle-query-parametrizzate-nella-clausola-order-by" data-for="protezione-dalle-iniezioni-sql-e-uso-delle-query-parametrizzate-nella-clausola-order-by">Protezione dalle Iniezioni SQL e Uso delle Query Parametrizzate nella Clausola ORDER BY</a></li><li class="depth-2"><a href="#il-problema-con-la-clausola-order-by" data-for="il-problema-con-la-clausola-order-by">Il Problema con la Clausola ORDER BY</a></li><li class="depth-2"><a href="#esempio-di-iniezione-nella-clausola-order-by" data-for="esempio-di-iniezione-nella-clausola-order-by">Esempio di Iniezione nella Clausola ORDER BY</a></li><li class="depth-2"><a href="#misure-di-mitigazione" data-for="misure-di-mitigazione">Misure di Mitigazione</a></li><li class="depth-1"><a href="#principio-del-minimo-privilegio-nelle-connessioni-al-database" data-for="principio-del-minimo-privilegio-nelle-connessioni-al-database">Principio del Minimo Privilegio nelle Connessioni al Database</a></li><li class="depth-2"><a href="#connessione-con-set-minimo-di-privilegi" data-for="connessione-con-set-minimo-di-privilegi">Connessione con Set Minimo di Privilegi</a></li><li class="depth-2"><a href="#gestione-degli-accessi-allo-schema" data-for="gestione-degli-accessi-allo-schema">Gestione degli Accessi allo Schema</a></li><li class="depth-2"><a href="#account-di-database-per-accesso-in-lettura-e-scrittura" data-for="account-di-database-per-accesso-in-lettura-e-scrittura">Account di Database per Accesso in Lettura e Scrittura</a></li><li class="depth-2"><a href="#pool-di-connessione-basati-sullaccesso" data-for="pool-di-connessione-basati-sullaccesso">Pool di Connessione Basati sull’Accesso</a></li><li class="overflow-end"></li></ul></div></div><footer class><p>Created with <a href="https://quartz.jzhao.xyz/">Quartz v4.5.1</a> © 2025</p><ul><li><a href="https://github.com/jackyzha0/quartz">GitHub</a></li><li><a href="https://discord.gg/cRFFHYye7t">Discord Community</a></li></ul></footer></div></div></body><script type="application/javascript">function n(){let t=this.parentElement;t.classList.toggle("is-collapsed");let e=t.getElementsByClassName("callout-content")[0];if(!e)return;let l=t.classList.contains("is-collapsed");e.style.gridTemplateRows=l?"0fr":"1fr"}function c(){let t=document.getElementsByClassName("callout is-collapsible");for(let e of t){let l=e.getElementsByClassName("callout-title")[0],s=e.getElementsByClassName("callout-content")[0];if(!l||!s)continue;l.addEventListener("click",n),window.addCleanup(()=>l.removeEventListener("click",n));let o=e.classList.contains("is-collapsed");s.style.gridTemplateRows=o?"0fr":"1fr"}}document.addEventListener("nav",c);
</script><script type="module">function f(i,e){if(!i)return;function r(o){o.target===this&&(o.preventDefault(),o.stopPropagation(),e())}function t(o){o.key.startsWith("Esc")&&(o.preventDefault(),e())}i?.addEventListener("click",r),window.addCleanup(()=>i?.removeEventListener("click",r)),document.addEventListener("keydown",t),window.addCleanup(()=>document.removeEventListener("keydown",t))}function y(i){for(;i.firstChild;)i.removeChild(i.firstChild)}var h=class{constructor(e,r){this.container=e;this.content=r;this.setupEventListeners(),this.setupNavigationControls(),this.resetTransform()}isDragging=!1;startPan={x:0,y:0};currentPan={x:0,y:0};scale=1;MIN_SCALE=.5;MAX_SCALE=3;cleanups=[];setupEventListeners(){let e=this.onMouseDown.bind(this),r=this.onMouseMove.bind(this),t=this.onMouseUp.bind(this),o=this.resetTransform.bind(this);this.container.addEventListener("mousedown",e),document.addEventListener("mousemove",r),document.addEventListener("mouseup",t),window.addEventListener("resize",o),this.cleanups.push(()=>this.container.removeEventListener("mousedown",e),()=>document.removeEventListener("mousemove",r),()=>document.removeEventListener("mouseup",t),()=>window.removeEventListener("resize",o))}cleanup(){for(let e of this.cleanups)e()}setupNavigationControls(){let e=document.createElement("div");e.className="mermaid-controls";let r=this.createButton("+",()=>this.zoom(.1)),t=this.createButton("-",()=>this.zoom(-.1)),o=this.createButton("Reset",()=>this.resetTransform());e.appendChild(t),e.appendChild(o),e.appendChild(r),this.container.appendChild(e)}createButton(e,r){let t=document.createElement("button");return t.textContent=e,t.className="mermaid-control-button",t.addEventListener("click",r),window.addCleanup(()=>t.removeEventListener("click",r)),t}onMouseDown(e){e.button===0&&(this.isDragging=!0,this.startPan={x:e.clientX-this.currentPan.x,y:e.clientY-this.currentPan.y},this.container.style.cursor="grabbing")}onMouseMove(e){this.isDragging&&(e.preventDefault(),this.currentPan={x:e.clientX-this.startPan.x,y:e.clientY-this.startPan.y},this.updateTransform())}onMouseUp(){this.isDragging=!1,this.container.style.cursor="grab"}zoom(e){let r=Math.min(Math.max(this.scale+e,this.MIN_SCALE),this.MAX_SCALE),t=this.content.getBoundingClientRect(),o=t.width/2,n=t.height/2,c=r-this.scale;this.currentPan.x-=o*c,this.currentPan.y-=n*c,this.scale=r,this.updateTransform()}updateTransform(){this.content.style.transform=`translate(${this.currentPan.x}px, ${this.currentPan.y}px) scale(${this.scale})`}resetTransform(){this.scale=1;let e=this.content.querySelector("svg");this.currentPan={x:e.getBoundingClientRect().width/2,y:e.getBoundingClientRect().height/2},this.updateTransform()}},C=["--secondary","--tertiary","--gray","--light","--lightgray","--highlight","--dark","--darkgray","--codeFont"],E;document.addEventListener("nav",async()=>{let e=document.querySelector(".center").querySelectorAll("code.mermaid");if(e.length===0)return;E||=await import("https://cdnjs.cloudflare.com/ajax/libs/mermaid/11.4.0/mermaid.esm.min.mjs");let r=E.default,t=new WeakMap;for(let n of e)t.set(n,n.innerText);async function o(){for(let s of e){s.removeAttribute("data-processed");let a=t.get(s);a&&(s.innerHTML=a)}let n=C.reduce((s,a)=>(s[a]=window.getComputedStyle(document.documentElement).getPropertyValue(a),s),{}),c=document.documentElement.getAttribute("saved-theme")==="dark";r.initialize({startOnLoad:!1,securityLevel:"loose",theme:c?"dark":"base",themeVariables:{fontFamily:n["--codeFont"],primaryColor:n["--light"],primaryTextColor:n["--darkgray"],primaryBorderColor:n["--tertiary"],lineColor:n["--darkgray"],secondaryColor:n["--secondary"],tertiaryColor:n["--tertiary"],clusterBkg:n["--light"],edgeLabelBackground:n["--highlight"]}}),await r.run({nodes:e})}await o(),document.addEventListener("themechange",o),window.addCleanup(()=>document.removeEventListener("themechange",o));for(let n=0;n<e.length;n++){let v=function(){let g=l.querySelector("#mermaid-space"),m=l.querySelector(".mermaid-content");if(!m)return;y(m);let w=c.querySelector("svg").cloneNode(!0);m.appendChild(w),l.classList.add("active"),g.style.cursor="grab",u=new h(g,m)},M=function(){l.classList.remove("active"),u?.cleanup(),u=null},c=e[n],s=c.parentElement,a=s.querySelector(".clipboard-button"),d=s.querySelector(".expand-button"),p=window.getComputedStyle(a),L=a.offsetWidth+parseFloat(p.marginLeft||"0")+parseFloat(p.marginRight||"0");d.style.right=`calc(${L}px + 0.3rem)`,s.prepend(d);let l=s.querySelector("#mermaid-container");if(!l)return;let u=null;d.addEventListener("click",v),f(l,M),window.addCleanup(()=>{u?.cleanup(),d.removeEventListener("click",v)})}});
</script><script src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/copy-tex.min.js" type="application/javascript"></script><script src="../../postscript.js" type="module"></script></html>